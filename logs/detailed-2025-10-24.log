{"timestamp":"2025-10-24T14:13:07.620Z","level":"INFO","category":"CALL_START","message":"Llamada iniciada desde +1234567890","data":{"phoneNumber":"+1234567890","userInput":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:13:07.620Z"}}
{"timestamp":"2025-10-24T14:13:07.626Z","level":"INFO","category":"LANGUAGE_DETECTION","message":"Idioma detectado: es (0.9)","data":{"phoneNumber":"+1234567890","detectedLang":"es","confidence":0.9,"method":"gemini"}}
{"timestamp":"2025-10-24T14:13:07.627Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+1234567890","model":"gemini-2.0-flash-exp","promptLength":45,"promptPreview":"Eres un experto en análisis de intenciones......"}}
{"timestamp":"2025-10-24T14:13:07.627Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+1234567890","responseLength":377,"processingTime":1200,"responsePreview":"{\n    \"intent\": \"reservation\",\n    \"confidence\": 0.85,\n    \"extracted_data\": {\n      \"people\": 4,\n      \"date\": null,\n      \"time\": null,\n      \"name\": null,\n      \"phone\": null\n    },\n    \"sentiment\"...","fullResponse":"{\n    \"intent\": \"reservation\",\n    \"confidence\": 0.85,\n    \"extracted_data\": {\n      \"people\": 4,\n      \"date\": null,\n      \"time\": null,\n      \"name\": null,\n      \"phone\": null\n    },\n    \"sentiment\": \"positive\",\n    \"urgency\": \"normal\",\n    \"next_step\": \"ask_date\",\n    \"response_type\": \"confirmation\",\n    \"needs_clarification\": false,\n    \"clarification_question\": null\n  }"}}
{"timestamp":"2025-10-24T14:13:07.628Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+1234567890","step":"greeting","analysis":{"intent":"reservation","confidence":0.85,"sentiment":"positive","urgency":"normal","extracted_data":{"people":4,"date":null,"time":null,"name":null,"phone":null},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:13:07.628Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+1234567890","step":"greeting","extractedData":{"people":4,"date":null,"time":null,"name":null,"phone":null},"hasPeople":true,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:13:07.629Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → ask_date","data":{"phoneNumber":"+1234567890","fromStep":"greeting","toStep":"ask_date","reason":"Datos de personas extraídos","timestamp":"2025-10-24T14:13:07.629Z"}}
{"timestamp":"2025-10-24T14:13:07.629Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+1234567890","method":"intelligent","language":"es","responseLength":63,"responsePreview":"Perfecto, para 4 personas. ¿Para qué fecha necesita la reserva?...","fullResponse":"Perfecto, para 4 personas. ¿Para qué fecha necesita la reserva?"}}
{"timestamp":"2025-10-24T14:13:07.629Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+1234567890","historyLength":2,"lastMessages":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:13:07.629Z"},{"role":"bot","message":"Perfecto, para 4 personas. ¿Para qué fecha necesita la reserva?","timestamp":"2025-10-24T14:13:07.629Z"}],"fullHistory":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:13:07.629Z"},{"role":"bot","message":"Perfecto, para 4 personas. ¿Para qué fecha necesita la reserva?","timestamp":"2025-10-24T14:13:07.629Z"}]}}
{"timestamp":"2025-10-24T14:13:07.630Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+1234567890","state":{"step":"ask_date","language":"es","data":{"people":4},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:13:07.630Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+1234567890","metrics":{"totalTime":1500,"geminiTime":1200,"processingTime":1500,"intent":"reservation","confidence":0.85,"sentiment":"positive","urgency":"normal","step":"greeting","nextStep":"ask_date","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:13:07.631Z","level":"INFO","category":"CALL_START","message":"Llamada iniciada desde +0987654321","data":{"phoneNumber":"+0987654321","userInput":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:13:07.631Z"}}
{"timestamp":"2025-10-24T14:13:07.631Z","level":"INFO","category":"LANGUAGE_DETECTION","message":"Idioma detectado: es (0.9)","data":{"phoneNumber":"+0987654321","detectedLang":"es","confidence":0.9,"method":"gemini"}}
{"timestamp":"2025-10-24T14:13:07.631Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+0987654321","model":"gemini-2.0-flash-exp","promptLength":45,"promptPreview":"Eres un experto en análisis de intenciones......"}}
{"timestamp":"2025-10-24T14:13:07.631Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+0987654321","responseLength":377,"processingTime":1200,"responsePreview":"{\n    \"intent\": \"reservation\",\n    \"confidence\": 0.85,\n    \"extracted_data\": {\n      \"people\": 4,\n      \"date\": null,\n      \"time\": null,\n      \"name\": null,\n      \"phone\": null\n    },\n    \"sentiment\"...","fullResponse":"{\n    \"intent\": \"reservation\",\n    \"confidence\": 0.85,\n    \"extracted_data\": {\n      \"people\": 4,\n      \"date\": null,\n      \"time\": null,\n      \"name\": null,\n      \"phone\": null\n    },\n    \"sentiment\": \"positive\",\n    \"urgency\": \"normal\",\n    \"next_step\": \"ask_date\",\n    \"response_type\": \"confirmation\",\n    \"needs_clarification\": false,\n    \"clarification_question\": null\n  }"}}
{"timestamp":"2025-10-24T14:13:07.631Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+0987654321","step":"greeting","analysis":{"intent":"reservation","confidence":0.85,"sentiment":"positive","urgency":"normal","extracted_data":{"people":4,"date":null,"time":null,"name":null,"phone":null},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:13:07.632Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+0987654321","step":"greeting","extractedData":{"people":4,"date":null,"time":null,"name":null,"phone":null},"hasPeople":true,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:13:07.632Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → ask_date","data":{"phoneNumber":"+0987654321","fromStep":"greeting","toStep":"ask_date","reason":"Datos de personas extraídos","timestamp":"2025-10-24T14:13:07.632Z"}}
{"timestamp":"2025-10-24T14:13:07.632Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+0987654321","method":"intelligent","language":"es","responseLength":63,"responsePreview":"Perfecto, para 4 personas. ¿Para qué fecha necesita la reserva?...","fullResponse":"Perfecto, para 4 personas. ¿Para qué fecha necesita la reserva?"}}
{"timestamp":"2025-10-24T14:13:07.632Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+0987654321","historyLength":2,"lastMessages":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:13:07.632Z"},{"role":"bot","message":"Perfecto, para 4 personas. ¿Para qué fecha necesita la reserva?","timestamp":"2025-10-24T14:13:07.632Z"}],"fullHistory":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:13:07.632Z"},{"role":"bot","message":"Perfecto, para 4 personas. ¿Para qué fecha necesita la reserva?","timestamp":"2025-10-24T14:13:07.632Z"}]}}
{"timestamp":"2025-10-24T14:13:07.632Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+0987654321","state":{"step":"ask_date","language":"es","data":{"people":4},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:13:07.633Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+0987654321","metrics":{"totalTime":1500,"geminiTime":1200,"processingTime":1500,"intent":"reservation","confidence":0.85,"sentiment":"positive","urgency":"normal","step":"greeting","nextStep":"ask_date","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:13:07.633Z","level":"INFO","category":"CALL_START","message":"Llamada iniciada desde +5555555555","data":{"phoneNumber":"+5555555555","userInput":"Hello, I want to make a reservation","timestamp":"2025-10-24T14:13:07.633Z"}}
{"timestamp":"2025-10-24T14:13:07.633Z","level":"INFO","category":"LANGUAGE_DETECTION","message":"Idioma detectado: en (0.7)","data":{"phoneNumber":"+5555555555","detectedLang":"en","confidence":0.7,"method":"gemini"}}
{"timestamp":"2025-10-24T14:13:07.634Z","level":"ERROR","category":"GEMINI_ERROR","message":"Error en Gemini: Model is overloaded","data":{"phoneNumber":"+5555555555","error":{"message":"Model is overloaded","status":503,"stack":"Error: Model is overloaded\n    at simulateProblematicCall (D:\\cronosai-webhook\\test_logging_system.js:104:17)\n    at main (D:\\cronosai-webhook\\test_logging_system.js:147:9)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)"},"retryCount":1}}
{"timestamp":"2025-10-24T14:13:07.634Z","level":"WARN","category":"FALLBACK_USAGE","message":"Usando fallback: Modelo sobrecargado (503)","data":{"phoneNumber":"+5555555555","reason":"Modelo sobrecargado (503)","fallbackType":"getFallbackIntent","timestamp":"2025-10-24T14:13:07.634Z"}}
{"timestamp":"2025-10-24T14:13:07.634Z","level":"INFO","category":"LANGUAGE_DETECTION","message":"Idioma detectado: es (0.5)","data":{"phoneNumber":"+5555555555","detectedLang":"es","confidence":0.5,"method":"fallback"}}
{"timestamp":"2025-10-24T14:13:07.635Z","level":"ERROR","category":"SYSTEM_ERROR","message":"Error del sistema: Database connection failed","data":{"phoneNumber":"+5555555555","error":{"message":"Database connection failed","stack":"Error: Database connection failed\n    at simulateProblematicCall (D:\\cronosai-webhook\\test_logging_system.js:115:23)\n    at main (D:\\cronosai-webhook\\test_logging_system.js:147:9)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","name":"Error"},"context":"saveReservation"}}
{"timestamp":"2025-10-24T14:13:07.635Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+5555555555","metrics":{"totalTime":5000,"geminiTime":0,"processingTime":5000,"intent":"clarification","confidence":0.3,"sentiment":"frustrated","urgency":"high","step":"error","nextStep":"error","language":"es","fallbackUsed":true}}}
{"timestamp":"2025-10-24T14:18:16.603Z","level":"INFO","category":"CALL_START","message":"Llamada iniciada desde +1234567890","data":{"phoneNumber":"+1234567890","userInput":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:18:16.603Z"}}
{"timestamp":"2025-10-24T14:18:16.604Z","level":"INFO","category":"LANGUAGE_DETECTION","message":"Idioma detectado: es (0.9)","data":{"phoneNumber":"+1234567890","detectedLang":"es","confidence":0.9,"method":"gemini"}}
{"timestamp":"2025-10-24T14:18:16.604Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+1234567890","model":"gemini-2.0-flash-exp","promptLength":45,"promptPreview":"Eres un experto en análisis de intenciones......"}}
{"timestamp":"2025-10-24T14:18:16.604Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+1234567890","responseLength":377,"processingTime":1200,"responsePreview":"{\n    \"intent\": \"reservation\",\n    \"confidence\": 0.85,\n    \"extracted_data\": {\n      \"people\": 4,\n      \"date\": null,\n      \"time\": null,\n      \"name\": null,\n      \"phone\": null\n    },\n    \"sentiment\"...","fullResponse":"{\n    \"intent\": \"reservation\",\n    \"confidence\": 0.85,\n    \"extracted_data\": {\n      \"people\": 4,\n      \"date\": null,\n      \"time\": null,\n      \"name\": null,\n      \"phone\": null\n    },\n    \"sentiment\": \"positive\",\n    \"urgency\": \"normal\",\n    \"next_step\": \"ask_date\",\n    \"response_type\": \"confirmation\",\n    \"needs_clarification\": false,\n    \"clarification_question\": null\n  }"}}
{"timestamp":"2025-10-24T14:18:16.605Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+1234567890","step":"greeting","analysis":{"intent":"reservation","confidence":0.85,"sentiment":"positive","urgency":"normal","extracted_data":{"people":4,"date":null,"time":null,"name":null,"phone":null},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:18:16.605Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+1234567890","step":"greeting","extractedData":{"people":4,"date":null,"time":null,"name":null,"phone":null},"hasPeople":true,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:18:16.606Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → ask_date","data":{"phoneNumber":"+1234567890","fromStep":"greeting","toStep":"ask_date","reason":"Datos de personas extraídos","timestamp":"2025-10-24T14:18:16.606Z"}}
{"timestamp":"2025-10-24T14:18:16.606Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+1234567890","method":"intelligent","language":"es","responseLength":63,"responsePreview":"Perfecto, para 4 personas. ¿Para qué fecha necesita la reserva?...","fullResponse":"Perfecto, para 4 personas. ¿Para qué fecha necesita la reserva?"}}
{"timestamp":"2025-10-24T14:18:16.606Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+1234567890","historyLength":2,"lastMessages":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:18:16.606Z"},{"role":"bot","message":"Perfecto, para 4 personas. ¿Para qué fecha necesita la reserva?","timestamp":"2025-10-24T14:18:16.606Z"}],"fullHistory":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:18:16.606Z"},{"role":"bot","message":"Perfecto, para 4 personas. ¿Para qué fecha necesita la reserva?","timestamp":"2025-10-24T14:18:16.606Z"}]}}
{"timestamp":"2025-10-24T14:18:16.606Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+1234567890","state":{"step":"ask_date","language":"es","data":{"people":4},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:18:16.607Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+1234567890","metrics":{"totalTime":1500,"geminiTime":1200,"processingTime":1500,"intent":"reservation","confidence":0.85,"sentiment":"positive","urgency":"normal","step":"greeting","nextStep":"ask_date","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:18:16.607Z","level":"INFO","category":"CALL_START","message":"Llamada iniciada desde +0987654321","data":{"phoneNumber":"+0987654321","userInput":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:18:16.607Z"}}
{"timestamp":"2025-10-24T14:18:16.607Z","level":"INFO","category":"LANGUAGE_DETECTION","message":"Idioma detectado: es (0.9)","data":{"phoneNumber":"+0987654321","detectedLang":"es","confidence":0.9,"method":"gemini"}}
{"timestamp":"2025-10-24T14:18:16.608Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+0987654321","model":"gemini-2.0-flash-exp","promptLength":45,"promptPreview":"Eres un experto en análisis de intenciones......"}}
{"timestamp":"2025-10-24T14:18:16.608Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+0987654321","responseLength":377,"processingTime":1200,"responsePreview":"{\n    \"intent\": \"reservation\",\n    \"confidence\": 0.85,\n    \"extracted_data\": {\n      \"people\": 4,\n      \"date\": null,\n      \"time\": null,\n      \"name\": null,\n      \"phone\": null\n    },\n    \"sentiment\"...","fullResponse":"{\n    \"intent\": \"reservation\",\n    \"confidence\": 0.85,\n    \"extracted_data\": {\n      \"people\": 4,\n      \"date\": null,\n      \"time\": null,\n      \"name\": null,\n      \"phone\": null\n    },\n    \"sentiment\": \"positive\",\n    \"urgency\": \"normal\",\n    \"next_step\": \"ask_date\",\n    \"response_type\": \"confirmation\",\n    \"needs_clarification\": false,\n    \"clarification_question\": null\n  }"}}
{"timestamp":"2025-10-24T14:18:16.608Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+0987654321","step":"greeting","analysis":{"intent":"reservation","confidence":0.85,"sentiment":"positive","urgency":"normal","extracted_data":{"people":4,"date":null,"time":null,"name":null,"phone":null},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:18:16.608Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+0987654321","step":"greeting","extractedData":{"people":4,"date":null,"time":null,"name":null,"phone":null},"hasPeople":true,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:18:16.608Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → ask_date","data":{"phoneNumber":"+0987654321","fromStep":"greeting","toStep":"ask_date","reason":"Datos de personas extraídos","timestamp":"2025-10-24T14:18:16.608Z"}}
{"timestamp":"2025-10-24T14:18:16.608Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+0987654321","method":"intelligent","language":"es","responseLength":63,"responsePreview":"Perfecto, para 4 personas. ¿Para qué fecha necesita la reserva?...","fullResponse":"Perfecto, para 4 personas. ¿Para qué fecha necesita la reserva?"}}
{"timestamp":"2025-10-24T14:18:16.609Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+0987654321","historyLength":2,"lastMessages":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:18:16.609Z"},{"role":"bot","message":"Perfecto, para 4 personas. ¿Para qué fecha necesita la reserva?","timestamp":"2025-10-24T14:18:16.609Z"}],"fullHistory":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:18:16.609Z"},{"role":"bot","message":"Perfecto, para 4 personas. ¿Para qué fecha necesita la reserva?","timestamp":"2025-10-24T14:18:16.609Z"}]}}
{"timestamp":"2025-10-24T14:18:16.609Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+0987654321","state":{"step":"ask_date","language":"es","data":{"people":4},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:18:16.609Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+0987654321","metrics":{"totalTime":1500,"geminiTime":1200,"processingTime":1500,"intent":"reservation","confidence":0.85,"sentiment":"positive","urgency":"normal","step":"greeting","nextStep":"ask_date","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:18:16.609Z","level":"INFO","category":"CALL_START","message":"Llamada iniciada desde +5555555555","data":{"phoneNumber":"+5555555555","userInput":"Hello, I want to make a reservation","timestamp":"2025-10-24T14:18:16.609Z"}}
{"timestamp":"2025-10-24T14:18:16.609Z","level":"INFO","category":"LANGUAGE_DETECTION","message":"Idioma detectado: en (0.7)","data":{"phoneNumber":"+5555555555","detectedLang":"en","confidence":0.7,"method":"gemini"}}
{"timestamp":"2025-10-24T14:18:16.610Z","level":"ERROR","category":"GEMINI_ERROR","message":"Error en Gemini: Model is overloaded","data":{"phoneNumber":"+5555555555","error":{"message":"Model is overloaded","status":503,"stack":"Error: Model is overloaded\n    at simulateProblematicCall (D:\\cronosai-webhook\\scripts\\logging\\test_logging_system.js:104:17)\n    at main (D:\\cronosai-webhook\\scripts\\logging\\test_logging_system.js:147:9)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)"},"retryCount":1}}
{"timestamp":"2025-10-24T14:18:16.610Z","level":"WARN","category":"FALLBACK_USAGE","message":"Usando fallback: Modelo sobrecargado (503)","data":{"phoneNumber":"+5555555555","reason":"Modelo sobrecargado (503)","fallbackType":"getFallbackIntent","timestamp":"2025-10-24T14:18:16.610Z"}}
{"timestamp":"2025-10-24T14:18:16.611Z","level":"INFO","category":"LANGUAGE_DETECTION","message":"Idioma detectado: es (0.5)","data":{"phoneNumber":"+5555555555","detectedLang":"es","confidence":0.5,"method":"fallback"}}
{"timestamp":"2025-10-24T14:18:16.611Z","level":"ERROR","category":"SYSTEM_ERROR","message":"Error del sistema: Database connection failed","data":{"phoneNumber":"+5555555555","error":{"message":"Database connection failed","stack":"Error: Database connection failed\n    at simulateProblematicCall (D:\\cronosai-webhook\\scripts\\logging\\test_logging_system.js:115:23)\n    at main (D:\\cronosai-webhook\\scripts\\logging\\test_logging_system.js:147:9)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","name":"Error"},"context":"saveReservation"}}
{"timestamp":"2025-10-24T14:18:16.611Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+5555555555","metrics":{"totalTime":5000,"geminiTime":0,"processingTime":5000,"intent":"clarification","confidence":0.3,"sentiment":"frustrated","urgency":"high","step":"error","nextStep":"error","language":"es","fallbackUsed":true}}}
{"timestamp":"2025-10-24T14:22:58.602Z","level":"INFO","category":"CALL_START","message":"Llamada iniciada desde +34600000001","data":{"phoneNumber":"+34600000001","userInput":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:22:58.601Z"}}
{"timestamp":"2025-10-24T14:22:58.602Z","level":"INFO","category":"LANGUAGE_DETECTION","message":"Idioma detectado: es (0.9)","data":{"phoneNumber":"+34600000001","detectedLang":"es","confidence":0.9,"method":"gemini"}}
{"timestamp":"2025-10-24T14:22:58.603Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+34600000001","model":"gemini-2.0-flash-exp","promptLength":72,"promptPreview":"Analiza la intención del cliente en es: \"Hola, quiero hacer una reserva\"..."}}
{"timestamp":"2025-10-24T14:22:58.604Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+34600000001","responseLength":211,"processingTime":1565.41957605178,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"greeting\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_ques...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"greeting\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.604Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+34600000001","step":"greeting","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.604Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+34600000001","step":"greeting","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.605Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → greeting","data":{"phoneNumber":"+34600000001","fromStep":"greeting","toStep":"greeting","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.605Z"}}
{"timestamp":"2025-10-24T14:22:58.605Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+34600000001","method":"intelligent","language":"es","responseLength":73,"responsePreview":"¡Hola! Bienvenido al restaurante. ¿Para cuántas personas será la reserva?...","fullResponse":"¡Hola! Bienvenido al restaurante. ¿Para cuántas personas será la reserva?"}}
{"timestamp":"2025-10-24T14:22:58.605Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+34600000001","historyLength":1,"lastMessages":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:22:58.605Z"}],"fullHistory":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:22:58.605Z"}]}}
{"timestamp":"2025-10-24T14:22:58.606Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+34600000001","state":{"step":"greeting","language":"es","data":{},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.606Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+34600000001","metrics":{"totalTime":1266.143170195127,"geminiTime":832.8696861545701,"processingTime":1370.3861283796973,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"greeting","nextStep":"greeting","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.606Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+34600000001","model":"gemini-2.0-flash-exp","promptLength":57,"promptPreview":"Analiza la intención del cliente en es: \"Para 4 personas\"..."}}
{"timestamp":"2025-10-24T14:22:58.607Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+34600000001","responseLength":238,"processingTime":1028.437934917719,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":4,\"time\":\"04:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_people\",\"response_type\":\"question\",\"needs_clarification...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":4,\"time\":\"04:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_people\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.607Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+34600000001","step":"ask_people","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":4,"time":"04:00"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.607Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+34600000001","step":"ask_people","extractedData":{"people":4,"time":"04:00"},"hasPeople":true,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.607Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_people → ask_people","data":{"phoneNumber":"+34600000001","fromStep":"ask_people","toStep":"ask_people","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.607Z"}}
{"timestamp":"2025-10-24T14:22:58.608Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+34600000001","method":"intelligent","language":"es","responseLength":39,"responsePreview":"¿Para cuántas personas será la reserva?...","fullResponse":"¿Para cuántas personas será la reserva?"}}
{"timestamp":"2025-10-24T14:22:58.608Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+34600000001","historyLength":2,"lastMessages":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:22:58.608Z"},{"role":"bot","message":"Para 4 personas","timestamp":"2025-10-24T14:22:58.608Z"}],"fullHistory":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:22:58.608Z"},{"role":"bot","message":"Para 4 personas","timestamp":"2025-10-24T14:22:58.608Z"}]}}
{"timestamp":"2025-10-24T14:22:58.608Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+34600000001","state":{"step":"ask_people","language":"es","data":{"people":4},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.608Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+34600000001","metrics":{"totalTime":1405.0589402967203,"geminiTime":1280.1188052133796,"processingTime":2344.610189254624,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_people","nextStep":"ask_people","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.608Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+34600000001","model":"gemini-2.0-flash-exp","promptLength":53,"promptPreview":"Analiza la intención del cliente en es: \"Para mañana\"..."}}
{"timestamp":"2025-10-24T14:22:58.609Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+34600000001","responseLength":230,"processingTime":1392.8282747269477,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"date\":\"2025-10-25\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_date\",\"response_type\":\"question\",\"needs_clarification\":false,...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"date\":\"2025-10-25\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_date\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.609Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+34600000001","step":"ask_date","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"date":"2025-10-25"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.609Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+34600000001","step":"ask_date","extractedData":{"date":"2025-10-25"},"hasPeople":false,"hasDate":true,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.609Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_date → ask_date","data":{"phoneNumber":"+34600000001","fromStep":"ask_date","toStep":"ask_date","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.609Z"}}
{"timestamp":"2025-10-24T14:22:58.610Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+34600000001","method":"intelligent","language":"es","responseLength":36,"responsePreview":"¿Para qué fecha necesita la reserva?...","fullResponse":"¿Para qué fecha necesita la reserva?"}}
{"timestamp":"2025-10-24T14:22:58.610Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+34600000001","historyLength":3,"lastMessages":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:22:58.610Z"},{"role":"bot","message":"Para 4 personas","timestamp":"2025-10-24T14:22:58.610Z"},{"role":"user","message":"Para mañana","timestamp":"2025-10-24T14:22:58.610Z"}],"fullHistory":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:22:58.610Z"},{"role":"bot","message":"Para 4 personas","timestamp":"2025-10-24T14:22:58.610Z"},{"role":"user","message":"Para mañana","timestamp":"2025-10-24T14:22:58.610Z"}]}}
{"timestamp":"2025-10-24T14:22:58.610Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+34600000001","state":{"step":"ask_date","language":"es","data":{"people":4},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.611Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+34600000001","metrics":{"totalTime":1078.972015572272,"geminiTime":1469.1620604072154,"processingTime":2330.2934272894004,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_date","nextStep":"ask_date","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.611Z","level":"WARN","category":"FALLBACK_USAGE","message":"Usando fallback: Gemini timeout","data":{"phoneNumber":"+34600000001","reason":"Gemini timeout","fallbackType":"getFallbackIntent","timestamp":"2025-10-24T14:22:58.611Z"}}
{"timestamp":"2025-10-24T14:22:58.612Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+34600000001","model":"gemini-2.0-flash-exp","promptLength":61,"promptPreview":"Analiza la intención del cliente en es: \"A las 8 de la tarde\"..."}}
{"timestamp":"2025-10-24T14:22:58.612Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+34600000001","responseLength":236,"processingTime":1743.8013022730847,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":8,\"time\":\"20:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_time\",\"response_type\":\"question\",\"needs_clarification\":...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":8,\"time\":\"20:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_time\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.612Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+34600000001","step":"ask_time","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":8,"time":"20:00"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.612Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+34600000001","step":"ask_time","extractedData":{"people":8,"time":"20:00"},"hasPeople":true,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.612Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_time → ask_time","data":{"phoneNumber":"+34600000001","fromStep":"ask_time","toStep":"ask_time","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.612Z"}}
{"timestamp":"2025-10-24T14:22:58.613Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+34600000001","method":"intelligent","language":"es","responseLength":28,"responsePreview":"¿A qué hora prefieren venir?...","fullResponse":"¿A qué hora prefieren venir?"}}
{"timestamp":"2025-10-24T14:22:58.613Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+34600000001","historyLength":4,"lastMessages":[{"role":"bot","message":"Para 4 personas","timestamp":"2025-10-24T14:22:58.613Z"},{"role":"user","message":"Para mañana","timestamp":"2025-10-24T14:22:58.613Z"},{"role":"bot","message":"A las 8 de la tarde","timestamp":"2025-10-24T14:22:58.613Z"}],"fullHistory":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:22:58.613Z"},{"role":"bot","message":"Para 4 personas","timestamp":"2025-10-24T14:22:58.613Z"},{"role":"user","message":"Para mañana","timestamp":"2025-10-24T14:22:58.613Z"},{"role":"bot","message":"A las 8 de la tarde","timestamp":"2025-10-24T14:22:58.613Z"}]}}
{"timestamp":"2025-10-24T14:22:58.613Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+34600000001","state":{"step":"ask_time","language":"es","data":{"people":8},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.613Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+34600000001","metrics":{"totalTime":2394.3680542688844,"geminiTime":1697.1397459036143,"processingTime":2256.4554130802953,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_time","nextStep":"ask_time","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.613Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+34600000001","model":"gemini-2.0-flash-exp","promptLength":61,"promptPreview":"Analiza la intención del cliente en es: \"Me llamo Juan Pérez\"..."}}
{"timestamp":"2025-10-24T14:22:58.614Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+34600000001","responseLength":224,"processingTime":1042.6243618155977,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"name\":\"Juan\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\":false,\"clari...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"name\":\"Juan\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.614Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+34600000001","step":"ask_name","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"name":"Juan"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.614Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+34600000001","step":"ask_name","extractedData":{"name":"Juan"},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":true,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.614Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_name → ask_name","data":{"phoneNumber":"+34600000001","fromStep":"ask_name","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.614Z"}}
{"timestamp":"2025-10-24T14:22:58.615Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+34600000001","method":"intelligent","language":"es","responseLength":15,"responsePreview":"¿Cómo se llama?...","fullResponse":"¿Cómo se llama?"}}
{"timestamp":"2025-10-24T14:22:58.615Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+34600000001","historyLength":5,"lastMessages":[{"role":"user","message":"Para mañana","timestamp":"2025-10-24T14:22:58.615Z"},{"role":"bot","message":"A las 8 de la tarde","timestamp":"2025-10-24T14:22:58.615Z"},{"role":"user","message":"Me llamo Juan Pérez","timestamp":"2025-10-24T14:22:58.615Z"}],"fullHistory":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:22:58.615Z"},{"role":"bot","message":"Para 4 personas","timestamp":"2025-10-24T14:22:58.615Z"},{"role":"user","message":"Para mañana","timestamp":"2025-10-24T14:22:58.615Z"},{"role":"bot","message":"A las 8 de la tarde","timestamp":"2025-10-24T14:22:58.615Z"},{"role":"user","message":"Me llamo Juan Pérez","timestamp":"2025-10-24T14:22:58.615Z"}]}}
{"timestamp":"2025-10-24T14:22:58.615Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+34600000001","state":{"step":"ask_name","language":"es","data":{"people":8},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.615Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+34600000001","metrics":{"totalTime":2489.1545100459844,"geminiTime":1726.4020238348573,"processingTime":1739.4752624212838,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_name","nextStep":"ask_name","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.616Z","level":"INFO","category":"CALL_START","message":"Llamada iniciada desde +346000000011","data":{"phoneNumber":"+346000000011","userInput":"Hola","timestamp":"2025-10-24T14:22:58.616Z"}}
{"timestamp":"2025-10-24T14:22:58.616Z","level":"INFO","category":"LANGUAGE_DETECTION","message":"Idioma detectado: es (0.9)","data":{"phoneNumber":"+346000000011","detectedLang":"es","confidence":0.9,"method":"gemini"}}
{"timestamp":"2025-10-24T14:22:58.616Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+346000000011","model":"gemini-2.0-flash-exp","promptLength":46,"promptPreview":"Analiza la intención del cliente en es: \"Hola\"..."}}
{"timestamp":"2025-10-24T14:22:58.616Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+346000000011","responseLength":211,"processingTime":1606.2916915761127,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"greeting\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_ques...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"greeting\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.617Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+346000000011","step":"greeting","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.617Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+346000000011","step":"greeting","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.617Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → greeting","data":{"phoneNumber":"+346000000011","fromStep":"greeting","toStep":"greeting","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.617Z"}}
{"timestamp":"2025-10-24T14:22:58.617Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+346000000011","method":"intelligent","language":"es","responseLength":73,"responsePreview":"¡Hola! Bienvenido al restaurante. ¿Para cuántas personas será la reserva?...","fullResponse":"¡Hola! Bienvenido al restaurante. ¿Para cuántas personas será la reserva?"}}
{"timestamp":"2025-10-24T14:22:58.618Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+346000000011","historyLength":1,"lastMessages":[{"role":"user","message":"Hola","timestamp":"2025-10-24T14:22:58.618Z"}],"fullHistory":[{"role":"user","message":"Hola","timestamp":"2025-10-24T14:22:58.618Z"}]}}
{"timestamp":"2025-10-24T14:22:58.618Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+346000000011","state":{"step":"greeting","language":"es","data":{},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.618Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+346000000011","metrics":{"totalTime":2605.2981586564993,"geminiTime":1044.0053510443568,"processingTime":1523.6264914674734,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"greeting","nextStep":"greeting","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.618Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+346000000011","model":"gemini-2.0-flash-exp","promptLength":66,"promptPreview":"Analiza la intención del cliente en es: \"No entiendo qué necesito\"..."}}
{"timestamp":"2025-10-24T14:22:58.619Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+346000000011","responseLength":215,"processingTime":1167.3547174864273,"responsePreview":"{\"intent\":\"clarification\",\"confidence\":0.7,\"extracted_data\":{},\"sentiment\":\"confused\",\"urgency\":\"normal\",\"next_step\":\"ask_people\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_...","fullResponse":"{\"intent\":\"clarification\",\"confidence\":0.7,\"extracted_data\":{},\"sentiment\":\"confused\",\"urgency\":\"normal\",\"next_step\":\"ask_people\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.619Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+346000000011","step":"ask_people","analysis":{"intent":"clarification","confidence":0.7,"sentiment":"confused","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.619Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+346000000011","step":"ask_people","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.619Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_people → ask_people","data":{"phoneNumber":"+346000000011","fromStep":"ask_people","toStep":"ask_people","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.619Z"}}
{"timestamp":"2025-10-24T14:22:58.619Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+346000000011","method":"intelligent","language":"es","responseLength":39,"responsePreview":"¿Para cuántas personas será la reserva?...","fullResponse":"¿Para cuántas personas será la reserva?"}}
{"timestamp":"2025-10-24T14:22:58.620Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+346000000011","historyLength":2,"lastMessages":[{"role":"user","message":"Hola","timestamp":"2025-10-24T14:22:58.620Z"},{"role":"bot","message":"No entiendo qué necesito","timestamp":"2025-10-24T14:22:58.620Z"}],"fullHistory":[{"role":"user","message":"Hola","timestamp":"2025-10-24T14:22:58.620Z"},{"role":"bot","message":"No entiendo qué necesito","timestamp":"2025-10-24T14:22:58.620Z"}]}}
{"timestamp":"2025-10-24T14:22:58.620Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+346000000011","state":{"step":"ask_people","language":"es","data":{},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.620Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+346000000011","metrics":{"totalTime":2688.6267996871347,"geminiTime":1215.5703691295384,"processingTime":1971.3010323101119,"intent":"clarification","confidence":0.7,"sentiment":"confused","urgency":"normal","step":"ask_people","nextStep":"ask_people","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.620Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+346000000011","model":"gemini-2.0-flash-exp","promptLength":57,"promptPreview":"Analiza la intención del cliente en es: \"Para 2 personas\"..."}}
{"timestamp":"2025-10-24T14:22:58.620Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+346000000011","responseLength":236,"processingTime":1625.0691273764126,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":2,\"time\":\"02:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\":...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":2,\"time\":\"02:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.621Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+346000000011","step":"ask_date","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":2,"time":"02:00"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.621Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+346000000011","step":"ask_date","extractedData":{"people":2,"time":"02:00"},"hasPeople":true,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.621Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_date → ask_name","data":{"phoneNumber":"+346000000011","fromStep":"ask_date","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.621Z"}}
{"timestamp":"2025-10-24T14:22:58.621Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+346000000011","method":"intelligent","language":"es","responseLength":15,"responsePreview":"¿Cómo se llama?...","fullResponse":"¿Cómo se llama?"}}
{"timestamp":"2025-10-24T14:22:58.621Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+346000000011","historyLength":3,"lastMessages":[{"role":"user","message":"Hola","timestamp":"2025-10-24T14:22:58.621Z"},{"role":"bot","message":"No entiendo qué necesito","timestamp":"2025-10-24T14:22:58.621Z"},{"role":"user","message":"Para 2 personas","timestamp":"2025-10-24T14:22:58.621Z"}],"fullHistory":[{"role":"user","message":"Hola","timestamp":"2025-10-24T14:22:58.621Z"},{"role":"bot","message":"No entiendo qué necesito","timestamp":"2025-10-24T14:22:58.621Z"},{"role":"user","message":"Para 2 personas","timestamp":"2025-10-24T14:22:58.621Z"}]}}
{"timestamp":"2025-10-24T14:22:58.621Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+346000000011","state":{"step":"ask_name","language":"es","data":{"people":2},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.622Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+346000000011","metrics":{"totalTime":1047.7759854872013,"geminiTime":1382.7288925792038,"processingTime":1985.57398942374,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_date","nextStep":"ask_name","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.622Z","level":"ERROR","category":"GEMINI_ERROR","message":"Error en Gemini: Model is overloaded","data":{"phoneNumber":"+346000000011","error":{"message":"Model is overloaded","status":503,"stack":"Error: Model is overloaded\n    at MultiLanguageSimulator.simulateError (D:\\cronosai-webhook\\scripts\\logging\\multilanguage_simulation.js:440:24)\n    at MultiLanguageSimulator.simulateCall (D:\\cronosai-webhook\\scripts\\logging\\multilanguage_simulation.js:250:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async MultiLanguageSimulator.simulateSpanish (D:\\cronosai-webhook\\scripts\\logging\\multilanguage_simulation.js:36:5)\n    at async MultiLanguageSimulator.runAllSimulations (D:\\cronosai-webhook\\scripts\\logging\\multilanguage_simulation.js:503:5)"},"retryCount":1}}
{"timestamp":"2025-10-24T14:22:58.622Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+346000000011","model":"gemini-2.0-flash-exp","promptLength":52,"promptPreview":"Analiza la intención del cliente en es: \"El viernes\"..."}}
{"timestamp":"2025-10-24T14:22:58.622Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+346000000011","responseLength":211,"processingTime":1447.359313244404,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_time\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_ques...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_time\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.623Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+346000000011","step":"ask_time","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.623Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+346000000011","step":"ask_time","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.623Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_time → ask_time","data":{"phoneNumber":"+346000000011","fromStep":"ask_time","toStep":"ask_time","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.623Z"}}
{"timestamp":"2025-10-24T14:22:58.623Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+346000000011","method":"intelligent","language":"es","responseLength":28,"responsePreview":"¿A qué hora prefieren venir?...","fullResponse":"¿A qué hora prefieren venir?"}}
{"timestamp":"2025-10-24T14:22:58.623Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+346000000011","historyLength":4,"lastMessages":[{"role":"bot","message":"No entiendo qué necesito","timestamp":"2025-10-24T14:22:58.623Z"},{"role":"user","message":"Para 2 personas","timestamp":"2025-10-24T14:22:58.623Z"},{"role":"bot","message":"El viernes","timestamp":"2025-10-24T14:22:58.623Z"}],"fullHistory":[{"role":"user","message":"Hola","timestamp":"2025-10-24T14:22:58.623Z"},{"role":"bot","message":"No entiendo qué necesito","timestamp":"2025-10-24T14:22:58.623Z"},{"role":"user","message":"Para 2 personas","timestamp":"2025-10-24T14:22:58.623Z"},{"role":"bot","message":"El viernes","timestamp":"2025-10-24T14:22:58.623Z"}]}}
{"timestamp":"2025-10-24T14:22:58.624Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+346000000011","state":{"step":"ask_time","language":"es","data":{"people":2},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.624Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+346000000011","metrics":{"totalTime":1136.5977777539565,"geminiTime":1354.844049182564,"processingTime":1847.5582478960919,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_time","nextStep":"ask_time","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.624Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+346000000011","model":"gemini-2.0-flash-exp","promptLength":49,"promptPreview":"Analiza la intención del cliente en es: \"A las 7\"..."}}
{"timestamp":"2025-10-24T14:22:58.624Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+346000000011","responseLength":236,"processingTime":1056.8768238493092,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":7,\"time\":\"07:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\":...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":7,\"time\":\"07:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.625Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+346000000011","step":"ask_name","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":7,"time":"07:00"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.625Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+346000000011","step":"ask_name","extractedData":{"people":7,"time":"07:00"},"hasPeople":true,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.625Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_name → ask_name","data":{"phoneNumber":"+346000000011","fromStep":"ask_name","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.625Z"}}
{"timestamp":"2025-10-24T14:22:58.625Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+346000000011","method":"intelligent","language":"es","responseLength":15,"responsePreview":"¿Cómo se llama?...","fullResponse":"¿Cómo se llama?"}}
{"timestamp":"2025-10-24T14:22:58.626Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+346000000011","historyLength":5,"lastMessages":[{"role":"user","message":"Para 2 personas","timestamp":"2025-10-24T14:22:58.626Z"},{"role":"bot","message":"El viernes","timestamp":"2025-10-24T14:22:58.626Z"},{"role":"user","message":"A las 7","timestamp":"2025-10-24T14:22:58.626Z"}],"fullHistory":[{"role":"user","message":"Hola","timestamp":"2025-10-24T14:22:58.626Z"},{"role":"bot","message":"No entiendo qué necesito","timestamp":"2025-10-24T14:22:58.626Z"},{"role":"user","message":"Para 2 personas","timestamp":"2025-10-24T14:22:58.626Z"},{"role":"bot","message":"El viernes","timestamp":"2025-10-24T14:22:58.626Z"},{"role":"user","message":"A las 7","timestamp":"2025-10-24T14:22:58.626Z"}]}}
{"timestamp":"2025-10-24T14:22:58.626Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+346000000011","state":{"step":"ask_name","language":"es","data":{"people":7},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.626Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+346000000011","metrics":{"totalTime":2697.8073864343387,"geminiTime":1213.3531978634646,"processingTime":2291.4316857267213,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_name","nextStep":"ask_name","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.626Z","level":"ERROR","category":"GEMINI_ERROR","message":"Error en Gemini: Model is overloaded","data":{"phoneNumber":"+346000000011","error":{"message":"Model is overloaded","status":503,"stack":"Error: Model is overloaded\n    at MultiLanguageSimulator.simulateError (D:\\cronosai-webhook\\scripts\\logging\\multilanguage_simulation.js:440:24)\n    at MultiLanguageSimulator.simulateCall (D:\\cronosai-webhook\\scripts\\logging\\multilanguage_simulation.js:250:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async MultiLanguageSimulator.simulateSpanish (D:\\cronosai-webhook\\scripts\\logging\\multilanguage_simulation.js:36:5)\n    at async MultiLanguageSimulator.runAllSimulations (D:\\cronosai-webhook\\scripts\\logging\\multilanguage_simulation.js:503:5)"},"retryCount":1}}
{"timestamp":"2025-10-24T14:22:58.627Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+346000000011","model":"gemini-2.0-flash-exp","promptLength":58,"promptPreview":"Analiza la intención del cliente en es: \"Soy María García\"..."}}
{"timestamp":"2025-10-24T14:22:58.627Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+346000000011","responseLength":211,"processingTime":1778.1267618649947,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"complete\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_ques...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"complete\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.627Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+346000000011","step":"ask_phone","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.627Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+346000000011","step":"ask_phone","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.627Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_phone → complete","data":{"phoneNumber":"+346000000011","fromStep":"ask_phone","toStep":"complete","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.627Z"}}
{"timestamp":"2025-10-24T14:22:58.627Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+346000000011","method":"intelligent","language":"es","responseLength":54,"responsePreview":"¡Perfecto! Su reserva está confirmada. ¡Que disfruten!...","fullResponse":"¡Perfecto! Su reserva está confirmada. ¡Que disfruten!"}}
{"timestamp":"2025-10-24T14:22:58.628Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+346000000011","historyLength":6,"lastMessages":[{"role":"bot","message":"El viernes","timestamp":"2025-10-24T14:22:58.628Z"},{"role":"user","message":"A las 7","timestamp":"2025-10-24T14:22:58.628Z"},{"role":"bot","message":"Soy María García","timestamp":"2025-10-24T14:22:58.628Z"}],"fullHistory":[{"role":"user","message":"Hola","timestamp":"2025-10-24T14:22:58.628Z"},{"role":"bot","message":"No entiendo qué necesito","timestamp":"2025-10-24T14:22:58.628Z"},{"role":"user","message":"Para 2 personas","timestamp":"2025-10-24T14:22:58.628Z"},{"role":"bot","message":"El viernes","timestamp":"2025-10-24T14:22:58.628Z"},{"role":"user","message":"A las 7","timestamp":"2025-10-24T14:22:58.628Z"},{"role":"bot","message":"Soy María García","timestamp":"2025-10-24T14:22:58.628Z"}]}}
{"timestamp":"2025-10-24T14:22:58.628Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+346000000011","state":{"step":"complete","language":"es","data":{"people":7},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.628Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+346000000011","metrics":{"totalTime":2163.5435589004946,"geminiTime":1370.7020743608214,"processingTime":1525.7683449712385,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_phone","nextStep":"complete","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.628Z","level":"INFO","category":"CALL_START","message":"Llamada iniciada desde +346000000012","data":{"phoneNumber":"+346000000012","userInput":"Estoy muy frustrado con este sistema","timestamp":"2025-10-24T14:22:58.628Z"}}
{"timestamp":"2025-10-24T14:22:58.628Z","level":"INFO","category":"LANGUAGE_DETECTION","message":"Idioma detectado: es (0.9)","data":{"phoneNumber":"+346000000012","detectedLang":"es","confidence":0.9,"method":"gemini"}}
{"timestamp":"2025-10-24T14:22:58.629Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+346000000012","model":"gemini-2.0-flash-exp","promptLength":78,"promptPreview":"Analiza la intención del cliente en es: \"Estoy muy frustrado con este sistema\"..."}}
{"timestamp":"2025-10-24T14:22:58.629Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+346000000012","responseLength":211,"processingTime":1357.512443720611,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.9,\"extracted_data\":{},\"sentiment\":\"frustrated\",\"urgency\":\"high\",\"next_step\":\"greeting\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_ques...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.9,\"extracted_data\":{},\"sentiment\":\"frustrated\",\"urgency\":\"high\",\"next_step\":\"greeting\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.630Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+346000000012","step":"greeting","analysis":{"intent":"reservation","confidence":0.9,"sentiment":"frustrated","urgency":"high","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.630Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+346000000012","step":"greeting","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.630Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → greeting","data":{"phoneNumber":"+346000000012","fromStep":"greeting","toStep":"greeting","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.630Z"}}
{"timestamp":"2025-10-24T14:22:58.630Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+346000000012","method":"intelligent","language":"es","responseLength":73,"responsePreview":"¡Hola! Bienvenido al restaurante. ¿Para cuántas personas será la reserva?...","fullResponse":"¡Hola! Bienvenido al restaurante. ¿Para cuántas personas será la reserva?"}}
{"timestamp":"2025-10-24T14:22:58.630Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+346000000012","historyLength":1,"lastMessages":[{"role":"user","message":"Estoy muy frustrado con este sistema","timestamp":"2025-10-24T14:22:58.630Z"}],"fullHistory":[{"role":"user","message":"Estoy muy frustrado con este sistema","timestamp":"2025-10-24T14:22:58.630Z"}]}}
{"timestamp":"2025-10-24T14:22:58.631Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+346000000012","state":{"step":"greeting","language":"es","data":{},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.631Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+346000000012","metrics":{"totalTime":1142.0719708008216,"geminiTime":1613.8654589701732,"processingTime":2329.0520686717755,"intent":"reservation","confidence":0.9,"sentiment":"frustrated","urgency":"high","step":"greeting","nextStep":"greeting","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.631Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+346000000012","model":"gemini-2.0-flash-exp","promptLength":78,"promptPreview":"Analiza la intención del cliente en es: \"Solo quiero reservar para 3 personas\"..."}}
{"timestamp":"2025-10-24T14:22:58.631Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+346000000012","responseLength":238,"processingTime":1722.1645482212316,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":3,\"time\":\"03:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_people\",\"response_type\":\"question\",\"needs_clarification...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":3,\"time\":\"03:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_people\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.631Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+346000000012","step":"ask_people","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":3,"time":"03:00"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.632Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+346000000012","step":"ask_people","extractedData":{"people":3,"time":"03:00"},"hasPeople":true,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.632Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_people → ask_people","data":{"phoneNumber":"+346000000012","fromStep":"ask_people","toStep":"ask_people","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.632Z"}}
{"timestamp":"2025-10-24T14:22:58.632Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+346000000012","method":"intelligent","language":"es","responseLength":39,"responsePreview":"¿Para cuántas personas será la reserva?...","fullResponse":"¿Para cuántas personas será la reserva?"}}
{"timestamp":"2025-10-24T14:22:58.632Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+346000000012","historyLength":2,"lastMessages":[{"role":"user","message":"Estoy muy frustrado con este sistema","timestamp":"2025-10-24T14:22:58.632Z"},{"role":"bot","message":"Solo quiero reservar para 3 personas","timestamp":"2025-10-24T14:22:58.632Z"}],"fullHistory":[{"role":"user","message":"Estoy muy frustrado con este sistema","timestamp":"2025-10-24T14:22:58.632Z"},{"role":"bot","message":"Solo quiero reservar para 3 personas","timestamp":"2025-10-24T14:22:58.632Z"}]}}
{"timestamp":"2025-10-24T14:22:58.632Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+346000000012","state":{"step":"ask_people","language":"es","data":{"people":3},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.632Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+346000000012","metrics":{"totalTime":2014.868395914595,"geminiTime":918.2869019648278,"processingTime":1533.6489341059068,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_people","nextStep":"ask_people","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.632Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+346000000012","model":"gemini-2.0-flash-exp","promptLength":56,"promptPreview":"Analiza la intención del cliente en es: \"Para el sábado\"..."}}
{"timestamp":"2025-10-24T14:22:58.633Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+346000000012","responseLength":211,"processingTime":1308.788577287707,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_date\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_ques...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_date\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.633Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+346000000012","step":"ask_date","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.633Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+346000000012","step":"ask_date","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.633Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_date → ask_date","data":{"phoneNumber":"+346000000012","fromStep":"ask_date","toStep":"ask_date","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.633Z"}}
{"timestamp":"2025-10-24T14:22:58.633Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+346000000012","method":"intelligent","language":"es","responseLength":36,"responsePreview":"¿Para qué fecha necesita la reserva?...","fullResponse":"¿Para qué fecha necesita la reserva?"}}
{"timestamp":"2025-10-24T14:22:58.633Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+346000000012","historyLength":3,"lastMessages":[{"role":"user","message":"Estoy muy frustrado con este sistema","timestamp":"2025-10-24T14:22:58.633Z"},{"role":"bot","message":"Solo quiero reservar para 3 personas","timestamp":"2025-10-24T14:22:58.633Z"},{"role":"user","message":"Para el sábado","timestamp":"2025-10-24T14:22:58.633Z"}],"fullHistory":[{"role":"user","message":"Estoy muy frustrado con este sistema","timestamp":"2025-10-24T14:22:58.633Z"},{"role":"bot","message":"Solo quiero reservar para 3 personas","timestamp":"2025-10-24T14:22:58.633Z"},{"role":"user","message":"Para el sábado","timestamp":"2025-10-24T14:22:58.633Z"}]}}
{"timestamp":"2025-10-24T14:22:58.634Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+346000000012","state":{"step":"ask_date","language":"es","data":{"people":3},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.634Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+346000000012","metrics":{"totalTime":1112.726364403236,"geminiTime":1724.8788806557718,"processingTime":1039.3509637799405,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_date","nextStep":"ask_date","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.634Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+346000000012","model":"gemini-2.0-flash-exp","promptLength":49,"promptPreview":"Analiza la intención del cliente en es: \"A las 9\"..."}}
{"timestamp":"2025-10-24T14:22:58.634Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+346000000012","responseLength":236,"processingTime":1037.8044777307593,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":9,\"time\":\"09:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_time\",\"response_type\":\"question\",\"needs_clarification\":...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":9,\"time\":\"09:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_time\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.634Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+346000000012","step":"ask_time","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":9,"time":"09:00"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.634Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+346000000012","step":"ask_time","extractedData":{"people":9,"time":"09:00"},"hasPeople":true,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.634Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_time → ask_time","data":{"phoneNumber":"+346000000012","fromStep":"ask_time","toStep":"ask_time","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.634Z"}}
{"timestamp":"2025-10-24T14:22:58.635Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+346000000012","method":"intelligent","language":"es","responseLength":28,"responsePreview":"¿A qué hora prefieren venir?...","fullResponse":"¿A qué hora prefieren venir?"}}
{"timestamp":"2025-10-24T14:22:58.635Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+346000000012","historyLength":4,"lastMessages":[{"role":"bot","message":"Solo quiero reservar para 3 personas","timestamp":"2025-10-24T14:22:58.635Z"},{"role":"user","message":"Para el sábado","timestamp":"2025-10-24T14:22:58.635Z"},{"role":"bot","message":"A las 9","timestamp":"2025-10-24T14:22:58.635Z"}],"fullHistory":[{"role":"user","message":"Estoy muy frustrado con este sistema","timestamp":"2025-10-24T14:22:58.635Z"},{"role":"bot","message":"Solo quiero reservar para 3 personas","timestamp":"2025-10-24T14:22:58.635Z"},{"role":"user","message":"Para el sábado","timestamp":"2025-10-24T14:22:58.635Z"},{"role":"bot","message":"A las 9","timestamp":"2025-10-24T14:22:58.635Z"}]}}
{"timestamp":"2025-10-24T14:22:58.635Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+346000000012","state":{"step":"ask_time","language":"es","data":{"people":9},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.635Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+346000000012","metrics":{"totalTime":1664.1981260183227,"geminiTime":1696.3511644756277,"processingTime":1853.4133111235328,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_time","nextStep":"ask_time","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.635Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+346000000012","model":"gemini-2.0-flash-exp","promptLength":54,"promptPreview":"Analiza la intención del cliente en es: \"Carlos López\"..."}}
{"timestamp":"2025-10-24T14:22:58.636Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+346000000012","responseLength":211,"processingTime":1264.1174114374571,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_ques...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.636Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+346000000012","step":"ask_name","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.636Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+346000000012","step":"ask_name","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.636Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_name → ask_name","data":{"phoneNumber":"+346000000012","fromStep":"ask_name","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.636Z"}}
{"timestamp":"2025-10-24T14:22:58.636Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+346000000012","method":"intelligent","language":"es","responseLength":15,"responsePreview":"¿Cómo se llama?...","fullResponse":"¿Cómo se llama?"}}
{"timestamp":"2025-10-24T14:22:58.637Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+346000000012","historyLength":5,"lastMessages":[{"role":"user","message":"Para el sábado","timestamp":"2025-10-24T14:22:58.637Z"},{"role":"bot","message":"A las 9","timestamp":"2025-10-24T14:22:58.637Z"},{"role":"user","message":"Carlos López","timestamp":"2025-10-24T14:22:58.637Z"}],"fullHistory":[{"role":"user","message":"Estoy muy frustrado con este sistema","timestamp":"2025-10-24T14:22:58.637Z"},{"role":"bot","message":"Solo quiero reservar para 3 personas","timestamp":"2025-10-24T14:22:58.637Z"},{"role":"user","message":"Para el sábado","timestamp":"2025-10-24T14:22:58.637Z"},{"role":"bot","message":"A las 9","timestamp":"2025-10-24T14:22:58.637Z"},{"role":"user","message":"Carlos López","timestamp":"2025-10-24T14:22:58.637Z"}]}}
{"timestamp":"2025-10-24T14:22:58.637Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+346000000012","state":{"step":"ask_name","language":"es","data":{"people":9},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.637Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+346000000012","metrics":{"totalTime":1814.5308519533542,"geminiTime":1207.4596720122634,"processingTime":1812.5606552210645,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_name","nextStep":"ask_name","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.637Z","level":"INFO","category":"CALL_START","message":"Llamada iniciada desde +12345678901","data":{"phoneNumber":"+12345678901","userInput":"Hello, I want to make a reservation","timestamp":"2025-10-24T14:22:58.637Z"}}
{"timestamp":"2025-10-24T14:22:58.638Z","level":"INFO","category":"LANGUAGE_DETECTION","message":"Idioma detectado: en (0.8)","data":{"phoneNumber":"+12345678901","detectedLang":"en","confidence":0.8,"method":"gemini"}}
{"timestamp":"2025-10-24T14:22:58.638Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+12345678901","model":"gemini-2.0-flash-exp","promptLength":77,"promptPreview":"Analiza la intención del cliente en en: \"Hello, I want to make a reservation\"..."}}
{"timestamp":"2025-10-24T14:22:58.638Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+12345678901","responseLength":211,"processingTime":903.4659634204562,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"greeting\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_ques...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"greeting\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.638Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+12345678901","step":"greeting","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.638Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+12345678901","step":"greeting","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.639Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → greeting","data":{"phoneNumber":"+12345678901","fromStep":"greeting","toStep":"greeting","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.639Z"}}
{"timestamp":"2025-10-24T14:22:58.639Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+12345678901","method":"intelligent","language":"en","responseLength":78,"responsePreview":"Hello! Welcome to the restaurant. How many people will the reservation be for?...","fullResponse":"Hello! Welcome to the restaurant. How many people will the reservation be for?"}}
{"timestamp":"2025-10-24T14:22:58.639Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+12345678901","historyLength":1,"lastMessages":[{"role":"user","message":"Hello, I want to make a reservation","timestamp":"2025-10-24T14:22:58.639Z"}],"fullHistory":[{"role":"user","message":"Hello, I want to make a reservation","timestamp":"2025-10-24T14:22:58.639Z"}]}}
{"timestamp":"2025-10-24T14:22:58.639Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+12345678901","state":{"step":"greeting","language":"en","data":{},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.639Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+12345678901","metrics":{"totalTime":1733.4235584748408,"geminiTime":1100.612335749304,"processingTime":2141.6312485991566,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"greeting","nextStep":"greeting","language":"en","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.639Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+12345678901","model":"gemini-2.0-flash-exp","promptLength":54,"promptPreview":"Analiza la intención del cliente en en: \"For 2 people\"..."}}
{"timestamp":"2025-10-24T14:22:58.639Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+12345678901","responseLength":238,"processingTime":1283.8874351482161,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":2,\"time\":\"02:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_people\",\"response_type\":\"question\",\"needs_clarification...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":2,\"time\":\"02:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_people\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.640Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+12345678901","step":"ask_people","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":2,"time":"02:00"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.640Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+12345678901","step":"ask_people","extractedData":{"people":2,"time":"02:00"},"hasPeople":true,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.640Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_people → ask_people","data":{"phoneNumber":"+12345678901","fromStep":"ask_people","toStep":"ask_people","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.640Z"}}
{"timestamp":"2025-10-24T14:22:58.640Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+12345678901","method":"intelligent","language":"en","responseLength":44,"responsePreview":"How many people will the reservation be for?...","fullResponse":"How many people will the reservation be for?"}}
{"timestamp":"2025-10-24T14:22:58.640Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+12345678901","historyLength":2,"lastMessages":[{"role":"user","message":"Hello, I want to make a reservation","timestamp":"2025-10-24T14:22:58.640Z"},{"role":"bot","message":"For 2 people","timestamp":"2025-10-24T14:22:58.640Z"}],"fullHistory":[{"role":"user","message":"Hello, I want to make a reservation","timestamp":"2025-10-24T14:22:58.640Z"},{"role":"bot","message":"For 2 people","timestamp":"2025-10-24T14:22:58.640Z"}]}}
{"timestamp":"2025-10-24T14:22:58.640Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+12345678901","state":{"step":"ask_people","language":"en","data":{"people":2},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.641Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+12345678901","metrics":{"totalTime":2943.710186169121,"geminiTime":1390.2052019892162,"processingTime":1539.089958052946,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_people","nextStep":"ask_people","language":"en","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.641Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+12345678901","model":"gemini-2.0-flash-exp","promptLength":54,"promptPreview":"Analiza la intención del cliente en en: \"For tomorrow\"..."}}
{"timestamp":"2025-10-24T14:22:58.641Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+12345678901","responseLength":230,"processingTime":942.8693077305661,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"date\":\"2025-10-25\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_date\",\"response_type\":\"question\",\"needs_clarification\":false,...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"date\":\"2025-10-25\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_date\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.641Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+12345678901","step":"ask_date","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"date":"2025-10-25"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.641Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+12345678901","step":"ask_date","extractedData":{"date":"2025-10-25"},"hasPeople":false,"hasDate":true,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.641Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_date → ask_date","data":{"phoneNumber":"+12345678901","fromStep":"ask_date","toStep":"ask_date","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.641Z"}}
{"timestamp":"2025-10-24T14:22:58.642Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+12345678901","method":"intelligent","language":"en","responseLength":42,"responsePreview":"What date do you need the reservation for?...","fullResponse":"What date do you need the reservation for?"}}
{"timestamp":"2025-10-24T14:22:58.642Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+12345678901","historyLength":3,"lastMessages":[{"role":"user","message":"Hello, I want to make a reservation","timestamp":"2025-10-24T14:22:58.642Z"},{"role":"bot","message":"For 2 people","timestamp":"2025-10-24T14:22:58.642Z"},{"role":"user","message":"For tomorrow","timestamp":"2025-10-24T14:22:58.642Z"}],"fullHistory":[{"role":"user","message":"Hello, I want to make a reservation","timestamp":"2025-10-24T14:22:58.642Z"},{"role":"bot","message":"For 2 people","timestamp":"2025-10-24T14:22:58.642Z"},{"role":"user","message":"For tomorrow","timestamp":"2025-10-24T14:22:58.642Z"}]}}
{"timestamp":"2025-10-24T14:22:58.642Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+12345678901","state":{"step":"ask_date","language":"en","data":{"people":2},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.642Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+12345678901","metrics":{"totalTime":2967.432291199838,"geminiTime":1735.7880581090292,"processingTime":1406.8613353269716,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_date","nextStep":"ask_date","language":"en","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.642Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+12345678901","model":"gemini-2.0-flash-exp","promptLength":49,"promptPreview":"Analiza la intención del cliente en en: \"At 7 PM\"..."}}
{"timestamp":"2025-10-24T14:22:58.643Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+12345678901","responseLength":236,"processingTime":1146.5502875952398,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":7,\"time\":\"19:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_time\",\"response_type\":\"question\",\"needs_clarification\":...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":7,\"time\":\"19:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_time\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.643Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+12345678901","step":"ask_time","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":7,"time":"19:00"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.643Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+12345678901","step":"ask_time","extractedData":{"people":7,"time":"19:00"},"hasPeople":true,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.643Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_time → ask_time","data":{"phoneNumber":"+12345678901","fromStep":"ask_time","toStep":"ask_time","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.643Z"}}
{"timestamp":"2025-10-24T14:22:58.643Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+12345678901","method":"intelligent","language":"en","responseLength":35,"responsePreview":"What time would you prefer to come?...","fullResponse":"What time would you prefer to come?"}}
{"timestamp":"2025-10-24T14:22:58.644Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+12345678901","historyLength":4,"lastMessages":[{"role":"bot","message":"For 2 people","timestamp":"2025-10-24T14:22:58.644Z"},{"role":"user","message":"For tomorrow","timestamp":"2025-10-24T14:22:58.644Z"},{"role":"bot","message":"At 7 PM","timestamp":"2025-10-24T14:22:58.644Z"}],"fullHistory":[{"role":"user","message":"Hello, I want to make a reservation","timestamp":"2025-10-24T14:22:58.644Z"},{"role":"bot","message":"For 2 people","timestamp":"2025-10-24T14:22:58.644Z"},{"role":"user","message":"For tomorrow","timestamp":"2025-10-24T14:22:58.644Z"},{"role":"bot","message":"At 7 PM","timestamp":"2025-10-24T14:22:58.644Z"}]}}
{"timestamp":"2025-10-24T14:22:58.644Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+12345678901","state":{"step":"ask_time","language":"en","data":{"people":7},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.644Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+12345678901","metrics":{"totalTime":1664.2887319953466,"geminiTime":1334.0549373199294,"processingTime":1777.2683490086831,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_time","nextStep":"ask_time","language":"en","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.644Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+12345678901","model":"gemini-2.0-flash-exp","promptLength":63,"promptPreview":"Analiza la intención del cliente en en: \"My name is John Smith\"..."}}
{"timestamp":"2025-10-24T14:22:58.644Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+12345678901","responseLength":224,"processingTime":1407.113337552978,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"name\":\"John\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\":false,\"clari...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"name\":\"John\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.644Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+12345678901","step":"ask_name","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"name":"John"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.644Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+12345678901","step":"ask_name","extractedData":{"name":"John"},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":true,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.645Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_name → ask_name","data":{"phoneNumber":"+12345678901","fromStep":"ask_name","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.645Z"}}
{"timestamp":"2025-10-24T14:22:58.645Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+12345678901","method":"intelligent","language":"en","responseLength":17,"responsePreview":"What's your name?...","fullResponse":"What's your name?"}}
{"timestamp":"2025-10-24T14:22:58.645Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+12345678901","historyLength":5,"lastMessages":[{"role":"user","message":"For tomorrow","timestamp":"2025-10-24T14:22:58.645Z"},{"role":"bot","message":"At 7 PM","timestamp":"2025-10-24T14:22:58.645Z"},{"role":"user","message":"My name is John Smith","timestamp":"2025-10-24T14:22:58.645Z"}],"fullHistory":[{"role":"user","message":"Hello, I want to make a reservation","timestamp":"2025-10-24T14:22:58.645Z"},{"role":"bot","message":"For 2 people","timestamp":"2025-10-24T14:22:58.645Z"},{"role":"user","message":"For tomorrow","timestamp":"2025-10-24T14:22:58.645Z"},{"role":"bot","message":"At 7 PM","timestamp":"2025-10-24T14:22:58.645Z"},{"role":"user","message":"My name is John Smith","timestamp":"2025-10-24T14:22:58.645Z"}]}}
{"timestamp":"2025-10-24T14:22:58.645Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+12345678901","state":{"step":"ask_name","language":"en","data":{"people":7},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.645Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+12345678901","metrics":{"totalTime":2206.589749012915,"geminiTime":1316.8206120507955,"processingTime":2088.71712292889,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_name","nextStep":"ask_name","language":"en","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.646Z","level":"ERROR","category":"SYSTEM_ERROR","message":"Error del sistema: Database connection failed","data":{"phoneNumber":"+12345678901","error":{"message":"Database connection failed","stack":"Error: Database connection failed\n    at MultiLanguageSimulator.simulateError (D:\\cronosai-webhook\\scripts\\logging\\multilanguage_simulation.js:444:24)\n    at MultiLanguageSimulator.simulateCall (D:\\cronosai-webhook\\scripts\\logging\\multilanguage_simulation.js:250:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async MultiLanguageSimulator.simulateEnglish (D:\\cronosai-webhook\\scripts\\logging\\multilanguage_simulation.js:63:5)\n    at async MultiLanguageSimulator.runAllSimulations (D:\\cronosai-webhook\\scripts\\logging\\multilanguage_simulation.js:504:5)","name":"Error"},"context":"database"}}
{"timestamp":"2025-10-24T14:22:58.646Z","level":"INFO","category":"CALL_START","message":"Llamada iniciada desde +123456789011","data":{"phoneNumber":"+123456789011","userInput":"Hi there","timestamp":"2025-10-24T14:22:58.646Z"}}
{"timestamp":"2025-10-24T14:22:58.646Z","level":"INFO","category":"LANGUAGE_DETECTION","message":"Idioma detectado: en (0.8)","data":{"phoneNumber":"+123456789011","detectedLang":"en","confidence":0.8,"method":"gemini"}}
{"timestamp":"2025-10-24T14:22:58.646Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+123456789011","model":"gemini-2.0-flash-exp","promptLength":50,"promptPreview":"Analiza la intención del cliente en en: \"Hi there\"..."}}
{"timestamp":"2025-10-24T14:22:58.646Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+123456789011","responseLength":211,"processingTime":1659.76949559275,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"greeting\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_ques...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"greeting\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.646Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+123456789011","step":"greeting","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.647Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+123456789011","step":"greeting","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.647Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → greeting","data":{"phoneNumber":"+123456789011","fromStep":"greeting","toStep":"greeting","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.647Z"}}
{"timestamp":"2025-10-24T14:22:58.647Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+123456789011","method":"intelligent","language":"en","responseLength":78,"responsePreview":"Hello! Welcome to the restaurant. How many people will the reservation be for?...","fullResponse":"Hello! Welcome to the restaurant. How many people will the reservation be for?"}}
{"timestamp":"2025-10-24T14:22:58.647Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+123456789011","historyLength":1,"lastMessages":[{"role":"user","message":"Hi there","timestamp":"2025-10-24T14:22:58.647Z"}],"fullHistory":[{"role":"user","message":"Hi there","timestamp":"2025-10-24T14:22:58.647Z"}]}}
{"timestamp":"2025-10-24T14:22:58.647Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+123456789011","state":{"step":"greeting","language":"en","data":{},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.647Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+123456789011","metrics":{"totalTime":2681.9168585238012,"geminiTime":1046.5062384942078,"processingTime":1495.4545118143417,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"greeting","nextStep":"greeting","language":"en","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.648Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+123456789011","model":"gemini-2.0-flash-exp","promptLength":69,"promptPreview":"Analiza la intención del cliente en en: \"I need a table for 6 people\"..."}}
{"timestamp":"2025-10-24T14:22:58.648Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+123456789011","responseLength":238,"processingTime":1452.6863368134939,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":6,\"time\":\"06:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_people\",\"response_type\":\"question\",\"needs_clarification...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":6,\"time\":\"06:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_people\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.648Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+123456789011","step":"ask_people","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":6,"time":"06:00"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.648Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+123456789011","step":"ask_people","extractedData":{"people":6,"time":"06:00"},"hasPeople":true,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.648Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_people → ask_people","data":{"phoneNumber":"+123456789011","fromStep":"ask_people","toStep":"ask_people","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.648Z"}}
{"timestamp":"2025-10-24T14:22:58.648Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+123456789011","method":"intelligent","language":"en","responseLength":44,"responsePreview":"How many people will the reservation be for?...","fullResponse":"How many people will the reservation be for?"}}
{"timestamp":"2025-10-24T14:22:58.649Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+123456789011","historyLength":2,"lastMessages":[{"role":"user","message":"Hi there","timestamp":"2025-10-24T14:22:58.649Z"},{"role":"bot","message":"I need a table for 6 people","timestamp":"2025-10-24T14:22:58.649Z"}],"fullHistory":[{"role":"user","message":"Hi there","timestamp":"2025-10-24T14:22:58.649Z"},{"role":"bot","message":"I need a table for 6 people","timestamp":"2025-10-24T14:22:58.649Z"}]}}
{"timestamp":"2025-10-24T14:22:58.649Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+123456789011","state":{"step":"ask_people","language":"en","data":{"people":6},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.649Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+123456789011","metrics":{"totalTime":1939.138074211176,"geminiTime":1679.5190146403902,"processingTime":1152.4118283994503,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_people","nextStep":"ask_people","language":"en","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.649Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+123456789011","model":"gemini-2.0-flash-exp","promptLength":53,"promptPreview":"Analiza la intención del cliente en en: \"Next Friday\"..."}}
{"timestamp":"2025-10-24T14:22:58.649Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+123456789011","responseLength":211,"processingTime":1405.9176982500162,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_date\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_ques...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_date\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.649Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+123456789011","step":"ask_date","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.650Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+123456789011","step":"ask_date","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.650Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_date → ask_date","data":{"phoneNumber":"+123456789011","fromStep":"ask_date","toStep":"ask_date","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.650Z"}}
{"timestamp":"2025-10-24T14:22:58.650Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+123456789011","method":"intelligent","language":"en","responseLength":42,"responsePreview":"What date do you need the reservation for?...","fullResponse":"What date do you need the reservation for?"}}
{"timestamp":"2025-10-24T14:22:58.650Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+123456789011","historyLength":3,"lastMessages":[{"role":"user","message":"Hi there","timestamp":"2025-10-24T14:22:58.650Z"},{"role":"bot","message":"I need a table for 6 people","timestamp":"2025-10-24T14:22:58.650Z"},{"role":"user","message":"Next Friday","timestamp":"2025-10-24T14:22:58.650Z"}],"fullHistory":[{"role":"user","message":"Hi there","timestamp":"2025-10-24T14:22:58.650Z"},{"role":"bot","message":"I need a table for 6 people","timestamp":"2025-10-24T14:22:58.650Z"},{"role":"user","message":"Next Friday","timestamp":"2025-10-24T14:22:58.650Z"}]}}
{"timestamp":"2025-10-24T14:22:58.650Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+123456789011","state":{"step":"ask_date","language":"en","data":{"people":6},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.650Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+123456789011","metrics":{"totalTime":1015.0475794580367,"geminiTime":1117.4960369785736,"processingTime":2435.5356461236133,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_date","nextStep":"ask_date","language":"en","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.651Z","level":"WARN","category":"FALLBACK_USAGE","message":"Usando fallback: Gemini timeout","data":{"phoneNumber":"+123456789011","reason":"Gemini timeout","fallbackType":"getFallbackIntent","timestamp":"2025-10-24T14:22:58.651Z"}}
{"timestamp":"2025-10-24T14:22:58.651Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+123456789011","model":"gemini-2.0-flash-exp","promptLength":58,"promptPreview":"Analiza la intención del cliente en en: \"Around 8 o'clock\"..."}}
{"timestamp":"2025-10-24T14:22:58.651Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+123456789011","responseLength":236,"processingTime":1751.1282518600617,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":8,\"time\":\"08:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_time\",\"response_type\":\"question\",\"needs_clarification\":...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":8,\"time\":\"08:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_time\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.651Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+123456789011","step":"ask_time","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":8,"time":"08:00"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.651Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+123456789011","step":"ask_time","extractedData":{"people":8,"time":"08:00"},"hasPeople":true,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.651Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_time → ask_time","data":{"phoneNumber":"+123456789011","fromStep":"ask_time","toStep":"ask_time","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.651Z"}}
{"timestamp":"2025-10-24T14:22:58.651Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+123456789011","method":"intelligent","language":"en","responseLength":35,"responsePreview":"What time would you prefer to come?...","fullResponse":"What time would you prefer to come?"}}
{"timestamp":"2025-10-24T14:22:58.652Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+123456789011","historyLength":4,"lastMessages":[{"role":"bot","message":"I need a table for 6 people","timestamp":"2025-10-24T14:22:58.652Z"},{"role":"user","message":"Next Friday","timestamp":"2025-10-24T14:22:58.652Z"},{"role":"bot","message":"Around 8 o'clock","timestamp":"2025-10-24T14:22:58.652Z"}],"fullHistory":[{"role":"user","message":"Hi there","timestamp":"2025-10-24T14:22:58.652Z"},{"role":"bot","message":"I need a table for 6 people","timestamp":"2025-10-24T14:22:58.652Z"},{"role":"user","message":"Next Friday","timestamp":"2025-10-24T14:22:58.652Z"},{"role":"bot","message":"Around 8 o'clock","timestamp":"2025-10-24T14:22:58.652Z"}]}}
{"timestamp":"2025-10-24T14:22:58.652Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+123456789011","state":{"step":"ask_time","language":"en","data":{"people":8},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.652Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+123456789011","metrics":{"totalTime":2441.293416781872,"geminiTime":1044.5771655020037,"processingTime":2425.6026848368147,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_time","nextStep":"ask_time","language":"en","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.652Z","level":"ERROR","category":"GEMINI_ERROR","message":"Error en Gemini: Rate limit exceeded","data":{"phoneNumber":"+123456789011","error":{"message":"Rate limit exceeded","status":429,"stack":"Error: Rate limit exceeded\n    at MultiLanguageSimulator.simulateError (D:\\cronosai-webhook\\scripts\\logging\\multilanguage_simulation.js:440:24)\n    at MultiLanguageSimulator.simulateCall (D:\\cronosai-webhook\\scripts\\logging\\multilanguage_simulation.js:250:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async MultiLanguageSimulator.simulateEnglish (D:\\cronosai-webhook\\scripts\\logging\\multilanguage_simulation.js:72:5)\n    at async MultiLanguageSimulator.runAllSimulations (D:\\cronosai-webhook\\scripts\\logging\\multilanguage_simulation.js:504:5)"},"retryCount":1}}
{"timestamp":"2025-10-24T14:22:58.652Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+123456789011","model":"gemini-2.0-flash-exp","promptLength":59,"promptPreview":"Analiza la intención del cliente en en: \"I'm Sarah Johnson\"..."}}
{"timestamp":"2025-10-24T14:22:58.652Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+123456789011","responseLength":211,"processingTime":1029.795854426589,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_ques...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.653Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+123456789011","step":"ask_name","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.653Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+123456789011","step":"ask_name","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.653Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_name → ask_name","data":{"phoneNumber":"+123456789011","fromStep":"ask_name","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.653Z"}}
{"timestamp":"2025-10-24T14:22:58.653Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+123456789011","method":"intelligent","language":"en","responseLength":17,"responsePreview":"What's your name?...","fullResponse":"What's your name?"}}
{"timestamp":"2025-10-24T14:22:58.653Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+123456789011","historyLength":5,"lastMessages":[{"role":"user","message":"Next Friday","timestamp":"2025-10-24T14:22:58.653Z"},{"role":"bot","message":"Around 8 o'clock","timestamp":"2025-10-24T14:22:58.653Z"},{"role":"user","message":"I'm Sarah Johnson","timestamp":"2025-10-24T14:22:58.653Z"}],"fullHistory":[{"role":"user","message":"Hi there","timestamp":"2025-10-24T14:22:58.653Z"},{"role":"bot","message":"I need a table for 6 people","timestamp":"2025-10-24T14:22:58.653Z"},{"role":"user","message":"Next Friday","timestamp":"2025-10-24T14:22:58.653Z"},{"role":"bot","message":"Around 8 o'clock","timestamp":"2025-10-24T14:22:58.653Z"},{"role":"user","message":"I'm Sarah Johnson","timestamp":"2025-10-24T14:22:58.653Z"}]}}
{"timestamp":"2025-10-24T14:22:58.653Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+123456789011","state":{"step":"ask_name","language":"en","data":{"people":8},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.654Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+123456789011","metrics":{"totalTime":2988.598995287263,"geminiTime":1678.0204228171406,"processingTime":2267.028507203255,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_name","nextStep":"ask_name","language":"en","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.654Z","level":"INFO","category":"CALL_START","message":"Llamada iniciada desde +123456789012","data":{"phoneNumber":"+123456789012","userInput":"Hello","timestamp":"2025-10-24T14:22:58.654Z"}}
{"timestamp":"2025-10-24T14:22:58.654Z","level":"INFO","category":"LANGUAGE_DETECTION","message":"Idioma detectado: en (0.8)","data":{"phoneNumber":"+123456789012","detectedLang":"en","confidence":0.8,"method":"gemini"}}
{"timestamp":"2025-10-24T14:22:58.654Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+123456789012","model":"gemini-2.0-flash-exp","promptLength":47,"promptPreview":"Analiza la intención del cliente en en: \"Hello\"..."}}
{"timestamp":"2025-10-24T14:22:58.654Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+123456789012","responseLength":211,"processingTime":1548.7253545384065,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"greeting\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_ques...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"greeting\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.655Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+123456789012","step":"greeting","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.655Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+123456789012","step":"greeting","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.655Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → greeting","data":{"phoneNumber":"+123456789012","fromStep":"greeting","toStep":"greeting","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.655Z"}}
{"timestamp":"2025-10-24T14:22:58.655Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+123456789012","method":"intelligent","language":"en","responseLength":78,"responsePreview":"Hello! Welcome to the restaurant. How many people will the reservation be for?...","fullResponse":"Hello! Welcome to the restaurant. How many people will the reservation be for?"}}
{"timestamp":"2025-10-24T14:22:58.655Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+123456789012","historyLength":1,"lastMessages":[{"role":"user","message":"Hello","timestamp":"2025-10-24T14:22:58.655Z"}],"fullHistory":[{"role":"user","message":"Hello","timestamp":"2025-10-24T14:22:58.655Z"}]}}
{"timestamp":"2025-10-24T14:22:58.655Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+123456789012","state":{"step":"greeting","language":"en","data":{},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.656Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+123456789012","metrics":{"totalTime":2928.8931298028165,"geminiTime":952.7225292838417,"processingTime":1176.9985625092252,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"greeting","nextStep":"greeting","language":"en","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.656Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+123456789012","model":"gemini-2.0-flash-exp","promptLength":74,"promptPreview":"Analiza la intención del cliente en en: \"I don't understand what you need\"..."}}
{"timestamp":"2025-10-24T14:22:58.656Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+123456789012","responseLength":215,"processingTime":1350.3550608317792,"responsePreview":"{\"intent\":\"clarification\",\"confidence\":0.7,\"extracted_data\":{},\"sentiment\":\"confused\",\"urgency\":\"normal\",\"next_step\":\"ask_people\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_...","fullResponse":"{\"intent\":\"clarification\",\"confidence\":0.7,\"extracted_data\":{},\"sentiment\":\"confused\",\"urgency\":\"normal\",\"next_step\":\"ask_people\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.656Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+123456789012","step":"ask_people","analysis":{"intent":"clarification","confidence":0.7,"sentiment":"confused","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.656Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+123456789012","step":"ask_people","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.656Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_people → ask_people","data":{"phoneNumber":"+123456789012","fromStep":"ask_people","toStep":"ask_people","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.656Z"}}
{"timestamp":"2025-10-24T14:22:58.657Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+123456789012","method":"intelligent","language":"en","responseLength":44,"responsePreview":"How many people will the reservation be for?...","fullResponse":"How many people will the reservation be for?"}}
{"timestamp":"2025-10-24T14:22:58.657Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+123456789012","historyLength":2,"lastMessages":[{"role":"user","message":"Hello","timestamp":"2025-10-24T14:22:58.657Z"},{"role":"bot","message":"I don't understand what you need","timestamp":"2025-10-24T14:22:58.657Z"}],"fullHistory":[{"role":"user","message":"Hello","timestamp":"2025-10-24T14:22:58.657Z"},{"role":"bot","message":"I don't understand what you need","timestamp":"2025-10-24T14:22:58.657Z"}]}}
{"timestamp":"2025-10-24T14:22:58.657Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+123456789012","state":{"step":"ask_people","language":"en","data":{},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.657Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+123456789012","metrics":{"totalTime":1762.5834145621816,"geminiTime":1019.7848359280945,"processingTime":2480.86473748597,"intent":"clarification","confidence":0.7,"sentiment":"confused","urgency":"normal","step":"ask_people","nextStep":"ask_people","language":"en","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.657Z","level":"ERROR","category":"GEMINI_ERROR","message":"Error en Gemini: Rate limit exceeded","data":{"phoneNumber":"+123456789012","error":{"message":"Rate limit exceeded","status":429,"stack":"Error: Rate limit exceeded\n    at MultiLanguageSimulator.simulateError (D:\\cronosai-webhook\\scripts\\logging\\multilanguage_simulation.js:440:24)\n    at MultiLanguageSimulator.simulateCall (D:\\cronosai-webhook\\scripts\\logging\\multilanguage_simulation.js:250:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async MultiLanguageSimulator.simulateEnglish (D:\\cronosai-webhook\\scripts\\logging\\multilanguage_simulation.js:81:5)\n    at async MultiLanguageSimulator.runAllSimulations (D:\\cronosai-webhook\\scripts\\logging\\multilanguage_simulation.js:504:5)"},"retryCount":1}}
{"timestamp":"2025-10-24T14:22:58.657Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+123456789012","model":"gemini-2.0-flash-exp","promptLength":54,"promptPreview":"Analiza la intención del cliente en en: \"For 4 people\"..."}}
{"timestamp":"2025-10-24T14:22:58.658Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+123456789012","responseLength":236,"processingTime":1123.934576077427,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":4,\"time\":\"04:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\":...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":4,\"time\":\"04:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.658Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+123456789012","step":"ask_date","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":4,"time":"04:00"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.658Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+123456789012","step":"ask_date","extractedData":{"people":4,"time":"04:00"},"hasPeople":true,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.658Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_date → ask_name","data":{"phoneNumber":"+123456789012","fromStep":"ask_date","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.658Z"}}
{"timestamp":"2025-10-24T14:22:58.658Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+123456789012","method":"intelligent","language":"en","responseLength":17,"responsePreview":"What's your name?...","fullResponse":"What's your name?"}}
{"timestamp":"2025-10-24T14:22:58.658Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+123456789012","historyLength":3,"lastMessages":[{"role":"user","message":"Hello","timestamp":"2025-10-24T14:22:58.658Z"},{"role":"bot","message":"I don't understand what you need","timestamp":"2025-10-24T14:22:58.658Z"},{"role":"user","message":"For 4 people","timestamp":"2025-10-24T14:22:58.658Z"}],"fullHistory":[{"role":"user","message":"Hello","timestamp":"2025-10-24T14:22:58.658Z"},{"role":"bot","message":"I don't understand what you need","timestamp":"2025-10-24T14:22:58.658Z"},{"role":"user","message":"For 4 people","timestamp":"2025-10-24T14:22:58.658Z"}]}}
{"timestamp":"2025-10-24T14:22:58.659Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+123456789012","state":{"step":"ask_name","language":"en","data":{"people":4},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.659Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+123456789012","metrics":{"totalTime":2856.578550367817,"geminiTime":1031.0162207186536,"processingTime":1809.8956804514974,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_date","nextStep":"ask_name","language":"en","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.659Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+123456789012","model":"gemini-2.0-flash-exp","promptLength":54,"promptPreview":"Analiza la intención del cliente en en: \"This weekend\"..."}}
{"timestamp":"2025-10-24T14:22:58.659Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+123456789012","responseLength":211,"processingTime":924.1857589263141,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_time\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_ques...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_time\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.659Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+123456789012","step":"ask_time","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.659Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+123456789012","step":"ask_time","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.660Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_time → ask_time","data":{"phoneNumber":"+123456789012","fromStep":"ask_time","toStep":"ask_time","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.660Z"}}
{"timestamp":"2025-10-24T14:22:58.660Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+123456789012","method":"intelligent","language":"en","responseLength":35,"responsePreview":"What time would you prefer to come?...","fullResponse":"What time would you prefer to come?"}}
{"timestamp":"2025-10-24T14:22:58.660Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+123456789012","historyLength":4,"lastMessages":[{"role":"bot","message":"I don't understand what you need","timestamp":"2025-10-24T14:22:58.660Z"},{"role":"user","message":"For 4 people","timestamp":"2025-10-24T14:22:58.660Z"},{"role":"bot","message":"This weekend","timestamp":"2025-10-24T14:22:58.660Z"}],"fullHistory":[{"role":"user","message":"Hello","timestamp":"2025-10-24T14:22:58.660Z"},{"role":"bot","message":"I don't understand what you need","timestamp":"2025-10-24T14:22:58.660Z"},{"role":"user","message":"For 4 people","timestamp":"2025-10-24T14:22:58.660Z"},{"role":"bot","message":"This weekend","timestamp":"2025-10-24T14:22:58.660Z"}]}}
{"timestamp":"2025-10-24T14:22:58.660Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+123456789012","state":{"step":"ask_time","language":"en","data":{"people":4},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.660Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+123456789012","metrics":{"totalTime":1104.776572756482,"geminiTime":1119.9150875553798,"processingTime":1165.732452391976,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_time","nextStep":"ask_time","language":"en","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.661Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+123456789012","model":"gemini-2.0-flash-exp","promptLength":49,"promptPreview":"Analiza la intención del cliente en en: \"At 6:30\"..."}}
{"timestamp":"2025-10-24T14:22:58.661Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+123456789012","responseLength":236,"processingTime":1141.1945087031186,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":6,\"time\":\"06:30\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\":...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":6,\"time\":\"06:30\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.661Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+123456789012","step":"ask_name","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":6,"time":"06:30"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.661Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+123456789012","step":"ask_name","extractedData":{"people":6,"time":"06:30"},"hasPeople":true,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.661Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_name → ask_name","data":{"phoneNumber":"+123456789012","fromStep":"ask_name","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.661Z"}}
{"timestamp":"2025-10-24T14:22:58.662Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+123456789012","method":"intelligent","language":"en","responseLength":17,"responsePreview":"What's your name?...","fullResponse":"What's your name?"}}
{"timestamp":"2025-10-24T14:22:58.662Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+123456789012","historyLength":5,"lastMessages":[{"role":"user","message":"For 4 people","timestamp":"2025-10-24T14:22:58.662Z"},{"role":"bot","message":"This weekend","timestamp":"2025-10-24T14:22:58.662Z"},{"role":"user","message":"At 6:30","timestamp":"2025-10-24T14:22:58.662Z"}],"fullHistory":[{"role":"user","message":"Hello","timestamp":"2025-10-24T14:22:58.662Z"},{"role":"bot","message":"I don't understand what you need","timestamp":"2025-10-24T14:22:58.662Z"},{"role":"user","message":"For 4 people","timestamp":"2025-10-24T14:22:58.662Z"},{"role":"bot","message":"This weekend","timestamp":"2025-10-24T14:22:58.662Z"},{"role":"user","message":"At 6:30","timestamp":"2025-10-24T14:22:58.662Z"}]}}
{"timestamp":"2025-10-24T14:22:58.662Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+123456789012","state":{"step":"ask_name","language":"en","data":{"people":6},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.662Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+123456789012","metrics":{"totalTime":1755.778679340232,"geminiTime":1283.7940094224223,"processingTime":1478.3962130047203,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_name","nextStep":"ask_name","language":"en","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.663Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+123456789012","model":"gemini-2.0-flash-exp","promptLength":53,"promptPreview":"Analiza la intención del cliente en en: \"Mike Wilson\"..."}}
{"timestamp":"2025-10-24T14:22:58.663Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+123456789012","responseLength":211,"processingTime":1011.3588050536991,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"complete\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_ques...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"complete\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.663Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+123456789012","step":"ask_phone","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.663Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+123456789012","step":"ask_phone","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.663Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_phone → complete","data":{"phoneNumber":"+123456789012","fromStep":"ask_phone","toStep":"complete","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.663Z"}}
{"timestamp":"2025-10-24T14:22:58.664Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+123456789012","method":"intelligent","language":"en","responseLength":46,"responsePreview":"Perfect! Your reservation is confirmed. Enjoy!...","fullResponse":"Perfect! Your reservation is confirmed. Enjoy!"}}
{"timestamp":"2025-10-24T14:22:58.664Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+123456789012","historyLength":6,"lastMessages":[{"role":"bot","message":"This weekend","timestamp":"2025-10-24T14:22:58.664Z"},{"role":"user","message":"At 6:30","timestamp":"2025-10-24T14:22:58.664Z"},{"role":"bot","message":"Mike Wilson","timestamp":"2025-10-24T14:22:58.664Z"}],"fullHistory":[{"role":"user","message":"Hello","timestamp":"2025-10-24T14:22:58.664Z"},{"role":"bot","message":"I don't understand what you need","timestamp":"2025-10-24T14:22:58.664Z"},{"role":"user","message":"For 4 people","timestamp":"2025-10-24T14:22:58.664Z"},{"role":"bot","message":"This weekend","timestamp":"2025-10-24T14:22:58.664Z"},{"role":"user","message":"At 6:30","timestamp":"2025-10-24T14:22:58.664Z"},{"role":"bot","message":"Mike Wilson","timestamp":"2025-10-24T14:22:58.664Z"}]}}
{"timestamp":"2025-10-24T14:22:58.664Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+123456789012","state":{"step":"complete","language":"en","data":{"people":6},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.664Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+123456789012","metrics":{"totalTime":2798.3772631109105,"geminiTime":1559.9891510988905,"processingTime":1491.0738713954229,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_phone","nextStep":"complete","language":"en","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.665Z","level":"INFO","category":"CALL_START","message":"Llamada iniciada desde +49300000001","data":{"phoneNumber":"+49300000001","userInput":"Hallo, ich möchte eine Reservierung","timestamp":"2025-10-24T14:22:58.665Z"}}
{"timestamp":"2025-10-24T14:22:58.665Z","level":"INFO","category":"LANGUAGE_DETECTION","message":"Idioma detectado: de (0.7)","data":{"phoneNumber":"+49300000001","detectedLang":"de","confidence":0.7,"method":"gemini"}}
{"timestamp":"2025-10-24T14:22:58.665Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+49300000001","model":"gemini-2.0-flash-exp","promptLength":77,"promptPreview":"Analiza la intención del cliente en de: \"Hallo, ich möchte eine Reservierung\"..."}}
{"timestamp":"2025-10-24T14:22:58.665Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+49300000001","responseLength":211,"processingTime":1162.617987281655,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"greeting\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_ques...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"greeting\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.665Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+49300000001","step":"greeting","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.666Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+49300000001","step":"greeting","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.666Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → greeting","data":{"phoneNumber":"+49300000001","fromStep":"greeting","toStep":"greeting","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.666Z"}}
{"timestamp":"2025-10-24T14:22:58.666Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+49300000001","method":"intelligent","language":"de","responseLength":83,"responsePreview":"Hallo! Willkommen im Restaurant. Für wie viele Personen soll die Reservierung sein?...","fullResponse":"Hallo! Willkommen im Restaurant. Für wie viele Personen soll die Reservierung sein?"}}
{"timestamp":"2025-10-24T14:22:58.666Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+49300000001","historyLength":1,"lastMessages":[{"role":"user","message":"Hallo, ich möchte eine Reservierung","timestamp":"2025-10-24T14:22:58.666Z"}],"fullHistory":[{"role":"user","message":"Hallo, ich möchte eine Reservierung","timestamp":"2025-10-24T14:22:58.666Z"}]}}
{"timestamp":"2025-10-24T14:22:58.666Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+49300000001","state":{"step":"greeting","language":"de","data":{},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.666Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+49300000001","metrics":{"totalTime":2820.0664371403363,"geminiTime":909.8478623857831,"processingTime":1085.760114784637,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"greeting","nextStep":"greeting","language":"de","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.667Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+49300000001","model":"gemini-2.0-flash-exp","promptLength":56,"promptPreview":"Analiza la intención del cliente en de: \"Für 4 Personen\"..."}}
{"timestamp":"2025-10-24T14:22:58.667Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+49300000001","responseLength":238,"processingTime":1678.2488743633808,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":4,\"time\":\"04:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_people\",\"response_type\":\"question\",\"needs_clarification...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":4,\"time\":\"04:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_people\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.667Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+49300000001","step":"ask_people","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":4,"time":"04:00"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.667Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+49300000001","step":"ask_people","extractedData":{"people":4,"time":"04:00"},"hasPeople":true,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.668Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_people → ask_people","data":{"phoneNumber":"+49300000001","fromStep":"ask_people","toStep":"ask_people","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.668Z"}}
{"timestamp":"2025-10-24T14:22:58.668Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+49300000001","method":"intelligent","language":"de","responseLength":50,"responsePreview":"Für wie viele Personen soll die Reservierung sein?...","fullResponse":"Für wie viele Personen soll die Reservierung sein?"}}
{"timestamp":"2025-10-24T14:22:58.668Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+49300000001","historyLength":2,"lastMessages":[{"role":"user","message":"Hallo, ich möchte eine Reservierung","timestamp":"2025-10-24T14:22:58.668Z"},{"role":"bot","message":"Für 4 Personen","timestamp":"2025-10-24T14:22:58.668Z"}],"fullHistory":[{"role":"user","message":"Hallo, ich möchte eine Reservierung","timestamp":"2025-10-24T14:22:58.668Z"},{"role":"bot","message":"Für 4 Personen","timestamp":"2025-10-24T14:22:58.668Z"}]}}
{"timestamp":"2025-10-24T14:22:58.668Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+49300000001","state":{"step":"ask_people","language":"de","data":{"people":4},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.668Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+49300000001","metrics":{"totalTime":1506.5249826231116,"geminiTime":954.0828381849731,"processingTime":1332.7534917759717,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_people","nextStep":"ask_people","language":"de","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.668Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+49300000001","model":"gemini-2.0-flash-exp","promptLength":52,"promptPreview":"Analiza la intención del cliente en de: \"Für morgen\"..."}}
{"timestamp":"2025-10-24T14:22:58.669Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+49300000001","responseLength":230,"processingTime":1329.2225172776116,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"date\":\"2025-10-25\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_date\",\"response_type\":\"question\",\"needs_clarification\":false,...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"date\":\"2025-10-25\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_date\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.669Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+49300000001","step":"ask_date","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"date":"2025-10-25"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.669Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+49300000001","step":"ask_date","extractedData":{"date":"2025-10-25"},"hasPeople":false,"hasDate":true,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.669Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_date → ask_date","data":{"phoneNumber":"+49300000001","fromStep":"ask_date","toStep":"ask_date","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.669Z"}}
{"timestamp":"2025-10-24T14:22:58.669Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+49300000001","method":"intelligent","language":"de","responseLength":49,"responsePreview":"Für welches Datum benötigen Sie die Reservierung?...","fullResponse":"Für welches Datum benötigen Sie die Reservierung?"}}
{"timestamp":"2025-10-24T14:22:58.669Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+49300000001","historyLength":3,"lastMessages":[{"role":"user","message":"Hallo, ich möchte eine Reservierung","timestamp":"2025-10-24T14:22:58.669Z"},{"role":"bot","message":"Für 4 Personen","timestamp":"2025-10-24T14:22:58.669Z"},{"role":"user","message":"Für morgen","timestamp":"2025-10-24T14:22:58.669Z"}],"fullHistory":[{"role":"user","message":"Hallo, ich möchte eine Reservierung","timestamp":"2025-10-24T14:22:58.669Z"},{"role":"bot","message":"Für 4 Personen","timestamp":"2025-10-24T14:22:58.669Z"},{"role":"user","message":"Für morgen","timestamp":"2025-10-24T14:22:58.669Z"}]}}
{"timestamp":"2025-10-24T14:22:58.670Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+49300000001","state":{"step":"ask_date","language":"de","data":{"people":4},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.670Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+49300000001","metrics":{"totalTime":1664.21109584527,"geminiTime":862.6847457379847,"processingTime":1410.198794246801,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_date","nextStep":"ask_date","language":"de","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.670Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+49300000001","model":"gemini-2.0-flash-exp","promptLength":51,"promptPreview":"Analiza la intención del cliente en de: \"Um 19 Uhr\"..."}}
{"timestamp":"2025-10-24T14:22:58.670Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+49300000001","responseLength":237,"processingTime":1594.1994769278595,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":19,\"time\":\"19:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_time\",\"response_type\":\"question\",\"needs_clarification\"...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":19,\"time\":\"19:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_time\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.670Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+49300000001","step":"ask_time","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":19,"time":"19:00"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.670Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+49300000001","step":"ask_time","extractedData":{"people":19,"time":"19:00"},"hasPeople":true,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.671Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_time → ask_time","data":{"phoneNumber":"+49300000001","fromStep":"ask_time","toStep":"ask_time","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.671Z"}}
{"timestamp":"2025-10-24T14:22:58.671Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+49300000001","method":"intelligent","language":"de","responseLength":37,"responsePreview":"Um welche Uhrzeit möchten Sie kommen?...","fullResponse":"Um welche Uhrzeit möchten Sie kommen?"}}
{"timestamp":"2025-10-24T14:22:58.671Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+49300000001","historyLength":4,"lastMessages":[{"role":"bot","message":"Für 4 Personen","timestamp":"2025-10-24T14:22:58.671Z"},{"role":"user","message":"Für morgen","timestamp":"2025-10-24T14:22:58.671Z"},{"role":"bot","message":"Um 19 Uhr","timestamp":"2025-10-24T14:22:58.671Z"}],"fullHistory":[{"role":"user","message":"Hallo, ich möchte eine Reservierung","timestamp":"2025-10-24T14:22:58.671Z"},{"role":"bot","message":"Für 4 Personen","timestamp":"2025-10-24T14:22:58.671Z"},{"role":"user","message":"Für morgen","timestamp":"2025-10-24T14:22:58.671Z"},{"role":"bot","message":"Um 19 Uhr","timestamp":"2025-10-24T14:22:58.671Z"}]}}
{"timestamp":"2025-10-24T14:22:58.671Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+49300000001","state":{"step":"ask_time","language":"de","data":{"people":19},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.671Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+49300000001","metrics":{"totalTime":2695.2183186588854,"geminiTime":1755.8206680756166,"processingTime":2965.3319937775896,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_time","nextStep":"ask_time","language":"de","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.671Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+49300000001","model":"gemini-2.0-flash-exp","promptLength":63,"promptPreview":"Analiza la intención del cliente en de: \"Ich heiße Hans Müller\"..."}}
{"timestamp":"2025-10-24T14:22:58.671Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+49300000001","responseLength":224,"processingTime":1769.234015389632,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"name\":\"Hans\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\":false,\"clari...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"name\":\"Hans\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.672Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+49300000001","step":"ask_name","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"name":"Hans"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.672Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+49300000001","step":"ask_name","extractedData":{"name":"Hans"},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":true,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.672Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_name → ask_name","data":{"phoneNumber":"+49300000001","fromStep":"ask_name","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.672Z"}}
{"timestamp":"2025-10-24T14:22:58.672Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+49300000001","method":"intelligent","language":"de","responseLength":15,"responsePreview":"Wie heißen Sie?...","fullResponse":"Wie heißen Sie?"}}
{"timestamp":"2025-10-24T14:22:58.672Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+49300000001","historyLength":5,"lastMessages":[{"role":"user","message":"Für morgen","timestamp":"2025-10-24T14:22:58.672Z"},{"role":"bot","message":"Um 19 Uhr","timestamp":"2025-10-24T14:22:58.672Z"},{"role":"user","message":"Ich heiße Hans Müller","timestamp":"2025-10-24T14:22:58.672Z"}],"fullHistory":[{"role":"user","message":"Hallo, ich möchte eine Reservierung","timestamp":"2025-10-24T14:22:58.672Z"},{"role":"bot","message":"Für 4 Personen","timestamp":"2025-10-24T14:22:58.672Z"},{"role":"user","message":"Für morgen","timestamp":"2025-10-24T14:22:58.672Z"},{"role":"bot","message":"Um 19 Uhr","timestamp":"2025-10-24T14:22:58.672Z"},{"role":"user","message":"Ich heiße Hans Müller","timestamp":"2025-10-24T14:22:58.672Z"}]}}
{"timestamp":"2025-10-24T14:22:58.672Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+49300000001","state":{"step":"ask_name","language":"de","data":{"people":19},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.673Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+49300000001","metrics":{"totalTime":2065.401379901615,"geminiTime":1782.3249034693044,"processingTime":2995.890986522982,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_name","nextStep":"ask_name","language":"de","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.673Z","level":"INFO","category":"CALL_START","message":"Llamada iniciada desde +493000000011","data":{"phoneNumber":"+493000000011","userInput":"Guten Tag","timestamp":"2025-10-24T14:22:58.673Z"}}
{"timestamp":"2025-10-24T14:22:58.673Z","level":"INFO","category":"LANGUAGE_DETECTION","message":"Idioma detectado: de (0.7)","data":{"phoneNumber":"+493000000011","detectedLang":"de","confidence":0.7,"method":"gemini"}}
{"timestamp":"2025-10-24T14:22:58.673Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+493000000011","model":"gemini-2.0-flash-exp","promptLength":51,"promptPreview":"Analiza la intención del cliente en de: \"Guten Tag\"..."}}
{"timestamp":"2025-10-24T14:22:58.673Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+493000000011","responseLength":211,"processingTime":860.529978647928,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"greeting\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_ques...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"greeting\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.673Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+493000000011","step":"greeting","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.674Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+493000000011","step":"greeting","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.674Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → greeting","data":{"phoneNumber":"+493000000011","fromStep":"greeting","toStep":"greeting","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.674Z"}}
{"timestamp":"2025-10-24T14:22:58.674Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+493000000011","method":"intelligent","language":"de","responseLength":83,"responsePreview":"Hallo! Willkommen im Restaurant. Für wie viele Personen soll die Reservierung sein?...","fullResponse":"Hallo! Willkommen im Restaurant. Für wie viele Personen soll die Reservierung sein?"}}
{"timestamp":"2025-10-24T14:22:58.674Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+493000000011","historyLength":1,"lastMessages":[{"role":"user","message":"Guten Tag","timestamp":"2025-10-24T14:22:58.674Z"}],"fullHistory":[{"role":"user","message":"Guten Tag","timestamp":"2025-10-24T14:22:58.674Z"}]}}
{"timestamp":"2025-10-24T14:22:58.674Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+493000000011","state":{"step":"greeting","language":"de","data":{},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.674Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+493000000011","metrics":{"totalTime":1646.078541987215,"geminiTime":1517.572082995872,"processingTime":1605.4753442303354,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"greeting","nextStep":"greeting","language":"de","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.674Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+493000000011","model":"gemini-2.0-flash-exp","promptLength":78,"promptPreview":"Analiza la intención del cliente en de: \"Ich verstehe nicht, was Sie brauchen\"..."}}
{"timestamp":"2025-10-24T14:22:58.675Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+493000000011","responseLength":215,"processingTime":1150.2822384946278,"responsePreview":"{\"intent\":\"clarification\",\"confidence\":0.7,\"extracted_data\":{},\"sentiment\":\"confused\",\"urgency\":\"normal\",\"next_step\":\"ask_people\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_...","fullResponse":"{\"intent\":\"clarification\",\"confidence\":0.7,\"extracted_data\":{},\"sentiment\":\"confused\",\"urgency\":\"normal\",\"next_step\":\"ask_people\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.675Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+493000000011","step":"ask_people","analysis":{"intent":"clarification","confidence":0.7,"sentiment":"confused","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.675Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+493000000011","step":"ask_people","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.675Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_people → ask_people","data":{"phoneNumber":"+493000000011","fromStep":"ask_people","toStep":"ask_people","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.675Z"}}
{"timestamp":"2025-10-24T14:22:58.675Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+493000000011","method":"intelligent","language":"de","responseLength":50,"responsePreview":"Für wie viele Personen soll die Reservierung sein?...","fullResponse":"Für wie viele Personen soll die Reservierung sein?"}}
{"timestamp":"2025-10-24T14:22:58.675Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+493000000011","historyLength":2,"lastMessages":[{"role":"user","message":"Guten Tag","timestamp":"2025-10-24T14:22:58.675Z"},{"role":"bot","message":"Ich verstehe nicht, was Sie brauchen","timestamp":"2025-10-24T14:22:58.675Z"}],"fullHistory":[{"role":"user","message":"Guten Tag","timestamp":"2025-10-24T14:22:58.675Z"},{"role":"bot","message":"Ich verstehe nicht, was Sie brauchen","timestamp":"2025-10-24T14:22:58.675Z"}]}}
{"timestamp":"2025-10-24T14:22:58.675Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+493000000011","state":{"step":"ask_people","language":"de","data":{},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.676Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+493000000011","metrics":{"totalTime":2302.2304852106527,"geminiTime":1737.9106830346045,"processingTime":1317.3624260049417,"intent":"clarification","confidence":0.7,"sentiment":"confused","urgency":"normal","step":"ask_people","nextStep":"ask_people","language":"de","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.676Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+493000000011","model":"gemini-2.0-flash-exp","promptLength":56,"promptPreview":"Analiza la intención del cliente en de: \"Für 2 Personen\"..."}}
{"timestamp":"2025-10-24T14:22:58.676Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+493000000011","responseLength":236,"processingTime":1645.6299444242768,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":2,\"time\":\"02:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\":...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":2,\"time\":\"02:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.676Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+493000000011","step":"ask_date","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":2,"time":"02:00"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.676Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+493000000011","step":"ask_date","extractedData":{"people":2,"time":"02:00"},"hasPeople":true,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.676Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_date → ask_name","data":{"phoneNumber":"+493000000011","fromStep":"ask_date","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.676Z"}}
{"timestamp":"2025-10-24T14:22:58.676Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+493000000011","method":"intelligent","language":"de","responseLength":15,"responsePreview":"Wie heißen Sie?...","fullResponse":"Wie heißen Sie?"}}
{"timestamp":"2025-10-24T14:22:58.677Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+493000000011","historyLength":3,"lastMessages":[{"role":"user","message":"Guten Tag","timestamp":"2025-10-24T14:22:58.677Z"},{"role":"bot","message":"Ich verstehe nicht, was Sie brauchen","timestamp":"2025-10-24T14:22:58.677Z"},{"role":"user","message":"Für 2 Personen","timestamp":"2025-10-24T14:22:58.677Z"}],"fullHistory":[{"role":"user","message":"Guten Tag","timestamp":"2025-10-24T14:22:58.677Z"},{"role":"bot","message":"Ich verstehe nicht, was Sie brauchen","timestamp":"2025-10-24T14:22:58.677Z"},{"role":"user","message":"Für 2 Personen","timestamp":"2025-10-24T14:22:58.677Z"}]}}
{"timestamp":"2025-10-24T14:22:58.677Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+493000000011","state":{"step":"ask_name","language":"de","data":{"people":2},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.677Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+493000000011","metrics":{"totalTime":2862.972940331949,"geminiTime":1342.2336742069106,"processingTime":1718.9953855197296,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_date","nextStep":"ask_name","language":"de","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.677Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+493000000011","model":"gemini-2.0-flash-exp","promptLength":52,"promptPreview":"Analiza la intención del cliente en de: \"Am Freitag\"..."}}
{"timestamp":"2025-10-24T14:22:58.677Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+493000000011","responseLength":211,"processingTime":1394.4733064199995,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_time\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_ques...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_time\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.677Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+493000000011","step":"ask_time","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.677Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+493000000011","step":"ask_time","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.678Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_time → ask_time","data":{"phoneNumber":"+493000000011","fromStep":"ask_time","toStep":"ask_time","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.678Z"}}
{"timestamp":"2025-10-24T14:22:58.678Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+493000000011","method":"intelligent","language":"de","responseLength":37,"responsePreview":"Um welche Uhrzeit möchten Sie kommen?...","fullResponse":"Um welche Uhrzeit möchten Sie kommen?"}}
{"timestamp":"2025-10-24T14:22:58.678Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+493000000011","historyLength":4,"lastMessages":[{"role":"bot","message":"Ich verstehe nicht, was Sie brauchen","timestamp":"2025-10-24T14:22:58.678Z"},{"role":"user","message":"Für 2 Personen","timestamp":"2025-10-24T14:22:58.678Z"},{"role":"bot","message":"Am Freitag","timestamp":"2025-10-24T14:22:58.678Z"}],"fullHistory":[{"role":"user","message":"Guten Tag","timestamp":"2025-10-24T14:22:58.678Z"},{"role":"bot","message":"Ich verstehe nicht, was Sie brauchen","timestamp":"2025-10-24T14:22:58.678Z"},{"role":"user","message":"Für 2 Personen","timestamp":"2025-10-24T14:22:58.678Z"},{"role":"bot","message":"Am Freitag","timestamp":"2025-10-24T14:22:58.678Z"}]}}
{"timestamp":"2025-10-24T14:22:58.678Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+493000000011","state":{"step":"ask_time","language":"de","data":{"people":2},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.678Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+493000000011","metrics":{"totalTime":2095.149361121641,"geminiTime":1104.952544196405,"processingTime":1736.191894886079,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_time","nextStep":"ask_time","language":"de","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.678Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+493000000011","model":"gemini-2.0-flash-exp","promptLength":50,"promptPreview":"Analiza la intención del cliente en de: \"Um 18:30\"..."}}
{"timestamp":"2025-10-24T14:22:58.679Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+493000000011","responseLength":237,"processingTime":1719.0674628364393,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":18,\"time\":\"18:30\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\"...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":18,\"time\":\"18:30\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.679Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+493000000011","step":"ask_name","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":18,"time":"18:30"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.679Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+493000000011","step":"ask_name","extractedData":{"people":18,"time":"18:30"},"hasPeople":true,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.679Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_name → ask_name","data":{"phoneNumber":"+493000000011","fromStep":"ask_name","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.679Z"}}
{"timestamp":"2025-10-24T14:22:58.679Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+493000000011","method":"intelligent","language":"de","responseLength":15,"responsePreview":"Wie heißen Sie?...","fullResponse":"Wie heißen Sie?"}}
{"timestamp":"2025-10-24T14:22:58.679Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+493000000011","historyLength":5,"lastMessages":[{"role":"user","message":"Für 2 Personen","timestamp":"2025-10-24T14:22:58.679Z"},{"role":"bot","message":"Am Freitag","timestamp":"2025-10-24T14:22:58.679Z"},{"role":"user","message":"Um 18:30","timestamp":"2025-10-24T14:22:58.679Z"}],"fullHistory":[{"role":"user","message":"Guten Tag","timestamp":"2025-10-24T14:22:58.679Z"},{"role":"bot","message":"Ich verstehe nicht, was Sie brauchen","timestamp":"2025-10-24T14:22:58.679Z"},{"role":"user","message":"Für 2 Personen","timestamp":"2025-10-24T14:22:58.679Z"},{"role":"bot","message":"Am Freitag","timestamp":"2025-10-24T14:22:58.679Z"},{"role":"user","message":"Um 18:30","timestamp":"2025-10-24T14:22:58.679Z"}]}}
{"timestamp":"2025-10-24T14:22:58.680Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+493000000011","state":{"step":"ask_name","language":"de","data":{"people":18},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.680Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+493000000011","metrics":{"totalTime":2719.4791230925803,"geminiTime":1174.2839584864178,"processingTime":1135.6338435826433,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_name","nextStep":"ask_name","language":"de","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.680Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+493000000011","model":"gemini-2.0-flash-exp","promptLength":54,"promptPreview":"Analiza la intención del cliente en de: \"Anna Schmidt\"..."}}
{"timestamp":"2025-10-24T14:22:58.680Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+493000000011","responseLength":211,"processingTime":1250.5992612638909,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"complete\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_ques...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"complete\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.680Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+493000000011","step":"ask_phone","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.680Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+493000000011","step":"ask_phone","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.680Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_phone → complete","data":{"phoneNumber":"+493000000011","fromStep":"ask_phone","toStep":"complete","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.680Z"}}
{"timestamp":"2025-10-24T14:22:58.681Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+493000000011","method":"intelligent","language":"de","responseLength":52,"responsePreview":"Perfekt! Ihre Reservierung ist bestätigt. Viel Spaß!...","fullResponse":"Perfekt! Ihre Reservierung ist bestätigt. Viel Spaß!"}}
{"timestamp":"2025-10-24T14:22:58.681Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+493000000011","historyLength":6,"lastMessages":[{"role":"bot","message":"Am Freitag","timestamp":"2025-10-24T14:22:58.681Z"},{"role":"user","message":"Um 18:30","timestamp":"2025-10-24T14:22:58.681Z"},{"role":"bot","message":"Anna Schmidt","timestamp":"2025-10-24T14:22:58.681Z"}],"fullHistory":[{"role":"user","message":"Guten Tag","timestamp":"2025-10-24T14:22:58.681Z"},{"role":"bot","message":"Ich verstehe nicht, was Sie brauchen","timestamp":"2025-10-24T14:22:58.681Z"},{"role":"user","message":"Für 2 Personen","timestamp":"2025-10-24T14:22:58.681Z"},{"role":"bot","message":"Am Freitag","timestamp":"2025-10-24T14:22:58.681Z"},{"role":"user","message":"Um 18:30","timestamp":"2025-10-24T14:22:58.681Z"},{"role":"bot","message":"Anna Schmidt","timestamp":"2025-10-24T14:22:58.681Z"}]}}
{"timestamp":"2025-10-24T14:22:58.681Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+493000000011","state":{"step":"complete","language":"de","data":{"people":18},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.681Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+493000000011","metrics":{"totalTime":1725.527730650867,"geminiTime":1726.3075304443532,"processingTime":2459.934721828502,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_phone","nextStep":"complete","language":"de","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.681Z","level":"INFO","category":"CALL_START","message":"Llamada iniciada desde +493000000012","data":{"phoneNumber":"+493000000012","userInput":"Ich bin frustriert mit diesem System","timestamp":"2025-10-24T14:22:58.681Z"}}
{"timestamp":"2025-10-24T14:22:58.682Z","level":"INFO","category":"LANGUAGE_DETECTION","message":"Idioma detectado: de (0.7)","data":{"phoneNumber":"+493000000012","detectedLang":"de","confidence":0.7,"method":"gemini"}}
{"timestamp":"2025-10-24T14:22:58.682Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+493000000012","model":"gemini-2.0-flash-exp","promptLength":78,"promptPreview":"Analiza la intención del cliente en de: \"Ich bin frustriert mit diesem System\"..."}}
{"timestamp":"2025-10-24T14:22:58.682Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+493000000012","responseLength":211,"processingTime":1482.0323847189443,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.9,\"extracted_data\":{},\"sentiment\":\"frustrated\",\"urgency\":\"high\",\"next_step\":\"greeting\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_ques...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.9,\"extracted_data\":{},\"sentiment\":\"frustrated\",\"urgency\":\"high\",\"next_step\":\"greeting\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.682Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+493000000012","step":"greeting","analysis":{"intent":"reservation","confidence":0.9,"sentiment":"frustrated","urgency":"high","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.682Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+493000000012","step":"greeting","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.682Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → greeting","data":{"phoneNumber":"+493000000012","fromStep":"greeting","toStep":"greeting","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.682Z"}}
{"timestamp":"2025-10-24T14:22:58.683Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+493000000012","method":"intelligent","language":"de","responseLength":83,"responsePreview":"Hallo! Willkommen im Restaurant. Für wie viele Personen soll die Reservierung sein?...","fullResponse":"Hallo! Willkommen im Restaurant. Für wie viele Personen soll die Reservierung sein?"}}
{"timestamp":"2025-10-24T14:22:58.683Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+493000000012","historyLength":1,"lastMessages":[{"role":"user","message":"Ich bin frustriert mit diesem System","timestamp":"2025-10-24T14:22:58.683Z"}],"fullHistory":[{"role":"user","message":"Ich bin frustriert mit diesem System","timestamp":"2025-10-24T14:22:58.683Z"}]}}
{"timestamp":"2025-10-24T14:22:58.683Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+493000000012","state":{"step":"greeting","language":"de","data":{},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.683Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+493000000012","metrics":{"totalTime":1123.1155139765115,"geminiTime":1650.9276474608723,"processingTime":2852.391297983906,"intent":"reservation","confidence":0.9,"sentiment":"frustrated","urgency":"high","step":"greeting","nextStep":"greeting","language":"de","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.683Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+493000000012","model":"gemini-2.0-flash-exp","promptLength":81,"promptPreview":"Analiza la intención del cliente en de: \"Ich will nur für 3 Personen reservieren\"..."}}
{"timestamp":"2025-10-24T14:22:58.683Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+493000000012","responseLength":238,"processingTime":1169.1566679626262,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":3,\"time\":\"03:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_people\",\"response_type\":\"question\",\"needs_clarification...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":3,\"time\":\"03:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_people\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.683Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+493000000012","step":"ask_people","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":3,"time":"03:00"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.684Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+493000000012","step":"ask_people","extractedData":{"people":3,"time":"03:00"},"hasPeople":true,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.684Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_people → ask_people","data":{"phoneNumber":"+493000000012","fromStep":"ask_people","toStep":"ask_people","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.684Z"}}
{"timestamp":"2025-10-24T14:22:58.684Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+493000000012","method":"intelligent","language":"de","responseLength":50,"responsePreview":"Für wie viele Personen soll die Reservierung sein?...","fullResponse":"Für wie viele Personen soll die Reservierung sein?"}}
{"timestamp":"2025-10-24T14:22:58.684Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+493000000012","historyLength":2,"lastMessages":[{"role":"user","message":"Ich bin frustriert mit diesem System","timestamp":"2025-10-24T14:22:58.684Z"},{"role":"bot","message":"Ich will nur für 3 Personen reservieren","timestamp":"2025-10-24T14:22:58.684Z"}],"fullHistory":[{"role":"user","message":"Ich bin frustriert mit diesem System","timestamp":"2025-10-24T14:22:58.684Z"},{"role":"bot","message":"Ich will nur für 3 Personen reservieren","timestamp":"2025-10-24T14:22:58.684Z"}]}}
{"timestamp":"2025-10-24T14:22:58.684Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+493000000012","state":{"step":"ask_people","language":"de","data":{"people":3},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.684Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+493000000012","metrics":{"totalTime":1861.3555586359535,"geminiTime":1382.1518477861516,"processingTime":1505.0432047655363,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_people","nextStep":"ask_people","language":"de","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.684Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+493000000012","model":"gemini-2.0-flash-exp","promptLength":53,"promptPreview":"Analiza la intención del cliente en de: \"Für Samstag\"..."}}
{"timestamp":"2025-10-24T14:22:58.685Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+493000000012","responseLength":211,"processingTime":1072.7736006873693,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_date\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_ques...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_date\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.685Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+493000000012","step":"ask_date","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.685Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+493000000012","step":"ask_date","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.685Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_date → ask_date","data":{"phoneNumber":"+493000000012","fromStep":"ask_date","toStep":"ask_date","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.685Z"}}
{"timestamp":"2025-10-24T14:22:58.685Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+493000000012","method":"intelligent","language":"de","responseLength":49,"responsePreview":"Für welches Datum benötigen Sie die Reservierung?...","fullResponse":"Für welches Datum benötigen Sie die Reservierung?"}}
{"timestamp":"2025-10-24T14:22:58.685Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+493000000012","historyLength":3,"lastMessages":[{"role":"user","message":"Ich bin frustriert mit diesem System","timestamp":"2025-10-24T14:22:58.685Z"},{"role":"bot","message":"Ich will nur für 3 Personen reservieren","timestamp":"2025-10-24T14:22:58.685Z"},{"role":"user","message":"Für Samstag","timestamp":"2025-10-24T14:22:58.685Z"}],"fullHistory":[{"role":"user","message":"Ich bin frustriert mit diesem System","timestamp":"2025-10-24T14:22:58.685Z"},{"role":"bot","message":"Ich will nur für 3 Personen reservieren","timestamp":"2025-10-24T14:22:58.685Z"},{"role":"user","message":"Für Samstag","timestamp":"2025-10-24T14:22:58.685Z"}]}}
{"timestamp":"2025-10-24T14:22:58.685Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+493000000012","state":{"step":"ask_date","language":"de","data":{"people":3},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.686Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+493000000012","metrics":{"totalTime":2746.22829277406,"geminiTime":1390.1712240978313,"processingTime":2597.0591353155587,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_date","nextStep":"ask_date","language":"de","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.686Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+493000000012","model":"gemini-2.0-flash-exp","promptLength":51,"promptPreview":"Analiza la intención del cliente en de: \"Um 20 Uhr\"..."}}
{"timestamp":"2025-10-24T14:22:58.686Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+493000000012","responseLength":237,"processingTime":1625.7102472800216,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":20,\"time\":\"20:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_time\",\"response_type\":\"question\",\"needs_clarification\"...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":20,\"time\":\"20:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_time\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.686Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+493000000012","step":"ask_time","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":20,"time":"20:00"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.686Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+493000000012","step":"ask_time","extractedData":{"people":20,"time":"20:00"},"hasPeople":true,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.686Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_time → ask_time","data":{"phoneNumber":"+493000000012","fromStep":"ask_time","toStep":"ask_time","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.686Z"}}
{"timestamp":"2025-10-24T14:22:58.687Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+493000000012","method":"intelligent","language":"de","responseLength":37,"responsePreview":"Um welche Uhrzeit möchten Sie kommen?...","fullResponse":"Um welche Uhrzeit möchten Sie kommen?"}}
{"timestamp":"2025-10-24T14:22:58.687Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+493000000012","historyLength":4,"lastMessages":[{"role":"bot","message":"Ich will nur für 3 Personen reservieren","timestamp":"2025-10-24T14:22:58.687Z"},{"role":"user","message":"Für Samstag","timestamp":"2025-10-24T14:22:58.687Z"},{"role":"bot","message":"Um 20 Uhr","timestamp":"2025-10-24T14:22:58.687Z"}],"fullHistory":[{"role":"user","message":"Ich bin frustriert mit diesem System","timestamp":"2025-10-24T14:22:58.687Z"},{"role":"bot","message":"Ich will nur für 3 Personen reservieren","timestamp":"2025-10-24T14:22:58.687Z"},{"role":"user","message":"Für Samstag","timestamp":"2025-10-24T14:22:58.687Z"},{"role":"bot","message":"Um 20 Uhr","timestamp":"2025-10-24T14:22:58.687Z"}]}}
{"timestamp":"2025-10-24T14:22:58.687Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+493000000012","state":{"step":"ask_time","language":"de","data":{"people":20},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.687Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+493000000012","metrics":{"totalTime":1821.4002133275344,"geminiTime":1322.818237348787,"processingTime":2569.74724317027,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_time","nextStep":"ask_time","language":"de","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.687Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+493000000012","model":"gemini-2.0-flash-exp","promptLength":53,"promptPreview":"Analiza la intención del cliente en de: \"Peter Weber\"..."}}
{"timestamp":"2025-10-24T14:22:58.687Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+493000000012","responseLength":211,"processingTime":1502.7268240516958,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_ques...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.688Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+493000000012","step":"ask_name","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.688Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+493000000012","step":"ask_name","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.688Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_name → ask_name","data":{"phoneNumber":"+493000000012","fromStep":"ask_name","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.688Z"}}
{"timestamp":"2025-10-24T14:22:58.688Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+493000000012","method":"intelligent","language":"de","responseLength":15,"responsePreview":"Wie heißen Sie?...","fullResponse":"Wie heißen Sie?"}}
{"timestamp":"2025-10-24T14:22:58.688Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+493000000012","historyLength":5,"lastMessages":[{"role":"user","message":"Für Samstag","timestamp":"2025-10-24T14:22:58.688Z"},{"role":"bot","message":"Um 20 Uhr","timestamp":"2025-10-24T14:22:58.688Z"},{"role":"user","message":"Peter Weber","timestamp":"2025-10-24T14:22:58.688Z"}],"fullHistory":[{"role":"user","message":"Ich bin frustriert mit diesem System","timestamp":"2025-10-24T14:22:58.688Z"},{"role":"bot","message":"Ich will nur für 3 Personen reservieren","timestamp":"2025-10-24T14:22:58.688Z"},{"role":"user","message":"Für Samstag","timestamp":"2025-10-24T14:22:58.688Z"},{"role":"bot","message":"Um 20 Uhr","timestamp":"2025-10-24T14:22:58.688Z"},{"role":"user","message":"Peter Weber","timestamp":"2025-10-24T14:22:58.688Z"}]}}
{"timestamp":"2025-10-24T14:22:58.688Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+493000000012","state":{"step":"ask_name","language":"de","data":{"people":20},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.689Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+493000000012","metrics":{"totalTime":1981.2513430282936,"geminiTime":1172.5109776146767,"processingTime":1110.62483203433,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_name","nextStep":"ask_name","language":"de","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.689Z","level":"INFO","category":"CALL_START","message":"Llamada iniciada desde +39300000001","data":{"phoneNumber":"+39300000001","userInput":"Ciao, vorrei fare una prenotazione","timestamp":"2025-10-24T14:22:58.689Z"}}
{"timestamp":"2025-10-24T14:22:58.689Z","level":"INFO","category":"LANGUAGE_DETECTION","message":"Idioma detectado: it (0.6)","data":{"phoneNumber":"+39300000001","detectedLang":"it","confidence":0.6,"method":"gemini"}}
{"timestamp":"2025-10-24T14:22:58.689Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+39300000001","model":"gemini-2.0-flash-exp","promptLength":76,"promptPreview":"Analiza la intención del cliente en it: \"Ciao, vorrei fare una prenotazione\"..."}}
{"timestamp":"2025-10-24T14:22:58.689Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+39300000001","responseLength":211,"processingTime":1053.9172350739836,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"greeting\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_ques...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"greeting\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.689Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+39300000001","step":"greeting","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.690Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+39300000001","step":"greeting","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.690Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → greeting","data":{"phoneNumber":"+39300000001","fromStep":"greeting","toStep":"greeting","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.690Z"}}
{"timestamp":"2025-10-24T14:22:58.690Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+39300000001","method":"intelligent","language":"it","responseLength":71,"responsePreview":"Ciao! Benvenuto al ristorante. Per quante persone sarà la prenotazione?...","fullResponse":"Ciao! Benvenuto al ristorante. Per quante persone sarà la prenotazione?"}}
{"timestamp":"2025-10-24T14:22:58.690Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+39300000001","historyLength":1,"lastMessages":[{"role":"user","message":"Ciao, vorrei fare una prenotazione","timestamp":"2025-10-24T14:22:58.690Z"}],"fullHistory":[{"role":"user","message":"Ciao, vorrei fare una prenotazione","timestamp":"2025-10-24T14:22:58.690Z"}]}}
{"timestamp":"2025-10-24T14:22:58.690Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+39300000001","state":{"step":"greeting","language":"it","data":{},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.690Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+39300000001","metrics":{"totalTime":2507.4779769404895,"geminiTime":1127.8980041012499,"processingTime":1952.1934789559932,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"greeting","nextStep":"greeting","language":"it","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.690Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+39300000001","model":"gemini-2.0-flash-exp","promptLength":55,"promptPreview":"Analiza la intención del cliente en it: \"Per 4 persone\"..."}}
{"timestamp":"2025-10-24T14:22:58.691Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+39300000001","responseLength":238,"processingTime":857.0798968361325,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":4,\"time\":\"04:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_people\",\"response_type\":\"question\",\"needs_clarification...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":4,\"time\":\"04:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_people\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.691Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+39300000001","step":"ask_people","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":4,"time":"04:00"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.691Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+39300000001","step":"ask_people","extractedData":{"people":4,"time":"04:00"},"hasPeople":true,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.691Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_people → ask_people","data":{"phoneNumber":"+39300000001","fromStep":"ask_people","toStep":"ask_people","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.691Z"}}
{"timestamp":"2025-10-24T14:22:58.691Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+39300000001","method":"intelligent","language":"it","responseLength":40,"responsePreview":"Per quante persone sarà la prenotazione?...","fullResponse":"Per quante persone sarà la prenotazione?"}}
{"timestamp":"2025-10-24T14:22:58.691Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+39300000001","historyLength":2,"lastMessages":[{"role":"user","message":"Ciao, vorrei fare una prenotazione","timestamp":"2025-10-24T14:22:58.691Z"},{"role":"bot","message":"Per 4 persone","timestamp":"2025-10-24T14:22:58.691Z"}],"fullHistory":[{"role":"user","message":"Ciao, vorrei fare una prenotazione","timestamp":"2025-10-24T14:22:58.691Z"},{"role":"bot","message":"Per 4 persone","timestamp":"2025-10-24T14:22:58.691Z"}]}}
{"timestamp":"2025-10-24T14:22:58.692Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+39300000001","state":{"step":"ask_people","language":"it","data":{"people":4},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.692Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+39300000001","metrics":{"totalTime":1585.4899455075238,"geminiTime":1315.553686576693,"processingTime":1424.32150638876,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_people","nextStep":"ask_people","language":"it","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.692Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+39300000001","model":"gemini-2.0-flash-exp","promptLength":52,"promptPreview":"Analiza la intención del cliente en it: \"Per domani\"..."}}
{"timestamp":"2025-10-24T14:22:58.692Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+39300000001","responseLength":211,"processingTime":1241.1150070315957,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_date\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_ques...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_date\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.692Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+39300000001","step":"ask_date","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.692Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+39300000001","step":"ask_date","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.692Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_date → ask_date","data":{"phoneNumber":"+39300000001","fromStep":"ask_date","toStep":"ask_date","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.692Z"}}
{"timestamp":"2025-10-24T14:22:58.693Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+39300000001","method":"intelligent","language":"it","responseLength":48,"responsePreview":"Per quale data avete bisogno della prenotazione?...","fullResponse":"Per quale data avete bisogno della prenotazione?"}}
{"timestamp":"2025-10-24T14:22:58.693Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+39300000001","historyLength":3,"lastMessages":[{"role":"user","message":"Ciao, vorrei fare una prenotazione","timestamp":"2025-10-24T14:22:58.693Z"},{"role":"bot","message":"Per 4 persone","timestamp":"2025-10-24T14:22:58.693Z"},{"role":"user","message":"Per domani","timestamp":"2025-10-24T14:22:58.693Z"}],"fullHistory":[{"role":"user","message":"Ciao, vorrei fare una prenotazione","timestamp":"2025-10-24T14:22:58.693Z"},{"role":"bot","message":"Per 4 persone","timestamp":"2025-10-24T14:22:58.693Z"},{"role":"user","message":"Per domani","timestamp":"2025-10-24T14:22:58.693Z"}]}}
{"timestamp":"2025-10-24T14:22:58.693Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+39300000001","state":{"step":"ask_date","language":"it","data":{"people":4},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.693Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+39300000001","metrics":{"totalTime":2140.515871173996,"geminiTime":948.2871495660477,"processingTime":1699.874622395993,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_date","nextStep":"ask_date","language":"it","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.693Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+39300000001","model":"gemini-2.0-flash-exp","promptLength":52,"promptPreview":"Analiza la intención del cliente en it: \"Alle 19:30\"..."}}
{"timestamp":"2025-10-24T14:22:58.693Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+39300000001","responseLength":237,"processingTime":1614.7954844051096,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":19,\"time\":\"19:30\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_time\",\"response_type\":\"question\",\"needs_clarification\"...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":19,\"time\":\"19:30\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_time\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.694Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+39300000001","step":"ask_time","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":19,"time":"19:30"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.694Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+39300000001","step":"ask_time","extractedData":{"people":19,"time":"19:30"},"hasPeople":true,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.694Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_time → ask_time","data":{"phoneNumber":"+39300000001","fromStep":"ask_time","toStep":"ask_time","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.694Z"}}
{"timestamp":"2025-10-24T14:22:58.694Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+39300000001","method":"intelligent","language":"it","responseLength":27,"responsePreview":"A che ora preferite venire?...","fullResponse":"A che ora preferite venire?"}}
{"timestamp":"2025-10-24T14:22:58.694Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+39300000001","historyLength":4,"lastMessages":[{"role":"bot","message":"Per 4 persone","timestamp":"2025-10-24T14:22:58.694Z"},{"role":"user","message":"Per domani","timestamp":"2025-10-24T14:22:58.694Z"},{"role":"bot","message":"Alle 19:30","timestamp":"2025-10-24T14:22:58.694Z"}],"fullHistory":[{"role":"user","message":"Ciao, vorrei fare una prenotazione","timestamp":"2025-10-24T14:22:58.694Z"},{"role":"bot","message":"Per 4 persone","timestamp":"2025-10-24T14:22:58.694Z"},{"role":"user","message":"Per domani","timestamp":"2025-10-24T14:22:58.694Z"},{"role":"bot","message":"Alle 19:30","timestamp":"2025-10-24T14:22:58.694Z"}]}}
{"timestamp":"2025-10-24T14:22:58.694Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+39300000001","state":{"step":"ask_time","language":"it","data":{"people":19},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.694Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+39300000001","metrics":{"totalTime":2574.160929602932,"geminiTime":1249.766208788057,"processingTime":2224.1058712321455,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_time","nextStep":"ask_time","language":"it","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.695Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+39300000001","model":"gemini-2.0-flash-exp","promptLength":63,"promptPreview":"Analiza la intención del cliente en it: \"Mi chiamo Marco Rossi\"..."}}
{"timestamp":"2025-10-24T14:22:58.695Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+39300000001","responseLength":225,"processingTime":1606.6190596327533,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"name\":\"Marco\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\":false,\"clar...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"name\":\"Marco\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.695Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+39300000001","step":"ask_name","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"name":"Marco"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.695Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+39300000001","step":"ask_name","extractedData":{"name":"Marco"},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":true,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.695Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_name → ask_name","data":{"phoneNumber":"+39300000001","fromStep":"ask_name","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.695Z"}}
{"timestamp":"2025-10-24T14:22:58.695Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+39300000001","method":"intelligent","language":"it","responseLength":15,"responsePreview":"Come si chiama?...","fullResponse":"Come si chiama?"}}
{"timestamp":"2025-10-24T14:22:58.695Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+39300000001","historyLength":5,"lastMessages":[{"role":"user","message":"Per domani","timestamp":"2025-10-24T14:22:58.695Z"},{"role":"bot","message":"Alle 19:30","timestamp":"2025-10-24T14:22:58.695Z"},{"role":"user","message":"Mi chiamo Marco Rossi","timestamp":"2025-10-24T14:22:58.695Z"}],"fullHistory":[{"role":"user","message":"Ciao, vorrei fare una prenotazione","timestamp":"2025-10-24T14:22:58.695Z"},{"role":"bot","message":"Per 4 persone","timestamp":"2025-10-24T14:22:58.695Z"},{"role":"user","message":"Per domani","timestamp":"2025-10-24T14:22:58.695Z"},{"role":"bot","message":"Alle 19:30","timestamp":"2025-10-24T14:22:58.695Z"},{"role":"user","message":"Mi chiamo Marco Rossi","timestamp":"2025-10-24T14:22:58.695Z"}]}}
{"timestamp":"2025-10-24T14:22:58.696Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+39300000001","state":{"step":"ask_name","language":"it","data":{"people":19},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.696Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+39300000001","metrics":{"totalTime":1483.6878124593823,"geminiTime":1783.4218064026782,"processingTime":1102.6315195907705,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_name","nextStep":"ask_name","language":"it","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.696Z","level":"INFO","category":"CALL_START","message":"Llamada iniciada desde +33300000001","data":{"phoneNumber":"+33300000001","userInput":"Bonjour, je voudrais faire une réservation","timestamp":"2025-10-24T14:22:58.696Z"}}
{"timestamp":"2025-10-24T14:22:58.696Z","level":"INFO","category":"LANGUAGE_DETECTION","message":"Idioma detectado: fr (0.6)","data":{"phoneNumber":"+33300000001","detectedLang":"fr","confidence":0.6,"method":"gemini"}}
{"timestamp":"2025-10-24T14:22:58.696Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+33300000001","model":"gemini-2.0-flash-exp","promptLength":84,"promptPreview":"Analiza la intención del cliente en fr: \"Bonjour, je voudrais faire une réservation\"..."}}
{"timestamp":"2025-10-24T14:22:58.697Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+33300000001","responseLength":211,"processingTime":1681.2298984258514,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"greeting\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_ques...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"greeting\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.697Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+33300000001","step":"greeting","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.697Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+33300000001","step":"greeting","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.697Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → greeting","data":{"phoneNumber":"+33300000001","fromStep":"greeting","toStep":"greeting","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.697Z"}}
{"timestamp":"2025-10-24T14:22:58.697Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+33300000001","method":"intelligent","language":"fr","responseLength":80,"responsePreview":"Bonjour! Bienvenue au restaurant. Pour combien de personnes sera la réservation?...","fullResponse":"Bonjour! Bienvenue au restaurant. Pour combien de personnes sera la réservation?"}}
{"timestamp":"2025-10-24T14:22:58.697Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+33300000001","historyLength":1,"lastMessages":[{"role":"user","message":"Bonjour, je voudrais faire une réservation","timestamp":"2025-10-24T14:22:58.697Z"}],"fullHistory":[{"role":"user","message":"Bonjour, je voudrais faire une réservation","timestamp":"2025-10-24T14:22:58.697Z"}]}}
{"timestamp":"2025-10-24T14:22:58.698Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+33300000001","state":{"step":"greeting","language":"fr","data":{},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.698Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+33300000001","metrics":{"totalTime":1720.8508230693851,"geminiTime":878.558643233315,"processingTime":2078.7567517697025,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"greeting","nextStep":"greeting","language":"fr","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.698Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+33300000001","model":"gemini-2.0-flash-exp","promptLength":58,"promptPreview":"Analiza la intención del cliente en fr: \"Pour 2 personnes\"..."}}
{"timestamp":"2025-10-24T14:22:58.698Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+33300000001","responseLength":238,"processingTime":1454.1696561577244,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":2,\"time\":\"02:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_people\",\"response_type\":\"question\",\"needs_clarification...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":2,\"time\":\"02:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_people\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.698Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+33300000001","step":"ask_people","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":2,"time":"02:00"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.698Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+33300000001","step":"ask_people","extractedData":{"people":2,"time":"02:00"},"hasPeople":true,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.698Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_people → ask_people","data":{"phoneNumber":"+33300000001","fromStep":"ask_people","toStep":"ask_people","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.698Z"}}
{"timestamp":"2025-10-24T14:22:58.699Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+33300000001","method":"intelligent","language":"fr","responseLength":46,"responsePreview":"Pour combien de personnes sera la réservation?...","fullResponse":"Pour combien de personnes sera la réservation?"}}
{"timestamp":"2025-10-24T14:22:58.699Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+33300000001","historyLength":2,"lastMessages":[{"role":"user","message":"Bonjour, je voudrais faire une réservation","timestamp":"2025-10-24T14:22:58.699Z"},{"role":"bot","message":"Pour 2 personnes","timestamp":"2025-10-24T14:22:58.699Z"}],"fullHistory":[{"role":"user","message":"Bonjour, je voudrais faire une réservation","timestamp":"2025-10-24T14:22:58.699Z"},{"role":"bot","message":"Pour 2 personnes","timestamp":"2025-10-24T14:22:58.699Z"}]}}
{"timestamp":"2025-10-24T14:22:58.699Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+33300000001","state":{"step":"ask_people","language":"fr","data":{"people":2},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.699Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+33300000001","metrics":{"totalTime":2472.254985927726,"geminiTime":935.2106600976958,"processingTime":1662.8150439087706,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_people","nextStep":"ask_people","language":"fr","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.699Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+33300000001","model":"gemini-2.0-flash-exp","promptLength":53,"promptPreview":"Analiza la intención del cliente en fr: \"Pour demain\"..."}}
{"timestamp":"2025-10-24T14:22:58.699Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+33300000001","responseLength":211,"processingTime":1608.7924708651085,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_date\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_ques...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_date\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.699Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+33300000001","step":"ask_date","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.700Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+33300000001","step":"ask_date","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.700Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_date → ask_date","data":{"phoneNumber":"+33300000001","fromStep":"ask_date","toStep":"ask_date","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.700Z"}}
{"timestamp":"2025-10-24T14:22:58.700Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+33300000001","method":"intelligent","language":"fr","responseLength":52,"responsePreview":"Pour quelle date avez-vous besoin de la réservation?...","fullResponse":"Pour quelle date avez-vous besoin de la réservation?"}}
{"timestamp":"2025-10-24T14:22:58.700Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+33300000001","historyLength":3,"lastMessages":[{"role":"user","message":"Bonjour, je voudrais faire une réservation","timestamp":"2025-10-24T14:22:58.700Z"},{"role":"bot","message":"Pour 2 personnes","timestamp":"2025-10-24T14:22:58.700Z"},{"role":"user","message":"Pour demain","timestamp":"2025-10-24T14:22:58.700Z"}],"fullHistory":[{"role":"user","message":"Bonjour, je voudrais faire une réservation","timestamp":"2025-10-24T14:22:58.700Z"},{"role":"bot","message":"Pour 2 personnes","timestamp":"2025-10-24T14:22:58.700Z"},{"role":"user","message":"Pour demain","timestamp":"2025-10-24T14:22:58.700Z"}]}}
{"timestamp":"2025-10-24T14:22:58.700Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+33300000001","state":{"step":"ask_date","language":"fr","data":{"people":2},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.700Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+33300000001","metrics":{"totalTime":1276.9862510538762,"geminiTime":1626.6161977738066,"processingTime":2038.035262577889,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_date","nextStep":"ask_date","language":"fr","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.700Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+33300000001","model":"gemini-2.0-flash-exp","promptLength":53,"promptPreview":"Analiza la intención del cliente en fr: \"À 20 heures\"..."}}
{"timestamp":"2025-10-24T14:22:58.701Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+33300000001","responseLength":237,"processingTime":1172.5190452018937,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":20,\"time\":\"20:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_time\",\"response_type\":\"question\",\"needs_clarification\"...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":20,\"time\":\"20:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_time\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.701Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+33300000001","step":"ask_time","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":20,"time":"20:00"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.701Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+33300000001","step":"ask_time","extractedData":{"people":20,"time":"20:00"},"hasPeople":true,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.701Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_time → ask_time","data":{"phoneNumber":"+33300000001","fromStep":"ask_time","toStep":"ask_time","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.701Z"}}
{"timestamp":"2025-10-24T14:22:58.701Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+33300000001","method":"intelligent","language":"fr","responseLength":35,"responsePreview":"À quelle heure préférez-vous venir?...","fullResponse":"À quelle heure préférez-vous venir?"}}
{"timestamp":"2025-10-24T14:22:58.701Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+33300000001","historyLength":4,"lastMessages":[{"role":"bot","message":"Pour 2 personnes","timestamp":"2025-10-24T14:22:58.701Z"},{"role":"user","message":"Pour demain","timestamp":"2025-10-24T14:22:58.701Z"},{"role":"bot","message":"À 20 heures","timestamp":"2025-10-24T14:22:58.701Z"}],"fullHistory":[{"role":"user","message":"Bonjour, je voudrais faire une réservation","timestamp":"2025-10-24T14:22:58.701Z"},{"role":"bot","message":"Pour 2 personnes","timestamp":"2025-10-24T14:22:58.701Z"},{"role":"user","message":"Pour demain","timestamp":"2025-10-24T14:22:58.701Z"},{"role":"bot","message":"À 20 heures","timestamp":"2025-10-24T14:22:58.701Z"}]}}
{"timestamp":"2025-10-24T14:22:58.701Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+33300000001","state":{"step":"ask_time","language":"fr","data":{"people":20},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.702Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+33300000001","metrics":{"totalTime":2166.056677454835,"geminiTime":1234.7476537073635,"processingTime":1677.4479567399014,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_time","nextStep":"ask_time","language":"fr","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.702Z","level":"ERROR","category":"GEMINI_ERROR","message":"Error en Gemini: Model is overloaded","data":{"phoneNumber":"+33300000001","error":{"message":"Model is overloaded","status":503,"stack":"Error: Model is overloaded\n    at MultiLanguageSimulator.simulateError (D:\\cronosai-webhook\\scripts\\logging\\multilanguage_simulation.js:440:24)\n    at MultiLanguageSimulator.simulateCall (D:\\cronosai-webhook\\scripts\\logging\\multilanguage_simulation.js:250:20)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async MultiLanguageSimulator.simulateFrench (D:\\cronosai-webhook\\scripts\\logging\\multilanguage_simulation.js:150:5)\n    at async MultiLanguageSimulator.runAllSimulations (D:\\cronosai-webhook\\scripts\\logging\\multilanguage_simulation.js:507:5)"},"retryCount":1}}
{"timestamp":"2025-10-24T14:22:58.702Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+33300000001","model":"gemini-2.0-flash-exp","promptLength":68,"promptPreview":"Analiza la intención del cliente en fr: \"Je m'appelle Pierre Dubois\"..."}}
{"timestamp":"2025-10-24T14:22:58.702Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+33300000001","responseLength":226,"processingTime":1451.8198994313257,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"name\":\"Pierre\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\":false,\"cla...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"name\":\"Pierre\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.702Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+33300000001","step":"ask_name","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"name":"Pierre"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.702Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+33300000001","step":"ask_name","extractedData":{"name":"Pierre"},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":true,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.703Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_name → ask_name","data":{"phoneNumber":"+33300000001","fromStep":"ask_name","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.703Z"}}
{"timestamp":"2025-10-24T14:22:58.703Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+33300000001","method":"intelligent","language":"fr","responseLength":26,"responsePreview":"Comment vous appelez-vous?...","fullResponse":"Comment vous appelez-vous?"}}
{"timestamp":"2025-10-24T14:22:58.703Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+33300000001","historyLength":5,"lastMessages":[{"role":"user","message":"Pour demain","timestamp":"2025-10-24T14:22:58.703Z"},{"role":"bot","message":"À 20 heures","timestamp":"2025-10-24T14:22:58.703Z"},{"role":"user","message":"Je m'appelle Pierre Dubois","timestamp":"2025-10-24T14:22:58.703Z"}],"fullHistory":[{"role":"user","message":"Bonjour, je voudrais faire une réservation","timestamp":"2025-10-24T14:22:58.703Z"},{"role":"bot","message":"Pour 2 personnes","timestamp":"2025-10-24T14:22:58.703Z"},{"role":"user","message":"Pour demain","timestamp":"2025-10-24T14:22:58.703Z"},{"role":"bot","message":"À 20 heures","timestamp":"2025-10-24T14:22:58.703Z"},{"role":"user","message":"Je m'appelle Pierre Dubois","timestamp":"2025-10-24T14:22:58.703Z"}]}}
{"timestamp":"2025-10-24T14:22:58.703Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+33300000001","state":{"step":"ask_name","language":"fr","data":{"people":20},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.703Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+33300000001","metrics":{"totalTime":1220.153456091567,"geminiTime":1032.1217663636494,"processingTime":1601.996282404989,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_name","nextStep":"ask_name","language":"fr","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.704Z","level":"INFO","category":"CALL_START","message":"Llamada iniciada desde +55300000001","data":{"phoneNumber":"+55300000001","userInput":"Olá, gostaria de fazer uma reserva","timestamp":"2025-10-24T14:22:58.704Z"}}
{"timestamp":"2025-10-24T14:22:58.704Z","level":"INFO","category":"LANGUAGE_DETECTION","message":"Idioma detectado: pt (0.6)","data":{"phoneNumber":"+55300000001","detectedLang":"pt","confidence":0.6,"method":"gemini"}}
{"timestamp":"2025-10-24T14:22:58.704Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+55300000001","model":"gemini-2.0-flash-exp","promptLength":76,"promptPreview":"Analiza la intención del cliente en pt: \"Olá, gostaria de fazer uma reserva\"..."}}
{"timestamp":"2025-10-24T14:22:58.704Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+55300000001","responseLength":211,"processingTime":1081.926065836246,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"greeting\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_ques...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"greeting\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.704Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+55300000001","step":"greeting","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.704Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+55300000001","step":"greeting","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.704Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → greeting","data":{"phoneNumber":"+55300000001","fromStep":"greeting","toStep":"greeting","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.704Z"}}
{"timestamp":"2025-10-24T14:22:58.705Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+55300000001","method":"intelligent","language":"pt","responseLength":67,"responsePreview":"Olá! Bem-vindo ao restaurante. Para quantas pessoas será a reserva?...","fullResponse":"Olá! Bem-vindo ao restaurante. Para quantas pessoas será a reserva?"}}
{"timestamp":"2025-10-24T14:22:58.705Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+55300000001","historyLength":1,"lastMessages":[{"role":"user","message":"Olá, gostaria de fazer uma reserva","timestamp":"2025-10-24T14:22:58.705Z"}],"fullHistory":[{"role":"user","message":"Olá, gostaria de fazer uma reserva","timestamp":"2025-10-24T14:22:58.705Z"}]}}
{"timestamp":"2025-10-24T14:22:58.705Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+55300000001","state":{"step":"greeting","language":"pt","data":{},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.705Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+55300000001","metrics":{"totalTime":2478.149816794871,"geminiTime":1385.0992653598119,"processingTime":2669.587132782908,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"greeting","nextStep":"greeting","language":"pt","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.705Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+55300000001","model":"gemini-2.0-flash-exp","promptLength":56,"promptPreview":"Analiza la intención del cliente en pt: \"Para 3 pessoas\"..."}}
{"timestamp":"2025-10-24T14:22:58.706Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+55300000001","responseLength":238,"processingTime":1493.7402533504865,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":3,\"time\":\"03:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_people\",\"response_type\":\"question\",\"needs_clarification...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":3,\"time\":\"03:00\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_people\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.706Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+55300000001","step":"ask_people","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":3,"time":"03:00"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.706Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+55300000001","step":"ask_people","extractedData":{"people":3,"time":"03:00"},"hasPeople":true,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.706Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_people → ask_people","data":{"phoneNumber":"+55300000001","fromStep":"ask_people","toStep":"ask_people","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.706Z"}}
{"timestamp":"2025-10-24T14:22:58.706Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+55300000001","method":"intelligent","language":"pt","responseLength":36,"responsePreview":"Para quantas pessoas será a reserva?...","fullResponse":"Para quantas pessoas será a reserva?"}}
{"timestamp":"2025-10-24T14:22:58.706Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+55300000001","historyLength":2,"lastMessages":[{"role":"user","message":"Olá, gostaria de fazer uma reserva","timestamp":"2025-10-24T14:22:58.706Z"},{"role":"bot","message":"Para 3 pessoas","timestamp":"2025-10-24T14:22:58.706Z"}],"fullHistory":[{"role":"user","message":"Olá, gostaria de fazer uma reserva","timestamp":"2025-10-24T14:22:58.706Z"},{"role":"bot","message":"Para 3 pessoas","timestamp":"2025-10-24T14:22:58.706Z"}]}}
{"timestamp":"2025-10-24T14:22:58.706Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+55300000001","state":{"step":"ask_people","language":"pt","data":{"people":3},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.707Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+55300000001","metrics":{"totalTime":1685.121424498599,"geminiTime":1691.7531978285779,"processingTime":2106.2617882939016,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_people","nextStep":"ask_people","language":"pt","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.707Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+55300000001","model":"gemini-2.0-flash-exp","promptLength":53,"promptPreview":"Analiza la intención del cliente en pt: \"Para amanhã\"..."}}
{"timestamp":"2025-10-24T14:22:58.707Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+55300000001","responseLength":211,"processingTime":1235.7482404045988,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_date\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_ques...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_date\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.707Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+55300000001","step":"ask_date","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.707Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+55300000001","step":"ask_date","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.708Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_date → ask_date","data":{"phoneNumber":"+55300000001","fromStep":"ask_date","toStep":"ask_date","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.707Z"}}
{"timestamp":"2025-10-24T14:22:58.708Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+55300000001","method":"intelligent","language":"pt","responseLength":40,"responsePreview":"Para que data vocês precisam da reserva?...","fullResponse":"Para que data vocês precisam da reserva?"}}
{"timestamp":"2025-10-24T14:22:58.708Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+55300000001","historyLength":3,"lastMessages":[{"role":"user","message":"Olá, gostaria de fazer uma reserva","timestamp":"2025-10-24T14:22:58.708Z"},{"role":"bot","message":"Para 3 pessoas","timestamp":"2025-10-24T14:22:58.708Z"},{"role":"user","message":"Para amanhã","timestamp":"2025-10-24T14:22:58.708Z"}],"fullHistory":[{"role":"user","message":"Olá, gostaria de fazer uma reserva","timestamp":"2025-10-24T14:22:58.708Z"},{"role":"bot","message":"Para 3 pessoas","timestamp":"2025-10-24T14:22:58.708Z"},{"role":"user","message":"Para amanhã","timestamp":"2025-10-24T14:22:58.708Z"}]}}
{"timestamp":"2025-10-24T14:22:58.708Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+55300000001","state":{"step":"ask_date","language":"pt","data":{"people":3},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.708Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+55300000001","metrics":{"totalTime":1740.9961220423083,"geminiTime":1584.8892182730715,"processingTime":1044.928926941708,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_date","nextStep":"ask_date","language":"pt","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.709Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+55300000001","model":"gemini-2.0-flash-exp","promptLength":50,"promptPreview":"Analiza la intención del cliente en pt: \"Às 19:30\"..."}}
{"timestamp":"2025-10-24T14:22:58.709Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+55300000001","responseLength":237,"processingTime":1163.6739461682114,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":19,\"time\":\"19:30\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_time\",\"response_type\":\"question\",\"needs_clarification\"...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"people\":19,\"time\":\"19:30\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_time\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.709Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+55300000001","step":"ask_time","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":19,"time":"19:30"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.709Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+55300000001","step":"ask_time","extractedData":{"people":19,"time":"19:30"},"hasPeople":true,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.709Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_time → ask_time","data":{"phoneNumber":"+55300000001","fromStep":"ask_time","toStep":"ask_time","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.709Z"}}
{"timestamp":"2025-10-24T14:22:58.709Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+55300000001","method":"intelligent","language":"pt","responseLength":23,"responsePreview":"Que horas preferem vir?...","fullResponse":"Que horas preferem vir?"}}
{"timestamp":"2025-10-24T14:22:58.710Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+55300000001","historyLength":4,"lastMessages":[{"role":"bot","message":"Para 3 pessoas","timestamp":"2025-10-24T14:22:58.710Z"},{"role":"user","message":"Para amanhã","timestamp":"2025-10-24T14:22:58.710Z"},{"role":"bot","message":"Às 19:30","timestamp":"2025-10-24T14:22:58.710Z"}],"fullHistory":[{"role":"user","message":"Olá, gostaria de fazer uma reserva","timestamp":"2025-10-24T14:22:58.710Z"},{"role":"bot","message":"Para 3 pessoas","timestamp":"2025-10-24T14:22:58.710Z"},{"role":"user","message":"Para amanhã","timestamp":"2025-10-24T14:22:58.710Z"},{"role":"bot","message":"Às 19:30","timestamp":"2025-10-24T14:22:58.710Z"}]}}
{"timestamp":"2025-10-24T14:22:58.710Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+55300000001","state":{"step":"ask_time","language":"pt","data":{"people":19},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.710Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+55300000001","metrics":{"totalTime":2697.1981380058655,"geminiTime":994.5261610239934,"processingTime":1649.7485003028419,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_time","nextStep":"ask_time","language":"pt","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:22:58.710Z","level":"INFO","category":"GEMINI_REQUEST","message":"Solicitud a Gemini gemini-2.0-flash-exp","data":{"phoneNumber":"+55300000001","model":"gemini-2.0-flash-exp","promptLength":63,"promptPreview":"Analiza la intención del cliente en pt: \"Meu nome é João Silva\"..."}}
{"timestamp":"2025-10-24T14:22:58.710Z","level":"INFO","category":"GEMINI_RESPONSE","message":"Respuesta de Gemini recibida","data":{"phoneNumber":"+55300000001","responseLength":222,"processingTime":1557.5685806258996,"responsePreview":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"name\":\"Jo\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarifi...","fullResponse":"{\"intent\":\"reservation\",\"confidence\":0.8,\"extracted_data\":{\"name\":\"Jo\"},\"sentiment\":\"positive\",\"urgency\":\"normal\",\"next_step\":\"ask_name\",\"response_type\":\"question\",\"needs_clarification\":false,\"clarification_question\":null}"}}
{"timestamp":"2025-10-24T14:22:58.711Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+55300000001","step":"ask_name","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"name":"Jo"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:22:58.711Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+55300000001","step":"ask_name","extractedData":{"name":"Jo"},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":true,"hasPhone":false}}
{"timestamp":"2025-10-24T14:22:58.711Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_name → ask_name","data":{"phoneNumber":"+55300000001","fromStep":"ask_name","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:22:58.711Z"}}
{"timestamp":"2025-10-24T14:22:58.711Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+55300000001","method":"intelligent","language":"pt","responseLength":14,"responsePreview":"Como se chama?...","fullResponse":"Como se chama?"}}
{"timestamp":"2025-10-24T14:22:58.711Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+55300000001","historyLength":5,"lastMessages":[{"role":"user","message":"Para amanhã","timestamp":"2025-10-24T14:22:58.711Z"},{"role":"bot","message":"Às 19:30","timestamp":"2025-10-24T14:22:58.711Z"},{"role":"user","message":"Meu nome é João Silva","timestamp":"2025-10-24T14:22:58.711Z"}],"fullHistory":[{"role":"user","message":"Olá, gostaria de fazer uma reserva","timestamp":"2025-10-24T14:22:58.711Z"},{"role":"bot","message":"Para 3 pessoas","timestamp":"2025-10-24T14:22:58.711Z"},{"role":"user","message":"Para amanhã","timestamp":"2025-10-24T14:22:58.711Z"},{"role":"bot","message":"Às 19:30","timestamp":"2025-10-24T14:22:58.711Z"},{"role":"user","message":"Meu nome é João Silva","timestamp":"2025-10-24T14:22:58.711Z"}]}}
{"timestamp":"2025-10-24T14:22:58.711Z","level":"INFO","category":"STATE_UPDATE","message":"Estado actualizado","data":{"phoneNumber":"+55300000001","state":{"step":"ask_name","language":"pt","data":{"people":19},"retryCount":0,"maxRetries":3}}}
{"timestamp":"2025-10-24T14:22:58.711Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+55300000001","metrics":{"totalTime":1326.8663918094314,"geminiTime":1304.3844076951268,"processingTime":1970.100839525966,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_name","nextStep":"ask_name","language":"pt","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:35:18.408Z","level":"INFO","category":"CALL_START","message":"Llamada iniciada desde +34600000001","data":{"phoneNumber":"+34600000001","userInput":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:35:18.408Z"}}
{"timestamp":"2025-10-24T14:35:18.409Z","level":"INFO","category":"LANGUAGE_DETECTION","message":"Idioma detectado: es (0.95)","data":{"phoneNumber":"+34600000001","detectedLang":"es","confidence":0.95,"method":"gemini"}}
{"timestamp":"2025-10-24T14:35:18.410Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+34600000001","step":"greeting","analysis":{"intent":"greeting","confidence":0.9,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:35:18.411Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+34600000001","step":"greeting","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:35:18.411Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → greeting","data":{"phoneNumber":"+34600000001","fromStep":"greeting","toStep":"greeting","reason":"Procesando mensaje","timestamp":"2025-10-24T14:35:18.411Z"}}
{"timestamp":"2025-10-24T14:35:18.411Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+34600000001","method":"hardcoded","language":"es","responseLength":73,"responsePreview":"¡Hola! Bienvenido al restaurante. ¿Para cuántas personas será la reserva?...","fullResponse":"¡Hola! Bienvenido al restaurante. ¿Para cuántas personas será la reserva?"}}
{"timestamp":"2025-10-24T14:35:18.411Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+34600000001","historyLength":1,"lastMessages":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:35:18.411Z"}],"fullHistory":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:35:18.411Z"}]}}
{"timestamp":"2025-10-24T14:35:18.412Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+34600000001","metrics":{"totalTime":252.49718752227372,"geminiTime":0,"processingTime":137.55432479234688,"intent":"greeting","confidence":0.9,"sentiment":"positive","urgency":"normal","step":"greeting","nextStep":"greeting","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:35:18.413Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+34600000001","step":"greeting","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":4},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:35:18.413Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+34600000001","step":"greeting","extractedData":{"people":4},"hasPeople":true,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:35:18.413Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → ask_date","data":{"phoneNumber":"+34600000001","fromStep":"greeting","toStep":"ask_date","reason":"Procesando mensaje","timestamp":"2025-10-24T14:35:18.413Z"}}
{"timestamp":"2025-10-24T14:35:18.413Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+34600000001","method":"hardcoded","language":"es","responseLength":36,"responsePreview":"¿Para qué fecha necesita la reserva?...","fullResponse":"¿Para qué fecha necesita la reserva?"}}
{"timestamp":"2025-10-24T14:35:18.414Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+34600000001","historyLength":2,"lastMessages":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:35:18.414Z"},{"role":"bot","message":"Para 4 personas","timestamp":"2025-10-24T14:35:18.414Z"}],"fullHistory":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:35:18.414Z"},{"role":"bot","message":"Para 4 personas","timestamp":"2025-10-24T14:35:18.414Z"}]}}
{"timestamp":"2025-10-24T14:35:18.414Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+34600000001","metrics":{"totalTime":243.6109130218473,"geminiTime":0,"processingTime":232.89795349114968,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_date","nextStep":"ask_date","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:35:18.414Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+34600000001","step":"ask_date","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"date":"2025-10-25"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:35:18.415Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+34600000001","step":"ask_date","extractedData":{"date":"2025-10-25"},"hasPeople":false,"hasDate":true,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:35:18.415Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_date → ask_date","data":{"phoneNumber":"+34600000001","fromStep":"ask_date","toStep":"ask_date","reason":"Procesando mensaje","timestamp":"2025-10-24T14:35:18.415Z"}}
{"timestamp":"2025-10-24T14:35:18.415Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+34600000001","method":"hardcoded","language":"es","responseLength":36,"responsePreview":"¿Para qué fecha necesita la reserva?...","fullResponse":"¿Para qué fecha necesita la reserva?"}}
{"timestamp":"2025-10-24T14:35:18.415Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+34600000001","historyLength":3,"lastMessages":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:35:18.415Z"},{"role":"bot","message":"Para 4 personas","timestamp":"2025-10-24T14:35:18.415Z"},{"role":"user","message":"Para mañana","timestamp":"2025-10-24T14:35:18.415Z"}],"fullHistory":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:35:18.415Z"},{"role":"bot","message":"Para 4 personas","timestamp":"2025-10-24T14:35:18.415Z"},{"role":"user","message":"Para mañana","timestamp":"2025-10-24T14:35:18.415Z"}]}}
{"timestamp":"2025-10-24T14:35:18.415Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+34600000001","metrics":{"totalTime":160.26640691942862,"geminiTime":0,"processingTime":132.35146536627397,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_date","nextStep":"ask_date","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:35:18.416Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+34600000001","step":"ask_date","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"time":"20:00"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:35:18.416Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+34600000001","step":"ask_date","extractedData":{"time":"20:00"},"hasPeople":false,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:35:18.416Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_date → ask_name","data":{"phoneNumber":"+34600000001","fromStep":"ask_date","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:35:18.416Z"}}
{"timestamp":"2025-10-24T14:35:18.416Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+34600000001","method":"hardcoded","language":"es","responseLength":15,"responsePreview":"¿Cómo se llama?...","fullResponse":"¿Cómo se llama?"}}
{"timestamp":"2025-10-24T14:35:18.417Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+34600000001","historyLength":4,"lastMessages":[{"role":"bot","message":"Para 4 personas","timestamp":"2025-10-24T14:35:18.417Z"},{"role":"user","message":"Para mañana","timestamp":"2025-10-24T14:35:18.417Z"},{"role":"bot","message":"A las 8 de la tarde","timestamp":"2025-10-24T14:35:18.417Z"}],"fullHistory":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:35:18.417Z"},{"role":"bot","message":"Para 4 personas","timestamp":"2025-10-24T14:35:18.417Z"},{"role":"user","message":"Para mañana","timestamp":"2025-10-24T14:35:18.417Z"},{"role":"bot","message":"A las 8 de la tarde","timestamp":"2025-10-24T14:35:18.417Z"}]}}
{"timestamp":"2025-10-24T14:35:18.417Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+34600000001","metrics":{"totalTime":143.3040934735426,"geminiTime":0,"processingTime":142.88885974122306,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_name","nextStep":"ask_name","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:35:18.418Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+34600000001","step":"ask_name","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"name":"Juan"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:35:18.418Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+34600000001","step":"ask_name","extractedData":{"name":"Juan"},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":true,"hasPhone":false}}
{"timestamp":"2025-10-24T14:35:18.419Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_name → ask_name","data":{"phoneNumber":"+34600000001","fromStep":"ask_name","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:35:18.418Z"}}
{"timestamp":"2025-10-24T14:35:18.419Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+34600000001","method":"hardcoded","language":"es","responseLength":15,"responsePreview":"¿Cómo se llama?...","fullResponse":"¿Cómo se llama?"}}
{"timestamp":"2025-10-24T14:35:18.419Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+34600000001","historyLength":5,"lastMessages":[{"role":"user","message":"Para mañana","timestamp":"2025-10-24T14:35:18.419Z"},{"role":"bot","message":"A las 8 de la tarde","timestamp":"2025-10-24T14:35:18.419Z"},{"role":"user","message":"Me llamo Juan Pérez","timestamp":"2025-10-24T14:35:18.419Z"}],"fullHistory":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:35:18.419Z"},{"role":"bot","message":"Para 4 personas","timestamp":"2025-10-24T14:35:18.419Z"},{"role":"user","message":"Para mañana","timestamp":"2025-10-24T14:35:18.419Z"},{"role":"bot","message":"A las 8 de la tarde","timestamp":"2025-10-24T14:35:18.419Z"},{"role":"user","message":"Me llamo Juan Pérez","timestamp":"2025-10-24T14:35:18.419Z"}]}}
{"timestamp":"2025-10-24T14:35:18.419Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+34600000001","metrics":{"totalTime":117.52379163154112,"geminiTime":0,"processingTime":283.05026989186456,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_name","nextStep":"ask_name","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:35:18.419Z","level":"INFO","category":"CALL_START","message":"Llamada iniciada desde +12345678901","data":{"phoneNumber":"+12345678901","userInput":"Hello, I want to make a reservation","timestamp":"2025-10-24T14:35:18.419Z"}}
{"timestamp":"2025-10-24T14:35:18.420Z","level":"INFO","category":"LANGUAGE_DETECTION","message":"Idioma detectado: en (0.95)","data":{"phoneNumber":"+12345678901","detectedLang":"en","confidence":0.95,"method":"gemini"}}
{"timestamp":"2025-10-24T14:35:18.420Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+12345678901","step":"greeting","analysis":{"intent":"greeting","confidence":0.9,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:35:18.420Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+12345678901","step":"greeting","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:35:18.420Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → greeting","data":{"phoneNumber":"+12345678901","fromStep":"greeting","toStep":"greeting","reason":"Procesando mensaje","timestamp":"2025-10-24T14:35:18.420Z"}}
{"timestamp":"2025-10-24T14:35:18.421Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+12345678901","method":"hardcoded","language":"en","responseLength":78,"responsePreview":"Hello! Welcome to the restaurant. How many people will the reservation be for?...","fullResponse":"Hello! Welcome to the restaurant. How many people will the reservation be for?"}}
{"timestamp":"2025-10-24T14:35:18.421Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+12345678901","historyLength":1,"lastMessages":[{"role":"user","message":"Hello, I want to make a reservation","timestamp":"2025-10-24T14:35:18.421Z"}],"fullHistory":[{"role":"user","message":"Hello, I want to make a reservation","timestamp":"2025-10-24T14:35:18.421Z"}]}}
{"timestamp":"2025-10-24T14:35:18.421Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+12345678901","metrics":{"totalTime":163.1268423919249,"geminiTime":0,"processingTime":240.53881255788602,"intent":"greeting","confidence":0.9,"sentiment":"positive","urgency":"normal","step":"greeting","nextStep":"greeting","language":"en","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:35:18.421Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+12345678901","step":"greeting","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":2},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:35:18.421Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+12345678901","step":"greeting","extractedData":{"people":2},"hasPeople":true,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:35:18.422Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → ask_date","data":{"phoneNumber":"+12345678901","fromStep":"greeting","toStep":"ask_date","reason":"Procesando mensaje","timestamp":"2025-10-24T14:35:18.422Z"}}
{"timestamp":"2025-10-24T14:35:18.422Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+12345678901","method":"hardcoded","language":"en","responseLength":42,"responsePreview":"What date do you need the reservation for?...","fullResponse":"What date do you need the reservation for?"}}
{"timestamp":"2025-10-24T14:35:18.422Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+12345678901","historyLength":2,"lastMessages":[{"role":"user","message":"Hello, I want to make a reservation","timestamp":"2025-10-24T14:35:18.422Z"},{"role":"bot","message":"For 2 people","timestamp":"2025-10-24T14:35:18.422Z"}],"fullHistory":[{"role":"user","message":"Hello, I want to make a reservation","timestamp":"2025-10-24T14:35:18.422Z"},{"role":"bot","message":"For 2 people","timestamp":"2025-10-24T14:35:18.422Z"}]}}
{"timestamp":"2025-10-24T14:35:18.422Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+12345678901","metrics":{"totalTime":108.13984659238133,"geminiTime":0,"processingTime":203.6642370019528,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_date","nextStep":"ask_date","language":"en","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:35:18.422Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+12345678901","step":"ask_date","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"date":"2025-10-25"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:35:18.422Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+12345678901","step":"ask_date","extractedData":{"date":"2025-10-25"},"hasPeople":false,"hasDate":true,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:35:18.423Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_date → ask_date","data":{"phoneNumber":"+12345678901","fromStep":"ask_date","toStep":"ask_date","reason":"Procesando mensaje","timestamp":"2025-10-24T14:35:18.423Z"}}
{"timestamp":"2025-10-24T14:35:18.423Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+12345678901","method":"hardcoded","language":"en","responseLength":42,"responsePreview":"What date do you need the reservation for?...","fullResponse":"What date do you need the reservation for?"}}
{"timestamp":"2025-10-24T14:35:18.423Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+12345678901","historyLength":3,"lastMessages":[{"role":"user","message":"Hello, I want to make a reservation","timestamp":"2025-10-24T14:35:18.423Z"},{"role":"bot","message":"For 2 people","timestamp":"2025-10-24T14:35:18.423Z"},{"role":"user","message":"For tomorrow","timestamp":"2025-10-24T14:35:18.423Z"}],"fullHistory":[{"role":"user","message":"Hello, I want to make a reservation","timestamp":"2025-10-24T14:35:18.423Z"},{"role":"bot","message":"For 2 people","timestamp":"2025-10-24T14:35:18.423Z"},{"role":"user","message":"For tomorrow","timestamp":"2025-10-24T14:35:18.423Z"}]}}
{"timestamp":"2025-10-24T14:35:18.423Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+12345678901","metrics":{"totalTime":191.8300862719989,"geminiTime":0,"processingTime":259.05929157839785,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_date","nextStep":"ask_date","language":"en","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:35:18.423Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+12345678901","step":"ask_date","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"time":"19:00"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:35:18.424Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+12345678901","step":"ask_date","extractedData":{"time":"19:00"},"hasPeople":false,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:35:18.424Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_date → ask_name","data":{"phoneNumber":"+12345678901","fromStep":"ask_date","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:35:18.424Z"}}
{"timestamp":"2025-10-24T14:35:18.424Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+12345678901","method":"hardcoded","language":"en","responseLength":17,"responsePreview":"What's your name?...","fullResponse":"What's your name?"}}
{"timestamp":"2025-10-24T14:35:18.424Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+12345678901","historyLength":4,"lastMessages":[{"role":"bot","message":"For 2 people","timestamp":"2025-10-24T14:35:18.424Z"},{"role":"user","message":"For tomorrow","timestamp":"2025-10-24T14:35:18.424Z"},{"role":"bot","message":"At 7 PM","timestamp":"2025-10-24T14:35:18.424Z"}],"fullHistory":[{"role":"user","message":"Hello, I want to make a reservation","timestamp":"2025-10-24T14:35:18.424Z"},{"role":"bot","message":"For 2 people","timestamp":"2025-10-24T14:35:18.424Z"},{"role":"user","message":"For tomorrow","timestamp":"2025-10-24T14:35:18.424Z"},{"role":"bot","message":"At 7 PM","timestamp":"2025-10-24T14:35:18.424Z"}]}}
{"timestamp":"2025-10-24T14:35:18.425Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+12345678901","metrics":{"totalTime":115.62191675650394,"geminiTime":0,"processingTime":276.3722950271378,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_name","nextStep":"ask_name","language":"en","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:35:18.425Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+12345678901","step":"ask_name","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"name":"John"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:35:18.426Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+12345678901","step":"ask_name","extractedData":{"name":"John"},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":true,"hasPhone":false}}
{"timestamp":"2025-10-24T14:35:18.426Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_name → ask_name","data":{"phoneNumber":"+12345678901","fromStep":"ask_name","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:35:18.426Z"}}
{"timestamp":"2025-10-24T14:35:18.426Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+12345678901","method":"hardcoded","language":"en","responseLength":17,"responsePreview":"What's your name?...","fullResponse":"What's your name?"}}
{"timestamp":"2025-10-24T14:35:18.426Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+12345678901","historyLength":5,"lastMessages":[{"role":"user","message":"For tomorrow","timestamp":"2025-10-24T14:35:18.426Z"},{"role":"bot","message":"At 7 PM","timestamp":"2025-10-24T14:35:18.426Z"},{"role":"user","message":"My name is John Smith","timestamp":"2025-10-24T14:35:18.426Z"}],"fullHistory":[{"role":"user","message":"Hello, I want to make a reservation","timestamp":"2025-10-24T14:35:18.426Z"},{"role":"bot","message":"For 2 people","timestamp":"2025-10-24T14:35:18.426Z"},{"role":"user","message":"For tomorrow","timestamp":"2025-10-24T14:35:18.426Z"},{"role":"bot","message":"At 7 PM","timestamp":"2025-10-24T14:35:18.426Z"},{"role":"user","message":"My name is John Smith","timestamp":"2025-10-24T14:35:18.426Z"}]}}
{"timestamp":"2025-10-24T14:35:18.426Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+12345678901","metrics":{"totalTime":218.8030341808497,"geminiTime":0,"processingTime":241.67327401503363,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_name","nextStep":"ask_name","language":"en","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:35:18.427Z","level":"INFO","category":"CALL_START","message":"Llamada iniciada desde +49300000001","data":{"phoneNumber":"+49300000001","userInput":"Hallo, ich möchte eine Reservierung","timestamp":"2025-10-24T14:35:18.427Z"}}
{"timestamp":"2025-10-24T14:35:18.427Z","level":"INFO","category":"LANGUAGE_DETECTION","message":"Idioma detectado: de (0.95)","data":{"phoneNumber":"+49300000001","detectedLang":"de","confidence":0.95,"method":"gemini"}}
{"timestamp":"2025-10-24T14:35:18.427Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+49300000001","step":"greeting","analysis":{"intent":"greeting","confidence":0.9,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:35:18.427Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+49300000001","step":"greeting","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:35:18.427Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → greeting","data":{"phoneNumber":"+49300000001","fromStep":"greeting","toStep":"greeting","reason":"Procesando mensaje","timestamp":"2025-10-24T14:35:18.427Z"}}
{"timestamp":"2025-10-24T14:35:18.428Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+49300000001","method":"hardcoded","language":"de","responseLength":83,"responsePreview":"Hallo! Willkommen im Restaurant. Für wie viele Personen soll die Reservierung sein?...","fullResponse":"Hallo! Willkommen im Restaurant. Für wie viele Personen soll die Reservierung sein?"}}
{"timestamp":"2025-10-24T14:35:18.428Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+49300000001","historyLength":1,"lastMessages":[{"role":"user","message":"Hallo, ich möchte eine Reservierung","timestamp":"2025-10-24T14:35:18.428Z"}],"fullHistory":[{"role":"user","message":"Hallo, ich möchte eine Reservierung","timestamp":"2025-10-24T14:35:18.428Z"}]}}
{"timestamp":"2025-10-24T14:35:18.428Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+49300000001","metrics":{"totalTime":250.5090935042405,"geminiTime":0,"processingTime":222.3670461508609,"intent":"greeting","confidence":0.9,"sentiment":"positive","urgency":"normal","step":"greeting","nextStep":"greeting","language":"de","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:35:18.428Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+49300000001","step":"greeting","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":3},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:35:18.428Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+49300000001","step":"greeting","extractedData":{"people":3},"hasPeople":true,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:35:18.428Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → ask_date","data":{"phoneNumber":"+49300000001","fromStep":"greeting","toStep":"ask_date","reason":"Procesando mensaje","timestamp":"2025-10-24T14:35:18.428Z"}}
{"timestamp":"2025-10-24T14:35:18.429Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+49300000001","method":"hardcoded","language":"de","responseLength":49,"responsePreview":"Für welches Datum benötigen Sie die Reservierung?...","fullResponse":"Für welches Datum benötigen Sie die Reservierung?"}}
{"timestamp":"2025-10-24T14:35:18.429Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+49300000001","historyLength":2,"lastMessages":[{"role":"user","message":"Hallo, ich möchte eine Reservierung","timestamp":"2025-10-24T14:35:18.429Z"},{"role":"bot","message":"Für 3 Personen","timestamp":"2025-10-24T14:35:18.429Z"}],"fullHistory":[{"role":"user","message":"Hallo, ich möchte eine Reservierung","timestamp":"2025-10-24T14:35:18.429Z"},{"role":"bot","message":"Für 3 Personen","timestamp":"2025-10-24T14:35:18.429Z"}]}}
{"timestamp":"2025-10-24T14:35:18.429Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+49300000001","metrics":{"totalTime":276.98325501336757,"geminiTime":0,"processingTime":126.58372783850953,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_date","nextStep":"ask_date","language":"de","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:35:18.429Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+49300000001","step":"ask_date","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"date":"2025-10-25"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:35:18.429Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+49300000001","step":"ask_date","extractedData":{"date":"2025-10-25"},"hasPeople":false,"hasDate":true,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:35:18.429Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_date → ask_date","data":{"phoneNumber":"+49300000001","fromStep":"ask_date","toStep":"ask_date","reason":"Procesando mensaje","timestamp":"2025-10-24T14:35:18.429Z"}}
{"timestamp":"2025-10-24T14:35:18.430Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+49300000001","method":"hardcoded","language":"de","responseLength":49,"responsePreview":"Für welches Datum benötigen Sie die Reservierung?...","fullResponse":"Für welches Datum benötigen Sie die Reservierung?"}}
{"timestamp":"2025-10-24T14:35:18.430Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+49300000001","historyLength":3,"lastMessages":[{"role":"user","message":"Hallo, ich möchte eine Reservierung","timestamp":"2025-10-24T14:35:18.430Z"},{"role":"bot","message":"Für 3 Personen","timestamp":"2025-10-24T14:35:18.430Z"},{"role":"user","message":"Für morgen","timestamp":"2025-10-24T14:35:18.430Z"}],"fullHistory":[{"role":"user","message":"Hallo, ich möchte eine Reservierung","timestamp":"2025-10-24T14:35:18.430Z"},{"role":"bot","message":"Für 3 Personen","timestamp":"2025-10-24T14:35:18.430Z"},{"role":"user","message":"Für morgen","timestamp":"2025-10-24T14:35:18.430Z"}]}}
{"timestamp":"2025-10-24T14:35:18.430Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+49300000001","metrics":{"totalTime":143.33043023717718,"geminiTime":0,"processingTime":147.18764210922427,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_date","nextStep":"ask_date","language":"de","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:35:18.430Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+49300000001","step":"ask_date","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"time":"19:00"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:35:18.431Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+49300000001","step":"ask_date","extractedData":{"time":"19:00"},"hasPeople":false,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:35:18.431Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_date → ask_name","data":{"phoneNumber":"+49300000001","fromStep":"ask_date","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:35:18.431Z"}}
{"timestamp":"2025-10-24T14:35:18.431Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+49300000001","method":"hardcoded","language":"de","responseLength":15,"responsePreview":"Wie heißen Sie?...","fullResponse":"Wie heißen Sie?"}}
{"timestamp":"2025-10-24T14:35:18.431Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+49300000001","historyLength":4,"lastMessages":[{"role":"bot","message":"Für 3 Personen","timestamp":"2025-10-24T14:35:18.431Z"},{"role":"user","message":"Für morgen","timestamp":"2025-10-24T14:35:18.431Z"},{"role":"bot","message":"Um 19 Uhr","timestamp":"2025-10-24T14:35:18.431Z"}],"fullHistory":[{"role":"user","message":"Hallo, ich möchte eine Reservierung","timestamp":"2025-10-24T14:35:18.431Z"},{"role":"bot","message":"Für 3 Personen","timestamp":"2025-10-24T14:35:18.431Z"},{"role":"user","message":"Für morgen","timestamp":"2025-10-24T14:35:18.431Z"},{"role":"bot","message":"Um 19 Uhr","timestamp":"2025-10-24T14:35:18.431Z"}]}}
{"timestamp":"2025-10-24T14:35:18.431Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+49300000001","metrics":{"totalTime":211.00601004674104,"geminiTime":0,"processingTime":214.38463033185542,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_name","nextStep":"ask_name","language":"de","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:35:18.432Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+49300000001","step":"ask_name","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"name":"Hans"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:35:18.432Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+49300000001","step":"ask_name","extractedData":{"name":"Hans"},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":true,"hasPhone":false}}
{"timestamp":"2025-10-24T14:35:18.432Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_name → ask_name","data":{"phoneNumber":"+49300000001","fromStep":"ask_name","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:35:18.432Z"}}
{"timestamp":"2025-10-24T14:35:18.433Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+49300000001","method":"hardcoded","language":"de","responseLength":15,"responsePreview":"Wie heißen Sie?...","fullResponse":"Wie heißen Sie?"}}
{"timestamp":"2025-10-24T14:35:18.433Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+49300000001","historyLength":5,"lastMessages":[{"role":"user","message":"Für morgen","timestamp":"2025-10-24T14:35:18.433Z"},{"role":"bot","message":"Um 19 Uhr","timestamp":"2025-10-24T14:35:18.433Z"},{"role":"user","message":"Ich heiße Hans Müller","timestamp":"2025-10-24T14:35:18.433Z"}],"fullHistory":[{"role":"user","message":"Hallo, ich möchte eine Reservierung","timestamp":"2025-10-24T14:35:18.433Z"},{"role":"bot","message":"Für 3 Personen","timestamp":"2025-10-24T14:35:18.433Z"},{"role":"user","message":"Für morgen","timestamp":"2025-10-24T14:35:18.433Z"},{"role":"bot","message":"Um 19 Uhr","timestamp":"2025-10-24T14:35:18.433Z"},{"role":"user","message":"Ich heiße Hans Müller","timestamp":"2025-10-24T14:35:18.433Z"}]}}
{"timestamp":"2025-10-24T14:35:18.433Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+49300000001","metrics":{"totalTime":277.3262976223871,"geminiTime":0,"processingTime":138.5647835032064,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_name","nextStep":"ask_name","language":"de","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:35:18.433Z","level":"INFO","category":"CALL_START","message":"Llamada iniciada desde +346000000011","data":{"phoneNumber":"+346000000011","userInput":"Estoy muy frustrado con este sistema","timestamp":"2025-10-24T14:35:18.433Z"}}
{"timestamp":"2025-10-24T14:35:18.433Z","level":"INFO","category":"LANGUAGE_DETECTION","message":"Idioma detectado: es (0.95)","data":{"phoneNumber":"+346000000011","detectedLang":"es","confidence":0.95,"method":"gemini"}}
{"timestamp":"2025-10-24T14:35:18.434Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+346000000011","step":"greeting","analysis":{"intent":"complaint","confidence":0.9,"sentiment":"frustrated","urgency":"high","extracted_data":{},"needs_clarification":true,"clarification_question":"Entiendo su frustración. Le ayudo paso a paso. ¿Para cuántas personas será la reserva?"}}}
{"timestamp":"2025-10-24T14:35:18.434Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+346000000011","step":"greeting","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:35:18.434Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → greeting","data":{"phoneNumber":"+346000000011","fromStep":"greeting","toStep":"greeting","reason":"Procesando mensaje","timestamp":"2025-10-24T14:35:18.434Z"}}
{"timestamp":"2025-10-24T14:35:18.434Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+346000000011","method":"hardcoded","language":"es","responseLength":86,"responsePreview":"Entiendo su frustración. Le ayudo paso a paso. ¿Para cuántas personas será la reserva?...","fullResponse":"Entiendo su frustración. Le ayudo paso a paso. ¿Para cuántas personas será la reserva?"}}
{"timestamp":"2025-10-24T14:35:18.434Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+346000000011","historyLength":1,"lastMessages":[{"role":"user","message":"Estoy muy frustrado con este sistema","timestamp":"2025-10-24T14:35:18.434Z"}],"fullHistory":[{"role":"user","message":"Estoy muy frustrado con este sistema","timestamp":"2025-10-24T14:35:18.434Z"}]}}
{"timestamp":"2025-10-24T14:35:18.434Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+346000000011","metrics":{"totalTime":261.4833620449994,"geminiTime":0,"processingTime":286.8356243503589,"intent":"complaint","confidence":0.9,"sentiment":"frustrated","urgency":"high","step":"greeting","nextStep":"greeting","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:35:18.435Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+346000000011","step":"greeting","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":2},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:35:18.435Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+346000000011","step":"greeting","extractedData":{"people":2},"hasPeople":true,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:35:18.435Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → ask_date","data":{"phoneNumber":"+346000000011","fromStep":"greeting","toStep":"ask_date","reason":"Procesando mensaje","timestamp":"2025-10-24T14:35:18.435Z"}}
{"timestamp":"2025-10-24T14:35:18.435Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+346000000011","method":"hardcoded","language":"es","responseLength":36,"responsePreview":"¿Para qué fecha necesita la reserva?...","fullResponse":"¿Para qué fecha necesita la reserva?"}}
{"timestamp":"2025-10-24T14:35:18.435Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+346000000011","historyLength":2,"lastMessages":[{"role":"user","message":"Estoy muy frustrado con este sistema","timestamp":"2025-10-24T14:35:18.435Z"},{"role":"bot","message":"Solo quiero reservar para 2 personas","timestamp":"2025-10-24T14:35:18.435Z"}],"fullHistory":[{"role":"user","message":"Estoy muy frustrado con este sistema","timestamp":"2025-10-24T14:35:18.435Z"},{"role":"bot","message":"Solo quiero reservar para 2 personas","timestamp":"2025-10-24T14:35:18.435Z"}]}}
{"timestamp":"2025-10-24T14:35:18.435Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+346000000011","metrics":{"totalTime":139.93506604217427,"geminiTime":0,"processingTime":182.1574856594729,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_date","nextStep":"ask_date","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:35:18.436Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+346000000011","step":"ask_date","analysis":{"intent":"clarification","confidence":0.5,"sentiment":"neutral","urgency":"normal","extracted_data":{},"needs_clarification":true,"clarification_question":"¿Para qué fecha necesita la reserva?"}}}
{"timestamp":"2025-10-24T14:35:18.436Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+346000000011","step":"ask_date","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:35:18.436Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_date → ask_date","data":{"phoneNumber":"+346000000011","fromStep":"ask_date","toStep":"ask_date","reason":"Procesando mensaje","timestamp":"2025-10-24T14:35:18.436Z"}}
{"timestamp":"2025-10-24T14:35:18.436Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+346000000011","method":"hardcoded","language":"es","responseLength":36,"responsePreview":"¿Para qué fecha necesita la reserva?...","fullResponse":"¿Para qué fecha necesita la reserva?"}}
{"timestamp":"2025-10-24T14:35:18.437Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+346000000011","historyLength":3,"lastMessages":[{"role":"user","message":"Estoy muy frustrado con este sistema","timestamp":"2025-10-24T14:35:18.437Z"},{"role":"bot","message":"Solo quiero reservar para 2 personas","timestamp":"2025-10-24T14:35:18.437Z"},{"role":"user","message":"Para el viernes","timestamp":"2025-10-24T14:35:18.437Z"}],"fullHistory":[{"role":"user","message":"Estoy muy frustrado con este sistema","timestamp":"2025-10-24T14:35:18.437Z"},{"role":"bot","message":"Solo quiero reservar para 2 personas","timestamp":"2025-10-24T14:35:18.437Z"},{"role":"user","message":"Para el viernes","timestamp":"2025-10-24T14:35:18.437Z"}]}}
{"timestamp":"2025-10-24T14:35:18.437Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+346000000011","metrics":{"totalTime":216.54235861206786,"geminiTime":0,"processingTime":133.62211799719927,"intent":"clarification","confidence":0.5,"sentiment":"neutral","urgency":"normal","step":"ask_date","nextStep":"ask_date","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:35:18.437Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+346000000011","step":"ask_date","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"time":"07:00"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:35:18.437Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+346000000011","step":"ask_date","extractedData":{"time":"07:00"},"hasPeople":false,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:35:18.437Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_date → ask_name","data":{"phoneNumber":"+346000000011","fromStep":"ask_date","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:35:18.437Z"}}
{"timestamp":"2025-10-24T14:35:18.437Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+346000000011","method":"hardcoded","language":"es","responseLength":15,"responsePreview":"¿Cómo se llama?...","fullResponse":"¿Cómo se llama?"}}
{"timestamp":"2025-10-24T14:35:18.438Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+346000000011","historyLength":4,"lastMessages":[{"role":"bot","message":"Solo quiero reservar para 2 personas","timestamp":"2025-10-24T14:35:18.438Z"},{"role":"user","message":"Para el viernes","timestamp":"2025-10-24T14:35:18.438Z"},{"role":"bot","message":"A las 7","timestamp":"2025-10-24T14:35:18.438Z"}],"fullHistory":[{"role":"user","message":"Estoy muy frustrado con este sistema","timestamp":"2025-10-24T14:35:18.438Z"},{"role":"bot","message":"Solo quiero reservar para 2 personas","timestamp":"2025-10-24T14:35:18.438Z"},{"role":"user","message":"Para el viernes","timestamp":"2025-10-24T14:35:18.438Z"},{"role":"bot","message":"A las 7","timestamp":"2025-10-24T14:35:18.438Z"}]}}
{"timestamp":"2025-10-24T14:35:18.438Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+346000000011","metrics":{"totalTime":252.52641412602063,"geminiTime":0,"processingTime":123.21977517940832,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_name","nextStep":"ask_name","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:35:18.438Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+346000000011","step":"ask_name","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"name":"Mar"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:35:18.438Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+346000000011","step":"ask_name","extractedData":{"name":"Mar"},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":true,"hasPhone":false}}
{"timestamp":"2025-10-24T14:35:18.439Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_name → ask_name","data":{"phoneNumber":"+346000000011","fromStep":"ask_name","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:35:18.439Z"}}
{"timestamp":"2025-10-24T14:35:18.439Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+346000000011","method":"hardcoded","language":"es","responseLength":15,"responsePreview":"¿Cómo se llama?...","fullResponse":"¿Cómo se llama?"}}
{"timestamp":"2025-10-24T14:35:18.439Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+346000000011","historyLength":5,"lastMessages":[{"role":"user","message":"Para el viernes","timestamp":"2025-10-24T14:35:18.439Z"},{"role":"bot","message":"A las 7","timestamp":"2025-10-24T14:35:18.439Z"},{"role":"user","message":"Soy María García","timestamp":"2025-10-24T14:35:18.439Z"}],"fullHistory":[{"role":"user","message":"Estoy muy frustrado con este sistema","timestamp":"2025-10-24T14:35:18.439Z"},{"role":"bot","message":"Solo quiero reservar para 2 personas","timestamp":"2025-10-24T14:35:18.439Z"},{"role":"user","message":"Para el viernes","timestamp":"2025-10-24T14:35:18.439Z"},{"role":"bot","message":"A las 7","timestamp":"2025-10-24T14:35:18.439Z"},{"role":"user","message":"Soy María García","timestamp":"2025-10-24T14:35:18.439Z"}]}}
{"timestamp":"2025-10-24T14:35:18.439Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+346000000011","metrics":{"totalTime":262.88688322450224,"geminiTime":0,"processingTime":185.04945348068756,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_name","nextStep":"ask_name","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:40:40.850Z","level":"INFO","category":"CALL_START","message":"Llamada iniciada desde +34600000001","data":{"phoneNumber":"+34600000001","userInput":"Test message","timestamp":"2025-10-24T14:40:40.849Z"}}
{"timestamp":"2025-10-24T14:43:35.142Z","level":"INFO","category":"CALL_START","message":"Llamada iniciada desde +34600000001","data":{"phoneNumber":"+34600000001","userInput":"Test message","timestamp":"2025-10-24T14:43:35.142Z"}}
{"timestamp":"2025-10-24T14:43:57.455Z","level":"INFO","category":"CALL_START","message":"Llamada iniciada desde +34600000001","data":{"phoneNumber":"+34600000001","userInput":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:43:57.454Z"}}
{"timestamp":"2025-10-24T14:43:57.455Z","level":"INFO","category":"LANGUAGE_DETECTION","message":"Idioma detectado: es (0.95)","data":{"phoneNumber":"+34600000001","detectedLang":"es","confidence":0.95,"method":"gemini"}}
{"timestamp":"2025-10-24T14:43:57.458Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+34600000001","step":"greeting","analysis":{"intent":"greeting","confidence":0.9,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:43:57.458Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+34600000001","step":"greeting","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:43:57.459Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → greeting","data":{"phoneNumber":"+34600000001","fromStep":"greeting","toStep":"greeting","reason":"Procesando mensaje","timestamp":"2025-10-24T14:43:57.459Z"}}
{"timestamp":"2025-10-24T14:43:57.459Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+34600000001","method":"hardcoded","language":"es","responseLength":73,"responsePreview":"¡Hola! Bienvenido al restaurante. ¿Para cuántas personas será la reserva?...","fullResponse":"¡Hola! Bienvenido al restaurante. ¿Para cuántas personas será la reserva?"}}
{"timestamp":"2025-10-24T14:43:57.460Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+34600000001","historyLength":1,"lastMessages":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:43:57.460Z"}],"fullHistory":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:43:57.460Z"}]}}
{"timestamp":"2025-10-24T14:43:57.460Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+34600000001","metrics":{"totalTime":255.10234515852738,"geminiTime":0,"processingTime":164.40652652789143,"intent":"greeting","confidence":0.9,"sentiment":"positive","urgency":"normal","step":"greeting","nextStep":"greeting","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:43:57.462Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+34600000001","step":"greeting","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":4},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:43:57.463Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+34600000001","step":"greeting","extractedData":{"people":4},"hasPeople":true,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:43:57.463Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → ask_date","data":{"phoneNumber":"+34600000001","fromStep":"greeting","toStep":"ask_date","reason":"Procesando mensaje","timestamp":"2025-10-24T14:43:57.463Z"}}
{"timestamp":"2025-10-24T14:43:57.463Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+34600000001","method":"hardcoded","language":"es","responseLength":36,"responsePreview":"¿Para qué fecha necesita la reserva?...","fullResponse":"¿Para qué fecha necesita la reserva?"}}
{"timestamp":"2025-10-24T14:43:57.464Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+34600000001","historyLength":2,"lastMessages":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:43:57.464Z"},{"role":"bot","message":"Para 4 personas","timestamp":"2025-10-24T14:43:57.464Z"}],"fullHistory":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:43:57.464Z"},{"role":"bot","message":"Para 4 personas","timestamp":"2025-10-24T14:43:57.464Z"}]}}
{"timestamp":"2025-10-24T14:43:57.464Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+34600000001","metrics":{"totalTime":237.42175652342135,"geminiTime":0,"processingTime":251.93029045408065,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_date","nextStep":"ask_date","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:43:57.465Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+34600000001","step":"ask_date","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"date":"2025-10-25"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:43:57.466Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+34600000001","step":"ask_date","extractedData":{"date":"2025-10-25"},"hasPeople":false,"hasDate":true,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:43:57.466Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_date → ask_date","data":{"phoneNumber":"+34600000001","fromStep":"ask_date","toStep":"ask_date","reason":"Procesando mensaje","timestamp":"2025-10-24T14:43:57.466Z"}}
{"timestamp":"2025-10-24T14:43:57.466Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+34600000001","method":"hardcoded","language":"es","responseLength":36,"responsePreview":"¿Para qué fecha necesita la reserva?...","fullResponse":"¿Para qué fecha necesita la reserva?"}}
{"timestamp":"2025-10-24T14:43:57.466Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+34600000001","historyLength":3,"lastMessages":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:43:57.466Z"},{"role":"bot","message":"Para 4 personas","timestamp":"2025-10-24T14:43:57.466Z"},{"role":"user","message":"Para mañana","timestamp":"2025-10-24T14:43:57.466Z"}],"fullHistory":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:43:57.466Z"},{"role":"bot","message":"Para 4 personas","timestamp":"2025-10-24T14:43:57.466Z"},{"role":"user","message":"Para mañana","timestamp":"2025-10-24T14:43:57.466Z"}]}}
{"timestamp":"2025-10-24T14:43:57.467Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+34600000001","metrics":{"totalTime":142.43656059823343,"geminiTime":0,"processingTime":234.22559200786338,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_date","nextStep":"ask_date","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:43:57.468Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+34600000001","step":"ask_date","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"time":"20:00"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:43:57.468Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+34600000001","step":"ask_date","extractedData":{"time":"20:00"},"hasPeople":false,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:43:57.469Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_date → ask_name","data":{"phoneNumber":"+34600000001","fromStep":"ask_date","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:43:57.469Z"}}
{"timestamp":"2025-10-24T14:43:57.470Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+34600000001","method":"hardcoded","language":"es","responseLength":15,"responsePreview":"¿Cómo se llama?...","fullResponse":"¿Cómo se llama?"}}
{"timestamp":"2025-10-24T14:43:57.470Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+34600000001","historyLength":4,"lastMessages":[{"role":"bot","message":"Para 4 personas","timestamp":"2025-10-24T14:43:57.470Z"},{"role":"user","message":"Para mañana","timestamp":"2025-10-24T14:43:57.470Z"},{"role":"bot","message":"A las 8 de la tarde","timestamp":"2025-10-24T14:43:57.470Z"}],"fullHistory":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:43:57.470Z"},{"role":"bot","message":"Para 4 personas","timestamp":"2025-10-24T14:43:57.470Z"},{"role":"user","message":"Para mañana","timestamp":"2025-10-24T14:43:57.470Z"},{"role":"bot","message":"A las 8 de la tarde","timestamp":"2025-10-24T14:43:57.470Z"}]}}
{"timestamp":"2025-10-24T14:43:57.471Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+34600000001","metrics":{"totalTime":286.44362569139054,"geminiTime":0,"processingTime":199.44332187420545,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_name","nextStep":"ask_name","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:43:57.472Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+34600000001","step":"ask_name","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"name":"Juan"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:43:57.473Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+34600000001","step":"ask_name","extractedData":{"name":"Juan"},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":true,"hasPhone":false}}
{"timestamp":"2025-10-24T14:43:57.473Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_name → ask_name","data":{"phoneNumber":"+34600000001","fromStep":"ask_name","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:43:57.473Z"}}
{"timestamp":"2025-10-24T14:43:57.473Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+34600000001","method":"hardcoded","language":"es","responseLength":15,"responsePreview":"¿Cómo se llama?...","fullResponse":"¿Cómo se llama?"}}
{"timestamp":"2025-10-24T14:43:57.473Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+34600000001","historyLength":5,"lastMessages":[{"role":"user","message":"Para mañana","timestamp":"2025-10-24T14:43:57.473Z"},{"role":"bot","message":"A las 8 de la tarde","timestamp":"2025-10-24T14:43:57.473Z"},{"role":"user","message":"Me llamo Juan Pérez","timestamp":"2025-10-24T14:43:57.473Z"}],"fullHistory":[{"role":"user","message":"Hola, quiero hacer una reserva","timestamp":"2025-10-24T14:43:57.473Z"},{"role":"bot","message":"Para 4 personas","timestamp":"2025-10-24T14:43:57.473Z"},{"role":"user","message":"Para mañana","timestamp":"2025-10-24T14:43:57.473Z"},{"role":"bot","message":"A las 8 de la tarde","timestamp":"2025-10-24T14:43:57.473Z"},{"role":"user","message":"Me llamo Juan Pérez","timestamp":"2025-10-24T14:43:57.473Z"}]}}
{"timestamp":"2025-10-24T14:43:57.474Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+34600000001","metrics":{"totalTime":277.445374690175,"geminiTime":0,"processingTime":232.8055193258975,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_name","nextStep":"ask_name","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:43:57.475Z","level":"INFO","category":"CALL_START","message":"Llamada iniciada desde +12345678901","data":{"phoneNumber":"+12345678901","userInput":"Hello, I want to make a reservation","timestamp":"2025-10-24T14:43:57.475Z"}}
{"timestamp":"2025-10-24T14:43:57.475Z","level":"INFO","category":"LANGUAGE_DETECTION","message":"Idioma detectado: en (0.95)","data":{"phoneNumber":"+12345678901","detectedLang":"en","confidence":0.95,"method":"gemini"}}
{"timestamp":"2025-10-24T14:43:57.477Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+12345678901","step":"greeting","analysis":{"intent":"greeting","confidence":0.9,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:43:57.477Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+12345678901","step":"greeting","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:43:57.477Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → greeting","data":{"phoneNumber":"+12345678901","fromStep":"greeting","toStep":"greeting","reason":"Procesando mensaje","timestamp":"2025-10-24T14:43:57.477Z"}}
{"timestamp":"2025-10-24T14:43:57.478Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+12345678901","method":"hardcoded","language":"en","responseLength":78,"responsePreview":"Hello! Welcome to the restaurant. How many people will the reservation be for?...","fullResponse":"Hello! Welcome to the restaurant. How many people will the reservation be for?"}}
{"timestamp":"2025-10-24T14:43:57.478Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+12345678901","historyLength":1,"lastMessages":[{"role":"user","message":"Hello, I want to make a reservation","timestamp":"2025-10-24T14:43:57.478Z"}],"fullHistory":[{"role":"user","message":"Hello, I want to make a reservation","timestamp":"2025-10-24T14:43:57.478Z"}]}}
{"timestamp":"2025-10-24T14:43:57.478Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+12345678901","metrics":{"totalTime":232.18674398310105,"geminiTime":0,"processingTime":214.60167341862297,"intent":"greeting","confidence":0.9,"sentiment":"positive","urgency":"normal","step":"greeting","nextStep":"greeting","language":"en","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:43:57.479Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+12345678901","step":"greeting","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":2},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:43:57.480Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+12345678901","step":"greeting","extractedData":{"people":2},"hasPeople":true,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:43:57.480Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → ask_date","data":{"phoneNumber":"+12345678901","fromStep":"greeting","toStep":"ask_date","reason":"Procesando mensaje","timestamp":"2025-10-24T14:43:57.480Z"}}
{"timestamp":"2025-10-24T14:43:57.480Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+12345678901","method":"hardcoded","language":"en","responseLength":42,"responsePreview":"What date do you need the reservation for?...","fullResponse":"What date do you need the reservation for?"}}
{"timestamp":"2025-10-24T14:43:57.481Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+12345678901","historyLength":2,"lastMessages":[{"role":"user","message":"Hello, I want to make a reservation","timestamp":"2025-10-24T14:43:57.481Z"},{"role":"bot","message":"For 2 people","timestamp":"2025-10-24T14:43:57.481Z"}],"fullHistory":[{"role":"user","message":"Hello, I want to make a reservation","timestamp":"2025-10-24T14:43:57.481Z"},{"role":"bot","message":"For 2 people","timestamp":"2025-10-24T14:43:57.481Z"}]}}
{"timestamp":"2025-10-24T14:43:57.481Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+12345678901","metrics":{"totalTime":271.152731829012,"geminiTime":0,"processingTime":133.96769490548587,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_date","nextStep":"ask_date","language":"en","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:43:57.482Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+12345678901","step":"ask_date","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"date":"2025-10-25"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:43:57.483Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+12345678901","step":"ask_date","extractedData":{"date":"2025-10-25"},"hasPeople":false,"hasDate":true,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:43:57.483Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_date → ask_date","data":{"phoneNumber":"+12345678901","fromStep":"ask_date","toStep":"ask_date","reason":"Procesando mensaje","timestamp":"2025-10-24T14:43:57.483Z"}}
{"timestamp":"2025-10-24T14:43:57.483Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+12345678901","method":"hardcoded","language":"en","responseLength":42,"responsePreview":"What date do you need the reservation for?...","fullResponse":"What date do you need the reservation for?"}}
{"timestamp":"2025-10-24T14:43:57.484Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+12345678901","historyLength":3,"lastMessages":[{"role":"user","message":"Hello, I want to make a reservation","timestamp":"2025-10-24T14:43:57.484Z"},{"role":"bot","message":"For 2 people","timestamp":"2025-10-24T14:43:57.484Z"},{"role":"user","message":"For tomorrow","timestamp":"2025-10-24T14:43:57.484Z"}],"fullHistory":[{"role":"user","message":"Hello, I want to make a reservation","timestamp":"2025-10-24T14:43:57.484Z"},{"role":"bot","message":"For 2 people","timestamp":"2025-10-24T14:43:57.484Z"},{"role":"user","message":"For tomorrow","timestamp":"2025-10-24T14:43:57.484Z"}]}}
{"timestamp":"2025-10-24T14:43:57.484Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+12345678901","metrics":{"totalTime":239.79337835002883,"geminiTime":0,"processingTime":154.64386608365587,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_date","nextStep":"ask_date","language":"en","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:43:57.485Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+12345678901","step":"ask_date","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"time":"19:00"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:43:57.485Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+12345678901","step":"ask_date","extractedData":{"time":"19:00"},"hasPeople":false,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:43:57.486Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_date → ask_name","data":{"phoneNumber":"+12345678901","fromStep":"ask_date","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:43:57.486Z"}}
{"timestamp":"2025-10-24T14:43:57.486Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+12345678901","method":"hardcoded","language":"en","responseLength":17,"responsePreview":"What's your name?...","fullResponse":"What's your name?"}}
{"timestamp":"2025-10-24T14:43:57.486Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+12345678901","historyLength":4,"lastMessages":[{"role":"bot","message":"For 2 people","timestamp":"2025-10-24T14:43:57.486Z"},{"role":"user","message":"For tomorrow","timestamp":"2025-10-24T14:43:57.486Z"},{"role":"bot","message":"At 7 PM","timestamp":"2025-10-24T14:43:57.486Z"}],"fullHistory":[{"role":"user","message":"Hello, I want to make a reservation","timestamp":"2025-10-24T14:43:57.486Z"},{"role":"bot","message":"For 2 people","timestamp":"2025-10-24T14:43:57.486Z"},{"role":"user","message":"For tomorrow","timestamp":"2025-10-24T14:43:57.486Z"},{"role":"bot","message":"At 7 PM","timestamp":"2025-10-24T14:43:57.486Z"}]}}
{"timestamp":"2025-10-24T14:43:57.487Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+12345678901","metrics":{"totalTime":239.01439373677556,"geminiTime":0,"processingTime":120.66182926774154,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_name","nextStep":"ask_name","language":"en","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:43:57.488Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+12345678901","step":"ask_name","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"name":"John"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:43:57.488Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+12345678901","step":"ask_name","extractedData":{"name":"John"},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":true,"hasPhone":false}}
{"timestamp":"2025-10-24T14:43:57.489Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_name → ask_name","data":{"phoneNumber":"+12345678901","fromStep":"ask_name","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:43:57.489Z"}}
{"timestamp":"2025-10-24T14:43:57.489Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+12345678901","method":"hardcoded","language":"en","responseLength":17,"responsePreview":"What's your name?...","fullResponse":"What's your name?"}}
{"timestamp":"2025-10-24T14:43:57.489Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+12345678901","historyLength":5,"lastMessages":[{"role":"user","message":"For tomorrow","timestamp":"2025-10-24T14:43:57.489Z"},{"role":"bot","message":"At 7 PM","timestamp":"2025-10-24T14:43:57.489Z"},{"role":"user","message":"My name is John Smith","timestamp":"2025-10-24T14:43:57.489Z"}],"fullHistory":[{"role":"user","message":"Hello, I want to make a reservation","timestamp":"2025-10-24T14:43:57.489Z"},{"role":"bot","message":"For 2 people","timestamp":"2025-10-24T14:43:57.489Z"},{"role":"user","message":"For tomorrow","timestamp":"2025-10-24T14:43:57.489Z"},{"role":"bot","message":"At 7 PM","timestamp":"2025-10-24T14:43:57.489Z"},{"role":"user","message":"My name is John Smith","timestamp":"2025-10-24T14:43:57.489Z"}]}}
{"timestamp":"2025-10-24T14:43:57.490Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+12345678901","metrics":{"totalTime":148.065151835868,"geminiTime":0,"processingTime":150.27855408147812,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_name","nextStep":"ask_name","language":"en","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:43:57.490Z","level":"INFO","category":"CALL_START","message":"Llamada iniciada desde +49300000001","data":{"phoneNumber":"+49300000001","userInput":"Hallo, ich möchte eine Reservierung","timestamp":"2025-10-24T14:43:57.490Z"}}
{"timestamp":"2025-10-24T14:43:57.491Z","level":"INFO","category":"LANGUAGE_DETECTION","message":"Idioma detectado: de (0.95)","data":{"phoneNumber":"+49300000001","detectedLang":"de","confidence":0.95,"method":"gemini"}}
{"timestamp":"2025-10-24T14:43:57.492Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+49300000001","step":"greeting","analysis":{"intent":"greeting","confidence":0.9,"sentiment":"positive","urgency":"normal","extracted_data":{},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:43:57.492Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+49300000001","step":"greeting","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:43:57.493Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → greeting","data":{"phoneNumber":"+49300000001","fromStep":"greeting","toStep":"greeting","reason":"Procesando mensaje","timestamp":"2025-10-24T14:43:57.493Z"}}
{"timestamp":"2025-10-24T14:43:57.493Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+49300000001","method":"hardcoded","language":"de","responseLength":83,"responsePreview":"Hallo! Willkommen im Restaurant. Für wie viele Personen soll die Reservierung sein?...","fullResponse":"Hallo! Willkommen im Restaurant. Für wie viele Personen soll die Reservierung sein?"}}
{"timestamp":"2025-10-24T14:43:57.493Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+49300000001","historyLength":1,"lastMessages":[{"role":"user","message":"Hallo, ich möchte eine Reservierung","timestamp":"2025-10-24T14:43:57.493Z"}],"fullHistory":[{"role":"user","message":"Hallo, ich möchte eine Reservierung","timestamp":"2025-10-24T14:43:57.493Z"}]}}
{"timestamp":"2025-10-24T14:43:57.494Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+49300000001","metrics":{"totalTime":131.01681120936584,"geminiTime":0,"processingTime":148.14372905216146,"intent":"greeting","confidence":0.9,"sentiment":"positive","urgency":"normal","step":"greeting","nextStep":"greeting","language":"de","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:43:57.495Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+49300000001","step":"greeting","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":3},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:43:57.495Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+49300000001","step":"greeting","extractedData":{"people":3},"hasPeople":true,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:43:57.496Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → ask_date","data":{"phoneNumber":"+49300000001","fromStep":"greeting","toStep":"ask_date","reason":"Procesando mensaje","timestamp":"2025-10-24T14:43:57.496Z"}}
{"timestamp":"2025-10-24T14:43:57.496Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+49300000001","method":"hardcoded","language":"de","responseLength":49,"responsePreview":"Für welches Datum benötigen Sie die Reservierung?...","fullResponse":"Für welches Datum benötigen Sie die Reservierung?"}}
{"timestamp":"2025-10-24T14:43:57.496Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+49300000001","historyLength":2,"lastMessages":[{"role":"user","message":"Hallo, ich möchte eine Reservierung","timestamp":"2025-10-24T14:43:57.496Z"},{"role":"bot","message":"Für 3 Personen","timestamp":"2025-10-24T14:43:57.496Z"}],"fullHistory":[{"role":"user","message":"Hallo, ich möchte eine Reservierung","timestamp":"2025-10-24T14:43:57.496Z"},{"role":"bot","message":"Für 3 Personen","timestamp":"2025-10-24T14:43:57.496Z"}]}}
{"timestamp":"2025-10-24T14:43:57.496Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+49300000001","metrics":{"totalTime":144.3660053329912,"geminiTime":0,"processingTime":144.16170695932942,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_date","nextStep":"ask_date","language":"de","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:43:57.497Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+49300000001","step":"ask_date","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"date":"2025-10-25"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:43:57.498Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+49300000001","step":"ask_date","extractedData":{"date":"2025-10-25"},"hasPeople":false,"hasDate":true,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:43:57.498Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_date → ask_date","data":{"phoneNumber":"+49300000001","fromStep":"ask_date","toStep":"ask_date","reason":"Procesando mensaje","timestamp":"2025-10-24T14:43:57.498Z"}}
{"timestamp":"2025-10-24T14:43:57.498Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+49300000001","method":"hardcoded","language":"de","responseLength":49,"responsePreview":"Für welches Datum benötigen Sie die Reservierung?...","fullResponse":"Für welches Datum benötigen Sie die Reservierung?"}}
{"timestamp":"2025-10-24T14:43:57.499Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+49300000001","historyLength":3,"lastMessages":[{"role":"user","message":"Hallo, ich möchte eine Reservierung","timestamp":"2025-10-24T14:43:57.499Z"},{"role":"bot","message":"Für 3 Personen","timestamp":"2025-10-24T14:43:57.499Z"},{"role":"user","message":"Für morgen","timestamp":"2025-10-24T14:43:57.499Z"}],"fullHistory":[{"role":"user","message":"Hallo, ich möchte eine Reservierung","timestamp":"2025-10-24T14:43:57.499Z"},{"role":"bot","message":"Für 3 Personen","timestamp":"2025-10-24T14:43:57.499Z"},{"role":"user","message":"Für morgen","timestamp":"2025-10-24T14:43:57.499Z"}]}}
{"timestamp":"2025-10-24T14:43:57.499Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+49300000001","metrics":{"totalTime":262.3591854815139,"geminiTime":0,"processingTime":146.01833351771614,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_date","nextStep":"ask_date","language":"de","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:43:57.500Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+49300000001","step":"ask_date","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"time":"19:00"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:43:57.501Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+49300000001","step":"ask_date","extractedData":{"time":"19:00"},"hasPeople":false,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:43:57.501Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_date → ask_name","data":{"phoneNumber":"+49300000001","fromStep":"ask_date","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:43:57.501Z"}}
{"timestamp":"2025-10-24T14:43:57.501Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+49300000001","method":"hardcoded","language":"de","responseLength":15,"responsePreview":"Wie heißen Sie?...","fullResponse":"Wie heißen Sie?"}}
{"timestamp":"2025-10-24T14:43:57.502Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+49300000001","historyLength":4,"lastMessages":[{"role":"bot","message":"Für 3 Personen","timestamp":"2025-10-24T14:43:57.502Z"},{"role":"user","message":"Für morgen","timestamp":"2025-10-24T14:43:57.502Z"},{"role":"bot","message":"Um 19 Uhr","timestamp":"2025-10-24T14:43:57.502Z"}],"fullHistory":[{"role":"user","message":"Hallo, ich möchte eine Reservierung","timestamp":"2025-10-24T14:43:57.502Z"},{"role":"bot","message":"Für 3 Personen","timestamp":"2025-10-24T14:43:57.502Z"},{"role":"user","message":"Für morgen","timestamp":"2025-10-24T14:43:57.502Z"},{"role":"bot","message":"Um 19 Uhr","timestamp":"2025-10-24T14:43:57.502Z"}]}}
{"timestamp":"2025-10-24T14:43:57.502Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+49300000001","metrics":{"totalTime":126.46500662336453,"geminiTime":0,"processingTime":163.27899209865558,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_name","nextStep":"ask_name","language":"de","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:43:57.503Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+49300000001","step":"ask_name","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"name":"Hans"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:43:57.504Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+49300000001","step":"ask_name","extractedData":{"name":"Hans"},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":true,"hasPhone":false}}
{"timestamp":"2025-10-24T14:43:57.504Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_name → ask_name","data":{"phoneNumber":"+49300000001","fromStep":"ask_name","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:43:57.504Z"}}
{"timestamp":"2025-10-24T14:43:57.505Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+49300000001","method":"hardcoded","language":"de","responseLength":15,"responsePreview":"Wie heißen Sie?...","fullResponse":"Wie heißen Sie?"}}
{"timestamp":"2025-10-24T14:43:57.505Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+49300000001","historyLength":5,"lastMessages":[{"role":"user","message":"Für morgen","timestamp":"2025-10-24T14:43:57.505Z"},{"role":"bot","message":"Um 19 Uhr","timestamp":"2025-10-24T14:43:57.505Z"},{"role":"user","message":"Ich heiße Hans Müller","timestamp":"2025-10-24T14:43:57.505Z"}],"fullHistory":[{"role":"user","message":"Hallo, ich möchte eine Reservierung","timestamp":"2025-10-24T14:43:57.505Z"},{"role":"bot","message":"Für 3 Personen","timestamp":"2025-10-24T14:43:57.505Z"},{"role":"user","message":"Für morgen","timestamp":"2025-10-24T14:43:57.505Z"},{"role":"bot","message":"Um 19 Uhr","timestamp":"2025-10-24T14:43:57.505Z"},{"role":"user","message":"Ich heiße Hans Müller","timestamp":"2025-10-24T14:43:57.505Z"}]}}
{"timestamp":"2025-10-24T14:43:57.506Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+49300000001","metrics":{"totalTime":145.97502460471674,"geminiTime":0,"processingTime":272.1502235611303,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_name","nextStep":"ask_name","language":"de","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:43:57.507Z","level":"INFO","category":"CALL_START","message":"Llamada iniciada desde +346000000011","data":{"phoneNumber":"+346000000011","userInput":"Estoy muy frustrado con este sistema","timestamp":"2025-10-24T14:43:57.507Z"}}
{"timestamp":"2025-10-24T14:43:57.507Z","level":"INFO","category":"LANGUAGE_DETECTION","message":"Idioma detectado: es (0.95)","data":{"phoneNumber":"+346000000011","detectedLang":"es","confidence":0.95,"method":"gemini"}}
{"timestamp":"2025-10-24T14:43:57.509Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+346000000011","step":"greeting","analysis":{"intent":"complaint","confidence":0.9,"sentiment":"frustrated","urgency":"high","extracted_data":{},"needs_clarification":true,"clarification_question":"Entiendo su frustración. Le ayudo paso a paso. ¿Para cuántas personas será la reserva?"}}}
{"timestamp":"2025-10-24T14:43:57.509Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+346000000011","step":"greeting","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:43:57.509Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → greeting","data":{"phoneNumber":"+346000000011","fromStep":"greeting","toStep":"greeting","reason":"Procesando mensaje","timestamp":"2025-10-24T14:43:57.509Z"}}
{"timestamp":"2025-10-24T14:43:57.509Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+346000000011","method":"hardcoded","language":"es","responseLength":86,"responsePreview":"Entiendo su frustración. Le ayudo paso a paso. ¿Para cuántas personas será la reserva?...","fullResponse":"Entiendo su frustración. Le ayudo paso a paso. ¿Para cuántas personas será la reserva?"}}
{"timestamp":"2025-10-24T14:43:57.510Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+346000000011","historyLength":1,"lastMessages":[{"role":"user","message":"Estoy muy frustrado con este sistema","timestamp":"2025-10-24T14:43:57.510Z"}],"fullHistory":[{"role":"user","message":"Estoy muy frustrado con este sistema","timestamp":"2025-10-24T14:43:57.510Z"}]}}
{"timestamp":"2025-10-24T14:43:57.510Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+346000000011","metrics":{"totalTime":161.78757339577294,"geminiTime":0,"processingTime":119.40327990850307,"intent":"complaint","confidence":0.9,"sentiment":"frustrated","urgency":"high","step":"greeting","nextStep":"greeting","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:43:57.511Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+346000000011","step":"greeting","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"people":2},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:43:57.511Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+346000000011","step":"greeting","extractedData":{"people":2},"hasPeople":true,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:43:57.512Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: greeting → ask_date","data":{"phoneNumber":"+346000000011","fromStep":"greeting","toStep":"ask_date","reason":"Procesando mensaje","timestamp":"2025-10-24T14:43:57.512Z"}}
{"timestamp":"2025-10-24T14:43:57.512Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+346000000011","method":"hardcoded","language":"es","responseLength":36,"responsePreview":"¿Para qué fecha necesita la reserva?...","fullResponse":"¿Para qué fecha necesita la reserva?"}}
{"timestamp":"2025-10-24T14:43:57.513Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+346000000011","historyLength":2,"lastMessages":[{"role":"user","message":"Estoy muy frustrado con este sistema","timestamp":"2025-10-24T14:43:57.513Z"},{"role":"bot","message":"Solo quiero reservar para 2 personas","timestamp":"2025-10-24T14:43:57.513Z"}],"fullHistory":[{"role":"user","message":"Estoy muy frustrado con este sistema","timestamp":"2025-10-24T14:43:57.513Z"},{"role":"bot","message":"Solo quiero reservar para 2 personas","timestamp":"2025-10-24T14:43:57.513Z"}]}}
{"timestamp":"2025-10-24T14:43:57.513Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+346000000011","metrics":{"totalTime":194.0046116316267,"geminiTime":0,"processingTime":133.61135232282138,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_date","nextStep":"ask_date","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:43:57.514Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+346000000011","step":"ask_date","analysis":{"intent":"clarification","confidence":0.5,"sentiment":"neutral","urgency":"normal","extracted_data":{},"needs_clarification":true,"clarification_question":"¿Para qué fecha necesita la reserva?"}}}
{"timestamp":"2025-10-24T14:43:57.514Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+346000000011","step":"ask_date","extractedData":{},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:43:57.515Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_date → ask_date","data":{"phoneNumber":"+346000000011","fromStep":"ask_date","toStep":"ask_date","reason":"Procesando mensaje","timestamp":"2025-10-24T14:43:57.515Z"}}
{"timestamp":"2025-10-24T14:43:57.515Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+346000000011","method":"hardcoded","language":"es","responseLength":36,"responsePreview":"¿Para qué fecha necesita la reserva?...","fullResponse":"¿Para qué fecha necesita la reserva?"}}
{"timestamp":"2025-10-24T14:43:57.515Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+346000000011","historyLength":3,"lastMessages":[{"role":"user","message":"Estoy muy frustrado con este sistema","timestamp":"2025-10-24T14:43:57.515Z"},{"role":"bot","message":"Solo quiero reservar para 2 personas","timestamp":"2025-10-24T14:43:57.515Z"},{"role":"user","message":"Para el viernes","timestamp":"2025-10-24T14:43:57.515Z"}],"fullHistory":[{"role":"user","message":"Estoy muy frustrado con este sistema","timestamp":"2025-10-24T14:43:57.515Z"},{"role":"bot","message":"Solo quiero reservar para 2 personas","timestamp":"2025-10-24T14:43:57.515Z"},{"role":"user","message":"Para el viernes","timestamp":"2025-10-24T14:43:57.515Z"}]}}
{"timestamp":"2025-10-24T14:43:57.515Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+346000000011","metrics":{"totalTime":229.10904791967894,"geminiTime":0,"processingTime":146.36489647642904,"intent":"clarification","confidence":0.5,"sentiment":"neutral","urgency":"normal","step":"ask_date","nextStep":"ask_date","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:43:57.516Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+346000000011","step":"ask_date","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"time":"07:00"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:43:57.517Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+346000000011","step":"ask_date","extractedData":{"time":"07:00"},"hasPeople":false,"hasDate":false,"hasTime":true,"hasName":false,"hasPhone":false}}
{"timestamp":"2025-10-24T14:43:57.517Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_date → ask_name","data":{"phoneNumber":"+346000000011","fromStep":"ask_date","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:43:57.517Z"}}
{"timestamp":"2025-10-24T14:43:57.517Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+346000000011","method":"hardcoded","language":"es","responseLength":15,"responsePreview":"¿Cómo se llama?...","fullResponse":"¿Cómo se llama?"}}
{"timestamp":"2025-10-24T14:43:57.518Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+346000000011","historyLength":4,"lastMessages":[{"role":"bot","message":"Solo quiero reservar para 2 personas","timestamp":"2025-10-24T14:43:57.518Z"},{"role":"user","message":"Para el viernes","timestamp":"2025-10-24T14:43:57.518Z"},{"role":"bot","message":"A las 7","timestamp":"2025-10-24T14:43:57.518Z"}],"fullHistory":[{"role":"user","message":"Estoy muy frustrado con este sistema","timestamp":"2025-10-24T14:43:57.518Z"},{"role":"bot","message":"Solo quiero reservar para 2 personas","timestamp":"2025-10-24T14:43:57.518Z"},{"role":"user","message":"Para el viernes","timestamp":"2025-10-24T14:43:57.518Z"},{"role":"bot","message":"A las 7","timestamp":"2025-10-24T14:43:57.518Z"}]}}
{"timestamp":"2025-10-24T14:43:57.518Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+346000000011","metrics":{"totalTime":239.89417972421143,"geminiTime":0,"processingTime":112.45440316600393,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_name","nextStep":"ask_name","language":"es","fallbackUsed":false}}}
{"timestamp":"2025-10-24T14:43:57.519Z","level":"INFO","category":"INTENT_ANALYSIS","message":"Análisis de intención completado","data":{"phoneNumber":"+346000000011","step":"ask_name","analysis":{"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","extracted_data":{"name":"Mar"},"needs_clarification":false,"clarification_question":null}}}
{"timestamp":"2025-10-24T14:43:57.520Z","level":"INFO","category":"DATA_EXTRACTION","message":"Datos extraídos del input","data":{"phoneNumber":"+346000000011","step":"ask_name","extractedData":{"name":"Mar"},"hasPeople":false,"hasDate":false,"hasTime":false,"hasName":true,"hasPhone":false}}
{"timestamp":"2025-10-24T14:43:57.520Z","level":"INFO","category":"STEP_TRANSITION","message":"Transición de paso: ask_name → ask_name","data":{"phoneNumber":"+346000000011","fromStep":"ask_name","toStep":"ask_name","reason":"Procesando mensaje","timestamp":"2025-10-24T14:43:57.520Z"}}
{"timestamp":"2025-10-24T14:43:57.520Z","level":"INFO","category":"RESPONSE_GENERATION","message":"Respuesta generada","data":{"phoneNumber":"+346000000011","method":"hardcoded","language":"es","responseLength":15,"responsePreview":"¿Cómo se llama?...","fullResponse":"¿Cómo se llama?"}}
{"timestamp":"2025-10-24T14:43:57.521Z","level":"INFO","category":"CONVERSATION_HISTORY","message":"Historial de conversación actualizado","data":{"phoneNumber":"+346000000011","historyLength":5,"lastMessages":[{"role":"user","message":"Para el viernes","timestamp":"2025-10-24T14:43:57.521Z"},{"role":"bot","message":"A las 7","timestamp":"2025-10-24T14:43:57.521Z"},{"role":"user","message":"Soy María García","timestamp":"2025-10-24T14:43:57.521Z"}],"fullHistory":[{"role":"user","message":"Estoy muy frustrado con este sistema","timestamp":"2025-10-24T14:43:57.521Z"},{"role":"bot","message":"Solo quiero reservar para 2 personas","timestamp":"2025-10-24T14:43:57.521Z"},{"role":"user","message":"Para el viernes","timestamp":"2025-10-24T14:43:57.521Z"},{"role":"bot","message":"A las 7","timestamp":"2025-10-24T14:43:57.521Z"},{"role":"user","message":"Soy María García","timestamp":"2025-10-24T14:43:57.521Z"}]}}
{"timestamp":"2025-10-24T14:43:57.521Z","level":"INFO","category":"METRICS","message":"Métricas de la llamada","data":{"phoneNumber":"+346000000011","metrics":{"totalTime":278.96357420363466,"geminiTime":0,"processingTime":159.28303310736237,"intent":"reservation","confidence":0.8,"sentiment":"positive","urgency":"normal","step":"ask_name","nextStep":"ask_name","language":"es","fallbackUsed":false}}}
